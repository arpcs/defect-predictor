{
    "id": 224574801,
    "contestId": 1819,
    "creationTimeSeconds": 1695369098,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1819,
        "index": "B",
        "name": "The Butcher",
        "type": "PROGRAMMING",
        "points": 1250.0,
        "rating": 1900,
        "tags": [
            "geometry",
            "greedy",
            "implementation",
            "sortings",
            "two pointers"
        ]
    },
    "author": {
        "contestId": 1819,
        "members": [
            {
                "handle": "you_xiao"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1681549500
    },
    "programmingLanguage": "GNU C++20 (64)",
    "verdict": "COMPILATION_ERROR",
    "testset": "TESTS",
    "passedTestCount": 0,
    "timeConsumedMillis": 0,
    "memoryConsumedBytes": 0,
    "source": "#pragma GCC optimize(3,\"Ofast\")\r\n#include<bits/stdc++.h>\r\n// #include <ext/pb_ds/assoc_container.hpp>\r\nusing namespace std;\r\n// using namespace __gnu_pbds;\r\n// const int RANDOM = chrono::high_resolution_clock::now().time_since_epoch().count();\r\n// struct chash {\r\n//     int operator()(int x) const { return x ^ RANDOM; }\r\n// };\r\n#define ll long long\r\n// #define lb(x) (-x&x)\r\n#define endl '\\n'\r\n#define IOS ios::sync_with_stdio(0),cin.tie(0),cout.tie(0)\r\nconst int N=1e6+100,mod=998244353;\r\ntypedef unsigned long long ull;\r\nll qpow(ll a,ll b){\r\n    ll res=1;\r\n    for(;b;b>>=1,a=a*a%mod){\r\n        if(b&1){\r\n            res=res*a%mod;\r\n        }\r\n    }\r\n    return res;\r\n}\r\nvoid solve(){\r\n    ll n;\r\n    cin>>n;\r\n    vector<array<ll,3>>l(n+1),r(n+1);\r\n    ll tot=0;\r\n    for(int i=1;i<=n;i++){\r\n        cin>>l[i][0];\r\n        cin>>r[i][0];\r\n        tot+=l[i][0]*r[i][0];\r\n        l[i][1]=r[i][0];\r\n        r[i][1]=l[i][0];\r\n        l[i][2]=i;\r\n        r[i][2]=i;\r\n    }\r\n    vector<pair<ll,ll>>ans;\r\n    sort(l.begin()+1,l.end(),greater());\r\n    sort(r.begin()+1,r.end(),greater());\r\n    // cout<<tot<<\" \"<<l[1][0]<<\" \"<<r[1][0]<<endl;\r\n    if(tot%l[1][0]==0){\r\n        vector<bool>vis(n+1,0); \r\n        ll now=0;\r\n        ll i=1,j=1,len=l[i][0],row=0;\r\n        ll nowl=len;\r\n        while(i<=n&&l[i][0]==l[1][0]){\r\n            now+=l[i][0]*l[i][1];\r\n            vis[l[i][2]]=1;\r\n            row+=l[i][1];\r\n            i++;\r\n        }\r\n        while(j<=n&&vis[r[j][2]])j++;\r\n        int st=j;\r\n        if(st<=n)row+=r[st][0];\r\n        ll nowr=r[st][0];\r\n        while(j<=n&&r[j][0]==r[st][0]){\r\n            if(vis[r[j][2]]){j++;continue;};\r\n            nowl-=r[j][1];\r\n            now+=r[j][0]*r[j][1];\r\n            vis[r[j][2]]=1;\r\n            j++;\r\n        }\r\n        while(j<=n||i<=n){\r\n            int f=0;\r\n            while(i<=n&&l[i][0]==nowl){\r\n                if(vis[l[i][2]]){i++;continue;};\r\n                now+=l[i][0]*l[i][1];\r\n                nowr-=l[i][1];\r\n                vis[l[i][2]]=1;\r\n                i++;\r\n                f=1;\r\n            }\r\n            if(!f)i++;f=0;\r\n            while(j<=n&&r[j][0]==nowr){\r\n                if(vis[r[j][2]]){j++;continue;};\r\n                now+=r[j][0]*r[j][1];\r\n                nowr-=r[j][1];\r\n                vis[r[j][2]]=1;\r\n                j++;\r\n                f=1;\r\n            }\r\n            if(!f)j++;\r\n        }\r\n        // cout<<tot<<\" \"<<now<<\" \"<<i<<\" \"<<j<<\" \"<<n<<endl;\r\n        if((now!=tot)||(j<=n&&i<=n)){\r\n        }\r\n        else{\r\n            ans.push_back({len,row});\r\n        }\r\n\r\n    }\r\n    if(tot%r[1][0]==0){\r\n        vector<bool>vis(n+1,0); \r\n        ll now=0;\r\n        ll j=1,i=1,len=0,row=r[j][0];\r\n        ll nowr=row;\r\n        while(j<=n&&r[j][0]==r[1][0]){\r\n            now+=r[j][0]*r[j][1];\r\n            vis[r[j][2]]=1;\r\n            len+=r[j][1];\r\n            // cout<<r[j][0]<<\" \"<<r[j][1]<<endl;\r\n            j++;\r\n        }\r\n        while(i<=n&&vis[l[i][2]])i++;\r\n        int st=i;\r\n        if(st<=n)len+=l[st][0];\r\n        ll nowl=l[st][0];\r\n        while(i<=n&&l[i][0]==l[st][0]){\r\n            if(vis[l[i][2]]){i++;continue;};\r\n            // cout<<l[i][0]<<\" \"<<l[i][1]<<endl;\r\n            nowr-=l[i][1];\r\n            now+=l[i][0]*l[i][1];\r\n            vis[l[i][2]]=1;\r\n            i++;\r\n        }\r\n        // cout<<nowl<<\" \"<<nowr<<\" \"<<now<<\" \"<<i<<\" \"<<j<<endl;\r\n        while(j<=n||i<=n){\r\n            int f=0;\r\n            while(j<=n&&r[j][0]==nowr){\r\n                // cout<<r[j][0]<<\" \"<<r[j][1]<<endl;\r\n                if(vis[r[j][2]]){j++;continue;};\r\n                now+=r[j][0]*r[j][1];\r\n                nowl-=r[j][1];\r\n                vis[r[j][2]]=1;\r\n                j++;\r\n                f=1;\r\n            }\r\n            if(!f)j++;\r\n            f=0;\r\n            while(i<=n&&l[i][0]==nowl){\r\n                // cout<<l[i][0]<<\" \"<<l[i][1]<<endl;\r\n                if(vis[l[i][2]]){i++;continue;};\r\n                now+=l[i][0]*l[i][1];\r\n                nowr-=l[i][1];\r\n                vis[l[i][2]]=1;\r\n                i++;\r\n                f=1;\r\n            }\r\n            if(!f)i++;\r\n        }\r\n        // cout<<tot<<\" \"<<now<<\" \"<<i<<\" \"<<j<<\" \"<<n<<endl;\r\n        if((now!=tot)||(j<=n&&i<=n)){\r\n            0;\r\n        }\r\n        else{\r\n            if(ans.size()){\r\n                if(len!=ans.back().first||row!=ans.back().second){\r\n                    ans.push_back({len,row});\r\n                }\r\n            }\r\n            else ans.push_back({len,row});\r\n        }\r\n    }\r\n    if(ans.size()){\r\n        cout<<ans.size()<<endl;\r\n        for(auto x:ans){\r\n            cout<<x.first<<\" \"<<x.second<<endl;\r\n        }\r\n    }\r\n    else cout<<\"-1\\n\";\r\n}\r\nint main()\r\n{\r\n    #ifdef LOCAL\r\n    freopen(\"input.in\",\"r\",stdin);\r\n    freopen(\"output.out\",\"w\",stdout);\r\n    #endif\r\n    IOS;    \r\n    int T=1;\r\n    cin>>T;\r\n    while(T--)\r\n    {\r\n        solve();\r\n    }\r\n    return 0;\r\n}\r\n\r\n\r\n    {\r\n        solve();\r\n    }\r\n    return 0;\r\n}\r\n\r\n#pragma GCC optimize(3,\"Ofast\")\r\n#include<bits/stdc++.h>\r\n// #include <ext/pb_ds/assoc_container.hpp>\r\nusing namespace std;\r\n// using namespace __gnu_pbds;\r\n// const int RANDOM = chrono::high_resolution_clock::now().time_since_epoch().count();\r\n// struct chash {\r\n//     int operator()(int x) const { return x ^ RANDOM; }\r\n// };\r\n#define ll long long\r\n// #define lb(x) (-x&x)\r\n#define endl '\\n'\r\n#define IOS ios::sync_with_stdio(0),cin.tie(0),cout.tie(0)\r\nconst int N=1e6+100,mod=998244353;\r\ntypedef unsigned long long ull;\r\nll qpow(ll a,ll b){\r\n    ll res=1;\r\n    for(;b;b>>=1,a=a*a%mod){\r\n        if(b&1){\r\n            res=res*a%mod;\r\n        }\r\n    }\r\n    return res;\r\n}\r\nvoid solve(){\r\n    ll n;\r\n    cin>>n;\r\n    vector<array<ll,3>>l(n+1),r(n+1);\r\n    ll tot=0;\r\n    for(int i=1;i<=n;i++){\r\n        cin>>l[i][0];\r\n        cin>>r[i][0];\r\n        tot+=l[i][0]*r[i][0];\r\n        l[i][1]=r[i][0];\r\n        r[i][1]=l[i][0];\r\n        l[i][2]=i;\r\n        r[i][2]=i;\r\n    }\r\n    vector<pair<ll,ll>>ans;\r\n    sort(l.begin()+1,l.end(),greater());\r\n    sort(r.begin()+1,r.end(),greater());\r\n    // cout<<tot<<\" \"<<l[1][0]<<\" \"<<r[1][0]<<endl;\r\n    if(tot%l[1][0]==0){\r\n        vector<bool>vis(n+1,0); \r\n        ll now=0;\r\n        ll i=1,j=1,len=l[i][0],row=0;\r\n        ll nowl=len;\r\n        while(i<=n&&l[i][0]==l[1][0]){\r\n            now+=l[i][0]*l[i][1];\r\n            vis[l[i][2]]=1;\r\n            row+=l[i][1];\r\n            i++;\r\n        }\r\n        while(j<=n&&vis[r[j][2]])j++;\r\n        int st=j;\r\n        if(st<=n)row+=r[st][0];\r\n        ll nowr=r[st][0];\r\n        while(j<=n&&r[j][0]==r[st][0]){\r\n            if(vis[r[j][2]]){j++;continue;};\r\n            nowl-=r[j][1];\r\n            now+=r[j][0]*r[j][1];\r\n            vis[r[j][2]]=1;\r\n            j++;\r\n        }\r\n        while(j<=n||i<=n){\r\n            int f=0;\r\n            while(i<=n&&l[i][0]==nowl){\r\n                if(vis[l[i][2]]){i++;continue;};\r\n                now+=l[i][0]*l[i][1];\r\n                nowr-=l[i][1];\r\n                vis[l[i][2]]=1;\r\n                i++;\r\n                f=1;\r\n            }\r\n            if(!f)i++;f=0;\r\n            while(j<=n&&r[j][0]==nowr){\r\n                if(vis[r[j][2]]){j++;continue;};\r\n                now+=r[j][0]*r[j][1];\r\n                nowr-=r[j][1];\r\n                vis[r[j][2]]=1;\r\n                j++;\r\n                f=1;\r\n            }\r\n            if(!f)j++;\r\n        }\r\n        // cout<<tot<<\" \"<<now<<\" \"<<i<<\" \"<<j<<\" \"<<n<<endl;\r\n        if((now!=tot)||(j<=n&&i<=n)){\r\n        }\r\n        else{\r\n            ans.push_back({len,row});\r\n        }\r\n\r\n    }\r\n    if(tot%r[1][0]==0){\r\n        vector<bool>vis(n+1,0); \r\n        ll now=0;\r\n        ll j=1,i=1,len=0,row=r[j][0];\r\n        ll nowr=row;\r\n        while(j<=n&&r[j][0]==r[1][0]){\r\n            now+=r[j][0]*r[j][1];\r\n            vis[r[j][2]]=1;\r\n            len+=r[j][1];\r\n            // cout<<r[j][0]<<\" \"<<r[j][1]<<endl;\r\n            j++;\r\n        }\r\n        while(i<=n&&vis[l[i][2]])i++;\r\n        int st=i;\r\n        if(st<=n)len+=l[st][0];\r\n        ll nowl=l[st][0];\r\n        while(i<=n&&l[i][0]==l[st][0]){\r\n            if(vis[l[i][2]]){i++;continue;};\r\n            // cout<<l[i][0]<<\" \"<<l[i][1]<<endl;\r\n            nowr-=l[i][1];\r\n            now+=l[i][0]*l[i][1];\r\n            vis[l[i][2]]=1;\r\n            i++;\r\n        }\r\n        // cout<<nowl<<\" \"<<nowr<<\" \"<<now<<\" \"<<i<<\" \"<<j<<endl;\r\n        while(j<=n||i<=n){\r\n            int f=0;\r\n            while(j<=n&&r[j][0]==nowr){\r\n                // cout<<r[j][0]<<\" \"<<r[j][1]<<endl;\r\n                if(vis[r[j][2]]){j++;continue;};\r\n                now+=r[j][0]*r[j][1];\r\n                nowl-=r[j][1];\r\n                vis[r[j][2]]=1;\r\n                j++;\r\n                f=1;\r\n            }\r\n            if(!f)j++;\r\n            f=0;\r\n            while(i<=n&&l[i][0]==nowl){\r\n                // cout<<l[i][0]<<\" \"<<l[i][1]<<endl;\r\n                if(vis[l[i][2]]){i++;continue;};\r\n                now+=l[i][0]*l[i][1];\r\n                nowr-=l[i][1];\r\n                vis[l[i][2]]=1;\r\n                i++;\r\n                f=1;\r\n            }\r\n            if(!f)i++;\r\n        }\r\n        // cout<<tot<<\" \"<<now<<\" \"<<i<<\" \"<<j<<\" \"<<n<<endl;\r\n        if((now!=tot)||(j<=n&&i<=n)){\r\n            0;\r\n        }\r\n        else{\r\n            if(ans.size()){\r\n                if(len!=ans.back().first||row!=ans.back().second){\r\n                    ans.push_back({len,row});\r\n                }\r\n            }\r\n            else ans.push_back({len,row});\r\n        }\r\n    }\r\n    if(ans.size()){\r\n        cout<<ans.size()<<endl;\r\n        for(auto x:ans){\r\n            cout<<x.first<<\" \"<<x.second<<endl;\r\n        }\r\n    }\r\n    else cout<<\"-1\\n\";\r\n}\r\nint main()\r\n{\r\n    #ifdef LOCAL\r\n    freopen(\"input.in\",\"r\",stdin);\r\n    freopen(\"output.out\",\"w\",stdout);\r\n    #endif\r\n    IOS;    \r\n    int T=1;\r\n    cin>>T;\r\n    while(T--)\r\n    {\r\n        solve();\r\n    }\r\n    return 0;\r\n}\r\n\r\n"
}
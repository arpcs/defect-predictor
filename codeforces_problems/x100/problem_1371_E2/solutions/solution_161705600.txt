{
    "id": 161705600,
    "contestId": 1371,
    "creationTimeSeconds": 1656144837,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1371,
        "index": "E2",
        "name": "Asterism (Hard Version)",
        "type": "PROGRAMMING",
        "points": 1250.0,
        "rating": 2300,
        "tags": [
            "binary search",
            "combinatorics",
            "dp",
            "math",
            "number theory",
            "sortings"
        ]
    },
    "author": {
        "contestId": 1371,
        "members": [
            {
                "handle": "Amanydv0081"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1593610500
    },
    "programmingLanguage": "GNU C++17",
    "verdict": "OK",
    "testset": "TESTS",
    "passedTestCount": 100,
    "timeConsumedMillis": 452,
    "memoryConsumedBytes": 5836800,
    "source": " #include <bits/stdc++.h>\r\n#include<string>\r\nusing namespace std;\r\n\r\n\r\n#define ll long long\r\n#define endl '\\n'\r\n \r\n#define sz(a) ((ll)(a).size())\r\n#define all(v) (v).begin(), (v).end()\r\n#define rall(v) (v).rbegin(), (v).rend()\r\n#define tr(c, it) for (auto it = (c).begin(); (it) != (c).end(); it++)\r\n#define pres(c, val) ((c).find(val) != (c).end())      // for sets, multisets, maps etc.\r\n#define cpres(c, val) (find((c).begin(), (c).end(), val) != (c).end()) // for others\r\n \r\n#define pb push_back\r\n#define mp make_pair\r\n#define fi first\r\n#define se second\r\n \r\n#define forf(i, a, b) for (ll i = (a); i < (b); i++)\r\n#define forb(i, a, b) for (ll i = (b); i >= (a); i--)\r\n#define fo(i, n) forf(i, 0, n)\r\n#define fob(i, n) forb(i, 0, n - 1)\r\n\r\nconst ll inf = 9e18;\r\nconst ll mod = 7+1e9;\r\n\r\nvoid init_code(){\r\n    ios::sync_with_stdio(0); cin.tie(0); cout.tie(0);\r\n\r\n    #ifndef ONLINE_JUDGE\r\n    freopen(\"input.txt\", \"r\", stdin);\r\n    freopen(\"output.txt\", \"w\", stdout);\r\n    #endif\r\n}\r\n\r\nconst auto start_time = std::chrono::high_resolution_clock::now();\r\n\r\nvoid TIME() {\r\n  #ifndef ONLINE_JUDGE\r\n    auto end_time = std::chrono::high_resolution_clock::now();\r\n    std::chrono::duration<double> diff = end_time - start_time;\r\n    cerr << \"Time Taken: \" << diff.count() << \"s\\n\";\r\n  #endif\r\n}\r\n\r\n\r\n\r\n\r\n\r\n// lower_bound(all(a),val);    value not less than \u2018val'\r\n// upper_bound(all(a),val);     value greater than \u2018val'\r\n// for set always use set.lower_bound()\r\n// for set always use set.upper_bound() above one will take O(N) time here\r\n// sqrtl is used for square root of long double\r\n// bitset<31>(k).to_string(); to convert a integer to binary string\r\n// compare two s1.compare(s2) if(s1 > s2) it will be positive if equal 0 else negative\r\n// int32_t when long long is defined as int\r\n//.............................code start here...........................................................................//\r\n\r\n// segment tree sum situation implementation\r\n// always start r with 1;\r\n// index of a should be strating from 1\r\n\r\n// retrun x^y mod p\r\nunsigned long long power(unsigned long long x,\r\n                                  long long y, long long p)\r\n{\r\n    unsigned long long res = 1; \r\n    x = x % p; \r\n    while (y > 0)\r\n    {\r\n     if (y & 1)\r\n            res = (res * x) % p;\r\n        y = y >> 1; \r\n        x = (x * x) % p;\r\n    }\r\n    return res;\r\n}\r\nll sl(vector<vector<ll>> &m, ll x, vector<pair<ll,ll>> &u,vector<ll> &val){\r\n    if(m[x].size() == 0){\r\n        ll ans = 1;\r\n        val[x] = u[x].second;\r\n        return ans;\r\n    }\r\n    ll h = 0;\r\n    ll y=0;\r\n    fo(i,m[x].size()){\r\n        h = h + sl(m,m[x][i],u,val);\r\n        y = y + val[m[x][i]];\r\n    }\r\n    /*if(x == 1){\r\n        cout<<val[2]<<endl;\r\n    }*/\r\n    if(y < u[x].first){\r\n        val[x] = u[x].second;\r\n        //cout<<x<<endl;\r\n        return h + 1;\r\n    }else{\r\n        ll ans =  min(y,u[x].second);\r\n        val[x] = ans;\r\n        return h;\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nlong long gcd(long long int a, long long int b)\r\n{\r\n  if (b == 0)\r\n    return a;\r\n  return gcd(b, a % b);\r\n}\r\n \r\n// Function to return LCM of two numbers\r\nlong long lcm(ll a, ll b)\r\n{\r\n    return (a / gcd(a, b)) * b;\r\n}\r\n\r\n/*void solve(){\r\n    ll n,x,y;\r\n    cin>>n>>x>>y;\r\n    ll a = min(n - x , y - 1);\r\n    cout<<a<<endl;\r\n    ll b = min(n - y, x -1);\r\n    ll an1= min(n,a + b + 1);\r\n    a = max(0ll, y - (n - x));\r\n    b= max(0ll, x - (n-y));\r\n    ll an2 = max(a+1,b+1);\r\n    /*x = n -x +1;\r\n    y= n -y +1;\r\n    a = max(0ll, y - (n - x));\r\n    b= max(0ll, x - (n-y));\r\n    ll an1 = max(a+1,b+1);\r\n    //cout<<an1<<endl;\r\n    //an1 = n -  an1 + 1;\r\n    cout<<an2<<\" \"<<an1<<endl;\r\n\r\n}*/\r\n/*void solve(){\r\n    ll n,p;\r\n    cin>>n>>p;\r\n    vector<ll>a(n);\r\n    fo(i,n)cin>>a[i];\r\n    sort(all(a));\r\n    map<ll,ll>m;\r\n    set<ll>s;\r\n    fo(i,n){\r\n        m[a[i]]++;\r\n        s.insert(a[i]);\r\n    }\r\n    auto it= s.begin();\r\n    auto it2 = m.begin();\r\n    it2++;\r\n    for(; it2 != m.end(); it2++){\r\n        it2->second += m[(*it)];\r\n        it++;\r\n    }\r\n    ll q =a[0];\r\n    ll mx=m[a[0]];\r\n    ll mn = m[a[0]];\r\n    it2=m.begin();\r\n    it2++;\r\n    ll u =m[a[0]];\r\n    ll h= a[0];\r\n    for(;it2 != m.end(); it2++){\r\n        //mn = min(mn, u - (it2->first - h-1));\r\n        ll o = it2->second - (it2->first - a[0]);\r\n        mn = min(mn,o);\r\n        mx = max(mx,o);\r\n        //h= it2->first;\r\n        //u = o;\r\n    }\r\n    vector<ll>ans;\r\n    ll g=a[0];\r\n    if(mn <= 0){\r\n        g= g -mn +1;\r\n        mx = mx -mn +1;\r\n    }\r\n    //cout<<g<<endl;\r\n\r\n    while(mx < p){\r\n        ans.push_back(g);\r\n        g++;\r\n        mx++;\r\n    }\r\n    cout<<ans.size()<<endl;\r\n    fo(i,ans.size())cout<<ans[i]<<\" \";\r\n    cout<<endl;\r\n\r\n\r\n}*/\r\nvoid solve(){\r\n    ll n,p;\r\n    cin>>n>>p;\r\n    vector<ll>a(n);\r\n    fo(i,n)cin>>a[i];\r\n    sort(all(a));\r\n    map<ll,ll>m;\r\n    ll mx = INT_MIN;\r\n    ll mn = INT_MAX;\r\n    fo(i,n){\r\n        m[a[i]]++;\r\n        mx = max(mx, a[i]);\r\n        mn = min(mn, a[i]);\r\n    }\r\n    ll u= INT_MAX;\r\n    ll v=INT_MIN;\r\n\r\n    ll l = mn,r = mx;\r\n    //cout<<mn<<\" \"<<mx<<endl;\r\n    while(l<=r){\r\n        ll mid = l + ((r-l)/2);\r\n        vector<ll> h(n);\r\n        fo(i,n){\r\n            if(a[i] <= mid)h[0]++;\r\n        }\r\n        for(int i=1; i<n; i++){\r\n            if(m.find(mid + i) != m.end()){\r\n                h[i] = h[i-1] + m[mid + i];\r\n            }else{\r\n                h[i] = h[i-1];\r\n            }\r\n        }\r\n        bool an=true;\r\n        if(h[n-1] < n){\r\n            an =false;\r\n        }\r\n        fo(i,n){\r\n            if( h[i] - i < 1){\r\n                an=false;\r\n            }\r\n        }\r\n        if(an){\r\n            u = min(u,mid);\r\n            r= mid-1;\r\n        }else{\r\n            l =mid +1;\r\n        }\r\n    }\r\n    l=mn,r=mx;\r\n    while(l<=r){\r\n        ll mid = l + ((r-l)/2);\r\n        vector<ll> h(n);\r\n        fo(i,n){\r\n            if(a[i] <= mid)h[0]++;\r\n        }\r\n        for(int i=1; i<n; i++){\r\n            if(m.find(mid + i) != m.end()){\r\n                h[i] = h[i-1] + m[mid + i];\r\n            }else{\r\n                h[i] = h[i-1];\r\n            }\r\n        }\r\n        bool an=true;\r\n        /*if(h[n-1] < n){\r\n            an =false;\r\n        }*/\r\n        fo(i,n){\r\n            if(h[i] - i >= p){\r\n                an=false;\r\n            }\r\n        }\r\n        if(an){\r\n            v = max(v,mid);\r\n            l = mid +1;\r\n        }else{\r\n            r= mid -1;\r\n        }\r\n    }\r\n    //cout<<u<<\" \"<<v<<endl;\r\n    if(u > v){\r\n        cout<<0<<endl;\r\n        return;\r\n    }\r\n    \r\n    cout<<v-u+1<<endl;\r\n    for(int i=u; i<=v; i++)cout<<i<<\" \";\r\n    cout<<endl;\r\n\r\n\r\n}\r\n\r\n\r\n\r\nint main() {\r\n    init_code();\r\n    //cout << fixed << setprecision(10);\r\n    /*ll t;\r\n    cin>>t;\r\n    //cout<<t<<endl;\r\n    while(t--){\r\n       //solve();\r\n    }*/\r\n\r\n    solve();\r\n    \r\n    \r\n        \r\n    //TIME();\r\n    return 0;\r\n\r\n\r\n}\r\n\r\n \r\n "
}
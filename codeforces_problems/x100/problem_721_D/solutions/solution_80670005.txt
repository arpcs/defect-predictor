{
    "id": 80670005,
    "contestId": 721,
    "creationTimeSeconds": 1589877892,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 721,
        "index": "D",
        "name": "Maxim and Array",
        "type": "PROGRAMMING",
        "points": 2000.0,
        "rating": 2000,
        "tags": [
            "constructive algorithms",
            "data structures",
            "greedy",
            "math"
        ]
    },
    "author": {
        "contestId": 721,
        "members": [
            {
                "handle": "jayeshaw"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1475244300
    },
    "programmingLanguage": "GNU C++17",
    "verdict": "OK",
    "testset": "TESTS",
    "passedTestCount": 70,
    "timeConsumedMillis": 218,
    "memoryConsumedBytes": 10342400,
    "source": "#include <bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp> \n#include <ext/pb_ds/tree_policy.hpp>\n#define ll long long int\n#define ld long double\n#define pb push_back\n#define pll pair<ll, ll> \n#define vl vector<ll> \n#define vvl vector< vector<ll> > \n#define vlp vector< pair<ll, ll> >\n#define vllp vector<pair<pll, ll> > \n#define mll map<ll, ll> \n#define rep(i,a)  for(ll i=0; i< a; i++)\n#define rep1(i,a)   for(ll i = 1; i< a; i++)\n#define foi(i, a, b)    for(ll i = a; i<b ; i++)\n#define fod(i, a, b)    for(ll i = a; i>=b ; i--)\n#define mp make_pair\n#define all(v)  (v).begin(), (v).end()\n#define fst first\n#define sec second\n#define ff first.first\n#define fs first.second\n#define max3(a, b, c)   max(max(a, b), c)\n#define min3(a, b, c)   min(min(a, b), c)\n#define MAX 1000001\n#define MOD 1000000007\n// #define MOD 998244353\n#define endl \"\\n\"\n#define INF (ll)1e18\n#define s(v) (ll)v.size()\n#define e(v) v.empty()\n#define bscount(x) __builtin_popcountll(x)\n// #define ordered_set tree<int, null_type,less<int>, rb_tree_tag,tree_order_statistics_node_update>\n\nusing namespace std;\n// using namespace __gnu_pbds;\n\nll gcd(ll a, ll b){if(b==0)return a;return gcd(b, a%b);}\nll lcm(ll a, ll b){return a*b/gcd(a, b);}\nll fexp(ll a, ll b){ll ans = 1;while(b){if(b&1) ans = ans*a%MOD; b/=2;a=a*a%MOD;}return ans;}\nll inverse(ll a, ll p){return fexp(a, p-2);} \nvoid ingraph(vvl& graph, ll m){ll x, y;rep(i, m){cin>>x>>y;x--, y--;graph[x].pb(y);graph[y].pb(x);}}\nll modify(ll n){ll res = n;res%=MOD;res+=MOD;res%=MOD;return res;}\n\npriority_queue<pll, vlp, greater<pll> > neg;\npriority_queue<pll, vlp, greater<pll> > pos;\nll n;\n\nvoid final(){\n    vl fin(n);\n    while(s(neg)){\n        pll tmp = neg.top();\n        fin[tmp.sec] = -tmp.fst;\n        neg.pop();\n    }\n    while(s(pos)){\n        pll tmp = pos.top();\n        fin[tmp.sec] = tmp.fst;\n        pos.pop();\n    }\n    rep(i, n)   cout<<fin[i]<<\" \";\n}\n\nint main(){\n    #ifndef ONLINE_JUDGE\n        freopen(\"../input.txt\", \"r\", stdin);\n        freopen(\"../output.txt\", \"w\", stdout);\n    #endif\n    ios::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    ll t;\n    // cin>>t;\n    t = 1;\n    while(t--){\n        ll k, x;\n        cin>>n>>k>>x;\n        vl vec(n);\n        vl zeroes;\n        ll cn = 0, cp = 0, zc = 0;\n        rep(i, n){\n            cin>>vec[i];\n            if(vec[i] > 0){\n                pos.push({vec[i], i});\n                cp++;\n            }else if(vec[i] < 0){\n                neg.push({-vec[i], i});cn++;\n            }else{\n                zeroes.pb(i);zc++;\n            }\n        }\n        if(zc != 0){\n            if(zc > k){\n                rep(i, n)   cout<<vec[i]<<\" \";\n                return 0;\n            }else{\n                if(cn % 2 == 0){\n                    neg.push({x, zeroes[zc - 1]});\n                    zeroes.pop_back();\n                    zc--;cn++;\n                    k--;\n                }\n                if(zc){\n                    rep(i, zc){\n                        pos.push({x, zeroes[i]});k--;cp++;\n                    }\n                }\n            }\n        }\n        if(cn % 2 == 0){\n            if(cn && cp){\n                pll pfront = pos.top();\n                pll nfront = neg.top();\n                if(pfront.fst < nfront.fst){\n                    ll m = (pfront.fst + x - 1)/x;\n                    if(m <= k){\n                        pfront.fst -= m*x;\n                        k -= m;\n                        if(!k && pfront.fst == 0){\n                            pos.pop();\n                            pos.push(pfront);\n                            final();return 0;\n                        }else if(pfront.fst == 0){\n                            k--;\n                            pfront.fst -= x;\n                            pos.pop();\n                            neg.push({-pfront.fst, pfront.sec});cn++;cp--;\n                        }else{\n                            pos.pop();\n                            neg.push({-pfront.fst, pfront.sec});cn++;cp--;\n                        }\n                    }else{\n                        pfront.fst -= k*x;\n                        pos.pop();\n                        pos.push(pfront);\n                        final();return 0;\n                    }\n                }else if(nfront.fst <= pfront.fst){\n                    ll m = (nfront.fst + x - 1)/x;\n                    if(m <= k){\n                        nfront.fst -= m*x;\n                        k -= m;\n                        if(!k && nfront.fst == 0){\n                            neg.pop();\n                            neg.push(nfront);\n                            final();return 0;\n                        }else if(nfront.fst == 0){\n                            k--;\n                            nfront.fst -= x;\n                            neg.pop();\n                            pos.push({-nfront.fst, nfront.sec});cp++;cn--;\n                        }else{\n                            neg.pop();\n                            pos.push({-nfront.fst, nfront.sec});cp++;cn--;\n                        }\n                    }else{\n                        nfront.fst -= k*x;\n                        neg.pop();\n                        neg.push(nfront);\n                        final();return 0;\n                    }\n                }\n            }else if(cn){\n                pll nfront = neg.top();\n                ll m = (nfront.fst + x - 1)/x;\n                if(m <= k){\n                    nfront.fst -= m*x;\n                    k -= m;\n                    if(!k && nfront.fst == 0){\n                        neg.pop();\n                        neg.push(nfront);\n                        final();return 0;\n                    }else if(nfront.fst == 0){\n                        k--;\n                        nfront.fst -= x;\n                        neg.pop();cn--;\n                        pos.push({-nfront.fst, nfront.sec});cp++;\n                    }else{\n                        neg.pop();cn--;\n                        pos.push({-nfront.fst, nfront.sec});cp++;\n                    }\n                }else{\n                    nfront.fst -= k*x;\n                    neg.pop();\n                    neg.push(nfront);\n                    final();return 0;\n                }\n            }else{\n                pll pfront = pos.top();\n                ll m = (pfront.fst + x - 1)/x;\n                if(m <= k){\n                    pfront.fst -= m*x;\n                    k -= m;\n                    if(!k && pfront.fst == 0){\n                        pos.pop();\n                        pos.push(pfront);\n                        final();return 0;\n                    }else if(pfront.fst == 0){\n                        k--;\n                        pfront.fst -= x;\n                        pos.pop();cp--;\n                        neg.push({-pfront.fst, pfront.sec});cn++;\n                    }else{\n                        pos.pop();cp--;\n                        neg.push({-pfront.fst, pfront.sec});cn++;\n                    }\n                }else{\n                    pfront.fst -= k*x;\n                    pos.pop();\n                    pos.push(pfront);\n                    final();return 0;\n                }\n            }\n        }\n        neg.push({INF, INF});\n        pos.push({INF, INF});\n        while(k){\n            pll pfront = pos.top();\n            pll nfront = neg.top();\n            if(nfront.fst <= pfront.fst){\n                nfront.fst += x;\n                neg.pop();neg.push(nfront);\n            }else{\n                pfront.fst += x;\n                pos.pop();pos.push(pfront);\n            }\n            k--;\n        }\n        vl fin(n);\n        while(s(neg) > 1){\n            pll tmp  = neg.top();\n            fin[tmp.sec] = -tmp.fst;\n            neg.pop();\n        }while(s(pos) > 1){\n            pll tmp = pos.top();\n            fin[tmp.sec] = tmp.fst;\n            pos.pop();\n        }\n        rep(i, n)   cout<<fin[i]<<\" \";\n    }\n}"
}
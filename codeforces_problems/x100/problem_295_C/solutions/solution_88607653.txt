{
    "id": 88607653,
    "contestId": 295,
    "creationTimeSeconds": 1596211685,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 295,
        "index": "C",
        "name": "Greg and Friends",
        "type": "PROGRAMMING",
        "points": 1500.0,
        "rating": 2100,
        "tags": [
            "combinatorics",
            "dp",
            "graphs",
            "shortest paths"
        ]
    },
    "author": {
        "contestId": 295,
        "members": [
            {
                "handle": "buihoatpt2k3"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1365694200
    },
    "programmingLanguage": "GNU C++14",
    "verdict": "OK",
    "testset": "TESTS",
    "passedTestCount": 44,
    "timeConsumedMillis": 62,
    "memoryConsumedBytes": 3993600,
    "source": "\r\n/**\tCOPYRIGHT INFORMATION\r\n *\tAuthor:\tB\u00f9i Ho\u1ea1t (buihoatpt2k3)\r\n *\tEmail:\t[email\u00a0protected]\r\n *\tSchool:\tHung Vuong High School for the Gifted, Phu Tho Province, Vietnam **/\r\n\r\n#include <bits/stdc++.h>\r\nusing namespace std;\r\nlong long POW(long long A, long long N, long long MOD) { if (N == 0) return 1 % MOD; if (N == 1) return A % MOD; long long tmp = POW(A, N / 2, MOD) % MOD; if (N % 2) return ((tmp * tmp) % MOD * A % MOD) % MOD; else return (tmp * tmp) % MOD;}\r\nlong long MUL(long long A, long long B, long long MOD) {long long r = 0;while (B) {r = (r + (A * (B % 2) % MOD)) % MOD;A = (A + A) % MOD;B /= 2;}return r;}\r\nlong long GCD(long long A, long long B) {return B == 0 ? A : GCD(B, A % B);}\r\nint dx[] = {0, -1, 0, 1, 0};\r\nint dy[] = {0,  0, 1, 0,-1};\r\n#define __gcd GCD\r\n#define in ({long long x=0,n=0,c=getchar();for(;!isdigit(c);c=getchar())n=(c=='-');for(;isdigit(c);c=getchar())x=x*10+c-'0';(n)?-x:x;})\r\n#define inc ({char c=0;for(;c=='\\n'||c==' ';c=getchar());c=getchar();c;})\r\n#define ins ({string x;char c=getchar();for(;c==' '||c=='\\n';c=getchar());for(;c!=' '&&c!='\\n';c=getchar()) x+=c;x;})\r\n#define ii pair <int, int>\r\n#define fi first\r\n#define se second\r\n#define pb push_back\r\n#define ll long long\r\n#define ull unsigned long long\r\n#define db double\r\n#define ld long double\r\n#define vi vector <int>\r\n#define vii vector <ii>\r\n#define reset(f, x) memset(f, x, sizeof(f))\r\n#define all(v) v.begin(), v.end()\r\n#define __builtin_popcount __builtin_popcountll\r\n#define BIT(mask, i) (((mask) >> (i)) & 1ll)\r\n#define ONBIT(mask, i) (mask | (1ll << i))\r\n#define OFFBIT(mask, i) (mask &~ (1ll << i))\r\n#define sz(v) (ll) v.size()\r\n#define FOR(i, a, b) for (int i = (a), _b = (b); i <= _b; ++i)\r\n#define FORD(i, b, a) for (int i = (b), _a = (a); i >= _a; --i)\r\n#define FORV(v, H) for (auto &v: H)\r\n#define lwb lower_bound\r\n#define upb upper_bound\r\n#define debug1(a) cout << #a << \" = \" << a << \"; \"\r\n#define debug1l(a) cout << #a << \" = \" << a << \"; \" << '\\n'\r\n#define debug2(a, b) cout << #a << \" = \" << a << \"; \" << #b << \" = \" << b << \"; \"\r\n#define debug2l(a, b) cout << #a << \" = \" << a << \"; \" << #b << \" = \" << b << \"; \" << '\\n'\r\n#define debug3(a, b, c) cout << #a << \" = \" << a << \"; \" << #b << \" = \" << b << \"; \" << #c << \" = \" << c << \"; \"\r\n#define debug3l(a, b, c) cout << #a << \" = \" << a << \"; \" << #b << \" = \" << b << \"; \" << #c << \" = \" << c << \"; \" << '\\n'\r\n#define debug4(a, b, c, d) cout << #a << \" = \" << a << \"; \" << #b << \" = \" << b << \"; \" << #c << \" = \" << c << \"; \" << #d << \" = \" << d << \"; \"\r\n#define debug4l(a, b, c, d) cout << #a << \" = \" << a << \"; \" << #b << \" = \" << b << \"; \" << #c << \" = \" << c << \"; \" << #d << \" = \" << d << \"; \" << '\\n'\r\n#define FASTIOS ios_base::sync_with_stdio(0); cin.tie(0); cout.tie(0);\r\n\r\ntemplate <class X, class Y> bool minimize(X &x, const Y &y) {X eps = 1e-9;if (x > y + eps) {x = y;return true;} else return false;}\r\n\r\ntemplate <class X, class Y> bool maximize(X &x, const Y &y) {X eps = 1e-9;if (x + eps < y) {x = y;return true;} else return false;}\r\n\r\ntemplate <class T> T Abs(const T &x) {return (x < 0 ? -x : x);}\r\n\r\n#define TASK \"295C\"\r\n\r\n/**\tSTART OF CODE.\r\n\tHAVE A COFFEE CUP BEFORE READING MY CODE. **/\r\n\r\n#define int long long \r\n\r\nconst int MAXN = 55;\r\nconst int  MOD = 1e9 + 7;\r\n\r\nint N, K;\r\nint A[MAXN];\r\n\r\nint f[MAXN][MAXN][2], dp[MAXN][MAXN][2];\r\nint C, D;\r\n\r\nstruct DATA {\r\n\tint c, d, h;\t\r\n};\r\n\r\nqueue <DATA> qu;\r\n\r\nstruct Ckn {\r\n\tstatic const int MAXN = 55;\r\n\tstatic const int  MOD = 1e9 + 7;\r\n\r\n\tlong long fac[MAXN + 1000], ifac[MAXN + 1000];\r\n \r\n\tlong long POW(long long A, long long N) { if (N == 0) return 1; if (N == 1) return A % MOD; long long tmp = POW(A, N / 2); if (N % 2) return (tmp * tmp % MOD * A) % MOD; else return (tmp * tmp) % MOD;}\r\n\t\r\n\tvoid PRE(int N) {\r\n\t\tfac[0] = 1;\r\n\t\tfor (int i = 1; i <= N; ++i)\r\n\t\t\tfac[i] = (1ll * i * fac[i - 1]) % MOD;\r\n \r\n\t\tifac[N - 1] = POW(fac[N - 1], MOD - 2);\r\n \r\n\t\tfor (int i = N - 2; i >= 0; --i)\r\n\t\t\tifac[i] = (1ll * (i + 1) * ifac[i + 1]) % MOD;\r\n\t}\r\n \r\n\tlong long CALC(long long r, long long n){\r\n\t\treturn fac[n] * ifac[r] % MOD * ifac[n - r] % MOD;\r\n\t}\r\n} Ckn;\r\n\r\nmain() {\r\n\tFASTIOS;\r\n#ifndef ONLINE_JUDGE\r\n\tfreopen(TASK\".inp\", \"r\", stdin);\r\n\tfreopen(TASK\".out\", \"w\", stdout);\r\n#endif\r\n\r\n\tcin >> N >> K;\r\n\tFOR(i, 1, N) {\r\n\t\tcin >> A[i];\r\n\t\tif (A[i] == 50) C++; else D++;\r\n\t}\r\n\r\n\tCkn.PRE(N + 5);\r\n\r\n\treset(f, -1);\r\n\r\n\tf[C][D][0] = 0;\r\n\tdp[C][D][0] = 1;\r\n\r\n\tqu.push({C, D, 0});\r\n\r\n\twhile (qu.size()) {\r\n\t\tint c = qu.front().c;\r\n\t\tint d = qu.front().d;\r\n\t\tint h = qu.front().h;\r\n\t\tqu.pop();\r\n\t\tif (!h) {\r\n\t\t\tFOR(i, 0, c) {\r\n\t\t\t\tFOR(j, 0, d) {\r\n\t\t\t\t\tif (i + j > 0 && 50 * i + 100 * j <= K) {\r\n\t\t\t\t\t\tint x = C - c;\r\n\t\t\t\t\t\tint y = D - d;\r\n\t\t\t\t\t\tif (f[x + i][y + j][1] == -1) {\r\n\t\t\t\t\t\t\tf[x + i][y + j][1] = f[c][d][0] + 1;\r\n\t\t\t\t\t\t\tdp[x + i][y + j][1] = (dp[c][d][0] * (Ckn.CALC(i, c) % MOD * Ckn.CALC(j, d) % MOD) % MOD) % MOD;\r\n\t\t\t\t\t\t\tdp[x + i][y + j][1] %= MOD;\r\n\t\t\t\t\t\t\tqu.push({x + i, y + j, 1});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (f[x + i][y + j][1] == f[c][d][0] + 1) {\r\n\t\t\t\t\t\t\tdp[x + i][y + j][1] = dp[x + i][y + j][1] + (dp[c][d][0] * (Ckn.CALC(i, c) % MOD * Ckn.CALC(j, d) % MOD) % MOD) % MOD;\r\n\t\t\t\t\t\t\tdp[x + i][y + j][1] %= MOD;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tFOR(i, 0, c) {\r\n\t\t\t\tFOR(j, 0, d) {\r\n\t\t\t\t\tif (i + j > 0 && 50 * i + 100 * j <= K) {\r\n\t\t\t\t\t\tint x = C - c;\r\n\t\t\t\t\t\tint y = D - d;\r\n\t\t\t\t\t\tif (f[x + i][y + j][0] == -1) {\r\n\t\t\t\t\t\t\tf[x + i][y + j][0] = f[c][d][1] + 1;\r\n\t\t\t\t\t\t\tdp[x + i][y + j][0] = (dp[c][d][1] * (Ckn.CALC(i, c) % MOD * Ckn.CALC(j, d) % MOD) % MOD) % MOD;\r\n\t\t\t\t\t\t\tdp[x + i][y + j][0] %= MOD;\r\n\t\t\t\t\t\t\tqu.push({x + i, y + j, 0});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (f[x + i][y + j][0] == f[c][d][1] + 1) {\r\n\t\t\t\t\t\t\tdp[x + i][y + j][0] = dp[x + i][y + j][0] + (dp[c][d][1] * (Ckn.CALC(i, c) % MOD * Ckn.CALC(j, d) % MOD) % MOD) % MOD;\r\n\t\t\t\t\t\t\tdp[x + i][y + j][0] %= MOD;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcout << f[C][D][1] << '\\n' << dp[C][D][1] << '\\n';\r\n\treturn 0;\r\n}\r\n\r\n/**\tEND OF CODE.\r\n\tHAVE YOU FINISHED YOUR CUP OF COFFEE YET??? **/"
}
{
    "id": 108216015,
    "contestId": 1236,
    "creationTimeSeconds": 1614044833,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1236,
        "index": "F",
        "name": "Alice and the Cactus",
        "type": "PROGRAMMING",
        "points": 2500.0,
        "rating": 3000,
        "tags": [
            "dfs and similar",
            "graphs",
            "math",
            "probabilities"
        ]
    },
    "author": {
        "contestId": 1236,
        "members": [
            {
                "handle": "The-Out-Land"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1571319300
    },
    "programmingLanguage": "GNU C++11",
    "verdict": "WRONG_ANSWER",
    "testset": "TESTS",
    "passedTestCount": 3,
    "timeConsumedMillis": 280,
    "memoryConsumedBytes": 210432000,
    "source": "/*************************************************************************\r\n\t> File Name: CF1236F.cpp\r\n\t> Author: The-Out-Land\r\n\t> Mail: [email\u00a0protected] \r\n\t> Created Time: 2021\u5e7402\u670814\u65e5 \u661f\u671f\u65e5 22\u65f622\u520607\u79d2\r\n ************************************************************************/\r\n\r\n#include <bits/stdc++.h>\r\n\r\n#define enter putchar('\\n')\r\n#define space putchar(' ')\r\n#define re register\r\n#define N 2000100\r\n#define M 4000100\r\n#define int long long\r\n\r\nusing namespace std;\r\n\r\n//\u6211\u66fe\u7ecf\u8ba4\u4e3a\uff0c\u65b9\u6848\u6570\u53ef\u4ee5\u4e0d\u7528\u7279\u522b\u8ba1\u7b97\r\n\r\n//\u76f4\u5230\u53d1\u73b0\u4e86\u4ed9\u4eba\u638c\u7684\u4e00\u4e2a\u73af\u4e0a\u6709\u4e24\u6761\u8fb9\r\n\r\nconst int mod=1000000007,in2=500000004;\r\n\r\ninline int max(int x,int y){return (x>y?x:y);}\r\n\r\ninline int min(int x,int y){return (x<y?x:y);}\r\n\r\ninline int read(){\r\n\tint x=0;char c=getchar();bool y=1;\r\n\tfor(;c<'0' || c>'9';c=getchar()) if(c=='-') y=0;\r\n\tfor(;c>='0' && c<='9';c=getchar()) x=(x<<1)+(x<<3)+c-48;\r\n\tif(y) return x;\r\n\treturn -x;\r\n}\r\n\r\nsigned ver[M],nex[M],*head,h1[N],h2[N],nu;\r\n\r\nsigned dfn[N],low[N],tot,st[N],top;\r\n\r\nsigned *d[N],__t[M],cnt,C;\r\n\r\nint n,m;\r\n\r\nint g[N][2],f[N][2],F[2],G[2],sz[N],p2[N],siz[N];\r\n\r\nbool op[N];\r\n\r\ninline void add(int x,int y){\r\n\tver[++nu]=y,nex[nu]=head[x],head[x]=nu;\r\n\tver[++nu]=x,nex[nu]=head[y],head[y]=nu;\r\n\treturn;\r\n}\r\n\r\ninline int Pow(int x,int y){int ans=1;while(y){if(y&1) ans=1ll*ans*x%mod;x=1ll*x*x%mod;y>>=1;} return ans;}\r\ninline int add(int x){if(x<0) return x+mod;return (x>=mod?x-mod:x);}\r\n\r\nvoid dfs1(int x){\r\n\tint y;\r\n\tdfn[x]=low[x]=++tot;\r\n\tst[++top]=x;\r\n\tfor(re int i=head[x];i;i=nex[i]){\r\n\t\ty=ver[i];\r\n\t\tif(!dfn[y]){\r\n\t\t\tdfs1(y);\r\n\t\t\tlow[x]=min(low[x],low[y]);\r\n\t\t\tif(low[y]>=dfn[x]){\r\n\t\t\t\tint z;\r\n\t\t\t\t++C;d[C]=__t+cnt;\r\n\t\t\t\tdo{\r\n\t\t\t\t\tz=st[top--];\r\n\t\t\t\t\td[C][sz[C]++]=z;\r\n\t\t\t\t}while(z!=y);\r\n\t\t\t\td[C][sz[C]++]=x;\r\n\t\t\t\tcnt+=sz[C];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\tlow[x]=min(low[x],dfn[y]);\r\n\t}\r\n\treturn;\r\n}\r\n\r\nvector<int> s1,s2;\r\n\r\n//1\u4e3a\u4e8c\u6b21\u9879\uff0c0\u4e3a\u4e00\u6b21\u9879\r\n\r\n//f\u4e3a\u9009\u62e9\uff0cg\u4e3a\u4e0d\u9009\u62e9\r\n\r\n\r\n/*s1=F[1],s2=F[0],s3=G[1],s4=G[0];\r\nt1=p2[siz[x]],t2=p2[siz[y]-1];\r\n\r\n(trs(s1,s2,f[y][1],f[y][0],t1,t2,0))*/\r\n\r\ninline int trs(int X2,int X1,int Y2,int Y1,int Z1,int Z2,int ret){\r\n\treturn (X2*Z2+Y2*Z1+ret*ret*Z1*Z2+2*(X1*Y1+ret*X1*Z2+ret*Y1*Z1))%mod;\r\n}\r\n\r\nvoid dfs2(int x,int fx){\r\n\tint y,ret=0,t1,t2,t3;\r\n\tif(x<=n){\r\n\t\tf[x][1]=f[x][0]=1;\r\n\t\tsiz[x]=1;\r\n\t\tfor(re int i=head[x];i;i=nex[i]){\r\n\t\t\ty=ver[i];\r\n\t\t\tif(y==fx) continue;\r\n\t\t\tdfs2(y,x);\r\n\t\t\tt1=p2[siz[x]-1];\r\n\t\t\tt3=p2[siz[y]-op[y]-1];\r\n\t\t\tt2=add(p2[siz[y]]-t3);\r\n\t\t\t//cout<<t1<<\" \"<<t2<<\" \"<<t3<<endl;\r\n\t\t\tf[x][1]=(f[x][1]*(t2+t3)-2*f[x][0]*t2+2*f[x][0]*(f[y][0]+g[y][0])-(2*f[y][0]-g[y][1]-f[y][1])*t1%mod+t1*t2)%mod;\r\n\t\t\tf[x][0]=(f[x][0]*(t2+t3)+(f[y][0]+g[y][0])*t1-t1*t2)%mod;\r\n\t\t\tg[x][1]=(g[x][1]*(t2+t3)+2*(f[y][0]+g[y][0])*g[x][0]+(g[y][1]+f[y][1])*t1)%mod;\r\n\t\t\tg[x][0]=(g[x][0]*(t2+t3)+(f[y][0]+g[y][0])*t1)%mod;\r\n\t\t\tsiz[x]+=siz[y];\r\n\t\t}\r\n\t}\r\n\telse{\r\n\t\tfor(re int i=head[x];i;i=nex[i]){\r\n\t\t\ty=ver[i];\r\n\t\t\tif(y==fx) continue;\r\n\t\t\tdfs2(y,x);\r\n\t\t}\r\n\t\ts1.clear(),s2.clear();\r\n\t\tfor(re int i=head[x];i;i=nex[i]){\r\n\t\t\ty=ver[i];\r\n\t\t\tif(y==fx){swap(s1,s2);continue;}\r\n\t\t\ts1.push_back(y);\r\n\t\t}\r\n\t\treverse(s1.begin(),s1.end());\r\n\t\treverse(s2.begin(),s2.end());\r\n\t\ttop=0;\r\n\t\twhile(!s1.empty()) st[++top]=s1.back(),s1.pop_back();\r\n\t\twhile(!s2.empty()) st[++top]=s2.back(),s2.pop_back();\r\n\t\tint s1=0,s2=0,s3=0,s4=0;\r\n\t\tF[0]=F[1]=G[0]=G[1]=0;\r\n\r\n\t\ty=st[1];siz[x]=0;\r\n\t\tG[1]=G[0]=0;\r\n\t\tF[1]=f[y][1];F[0]=f[y][0];\r\n\t\tsiz[x]+=siz[y];\r\n\t\tfor(re int i=2;i<=top;++i){\r\n\t\t\ty=st[i];\r\n\t\t\ts1=F[1],s2=F[0],s3=G[1],s4=G[0];\r\n\t\t\tt1=p2[siz[x]-1],t2=p2[siz[y]-1],t3=p2[siz[x]];\r\n\t\t\tif(i==2){\r\n\t\t\t\tF[1]=(trs(s1,s2,f[y][1],f[y][0],t1,t2,-1));\r\n\t\t\t\tF[0]=(s2*t2+f[y][0]*t1-t1*t2)%mod;\r\n\t\t\t\tG[1]=(trs(s1,s2,g[y][1],g[y][0],t1,t2,0));\r\n\t\t\t\tG[0]=(s2*t2+g[y][0]*t1-0)%mod;\r\n\t\t\t\tsiz[x]+=siz[y];\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tF[1]=(trs(s1,s2,f[y][1],f[y][0],t1,t2,-1)+trs(s3,s4,f[y][1],f[y][0],t1,t2,0));\r\n\t\t\tF[0]=(s2*t2+f[y][0]*t3-t1*t2+s4*t2)%mod;\r\n\t\t\tG[1]=(trs(s1,s2,g[y][1],g[y][0],t1,t2,0) +trs(s3,s4,g[y][1],g[y][0],t1,t2,0));\r\n\t\t\tG[0]=(s2*t2+g[y][0]*t3-0+s4*t2)%mod;\r\n\t\t\tsiz[x]+=siz[y];\r\n\t\t}\r\n\r\n\t\tf[x][1]=add(F[1]+G[1]);\r\n\t\tf[x][0]=add(F[0]+G[0]);\r\n\r\n\t\ty=st[1];siz[x]=0;\r\n\t\tF[1]=F[0]=0;\r\n\t\tG[1]=g[y][1],G[0]=g[y][0];\r\n\t\tsiz[x]+=siz[y];\r\n\r\n\t\tfor(re int i=2;i<=top;++i){\r\n\t\t\ty=st[i];\r\n\t\t\ts1=F[1],s2=F[0],s3=G[1],s4=G[0];\r\n\t\t\tt1=p2[siz[x]-1],t2=p2[siz[y]-1],t3=p2[siz[x]];\r\n\t\t\tif(i==2){\r\n\t\t\t\tF[1]=(trs(s3,s4,f[y][1],f[y][0],t1,t2,0));\r\n\t\t\t\tF[0]=(s4*t2+f[y][0]*t1-0)%mod;\r\n\t\t\t\tG[1]=(trs(s3,s4,g[y][1],g[y][0],t1,t2,0));\r\n\t\t\t\tG[0]=(s4*t2+g[y][0]*t1-0)%mod;\r\n\t\t\t\t//cout<<s1<<\" ?? \"<<s2<<\" \"<<g[y][1]<<\" \"<<g[y][0]<<\" \"<<t1<<\" \"<<t2<<endl;\r\n\t\t\t\tsiz[x]+=siz[y];\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tF[1]=(trs(s1,s2,f[y][1],f[y][0],t1,t2,0)+trs(s3,s4,f[y][1],f[y][0],t1,t2,0));\r\n\t\t\tF[0]=(s2*t2+f[y][0]*t3-t1*t2+s4*t2)%mod;\r\n\t\t\tG[1]=(trs(s1,s2,g[y][1],g[y][0],t1,t2,0)+trs(s3,s4,g[y][1],g[y][0],t1,t2,0));\r\n\t\t\tG[0]=(s2*t2+g[y][0]*t3-0+s4*t2)%mod;\r\n\t\t\tsiz[x]+=siz[y];\r\n\t\t}\r\n\t\tf[x][1]=add(f[x][1]+F[1]);\r\n\t\tf[x][0]=add(f[x][0]+F[0]);\r\n\t\tg[x][1]=G[1];\r\n\t\tg[x][0]=G[0];\r\n\t}\r\n\r\n\t//cout<<x<<\" \"<<f[x][0]<<\" \"<<f[x][1]<<\" \"<<g[x][0]<<\" \"<<g[x][1]<<endl;\r\n\treturn;\r\n}\r\n\r\ninline void pre(){p2[0]=1;for(re int i=1;i<N;++i) p2[i]=add(p2[i-1]<<1);return;}\r\n\r\ninline void Input(){\r\n\tn=read(),m=read();\r\n\thead=h1;\r\n\tfor(re int i=1;i<=m;++i){\r\n\t\tadd(read(),read());\r\n\t}\r\n\treturn;\r\n}\r\n\r\ninline void solve(){\r\n\tdfs1(1);\r\n\thead=h2;\r\n\ttop=0;\r\n\tfor(re int i=1;i<=C;++i){\r\n\t\tfor(re int j=0;j<sz[i];++j)\r\n\t\tadd(i+n,d[i][j]);\r\n\t\tif(sz[i]>2)\r\n\t\top[i+n]=1;\r\n\t}\r\n\tdfs2(1,0);\r\n\tint S1=add(f[1][1]+g[1][1]),S2=add(f[1][0]+g[1][0]),In=Pow(2,mod-1-n);S1=S1*In%mod;S2=S2*In%mod;\r\n\tcout<<add(S1-S2*S2%mod)<<endl;\r\n\treturn;\r\n}\r\n\r\nsigned main(){\r\n\tpre();\r\n\tInput();\r\n\tsolve();\r\n\treturn 0;\r\n}"
}
{
    "id": 205906167,
    "contestId": 1821,
    "creationTimeSeconds": 1684085890,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1821,
        "index": "F",
        "name": "Timber",
        "type": "PROGRAMMING",
        "rating": 2600,
        "tags": [
            "combinatorics",
            "dp",
            "fft",
            "math"
        ]
    },
    "author": {
        "contestId": 1821,
        "members": [
            {
                "handle": "minhnguyenxuan60"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1682001300
    },
    "programmingLanguage": "GNU C++20 (64)",
    "verdict": "OK",
    "testset": "TESTS",
    "passedTestCount": 99,
    "timeConsumedMillis": 1465,
    "memoryConsumedBytes": 33894400,
    "source": "\t/*\r\n\t#pragma GCC optimize(\"Ofast\")\r\n\t#pragma GCC optimize(\"unroll-loops\")\r\n\t#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native\")\r\n\t*/\r\n\t#include<bits/stdc++.h>\r\n\tusing namespace std;\r\n\t#define rep(i, a, b) for(int i = a; i < (b); ++i)\r\n\t#define all(x) begin(x), end(x)\r\n\t#define sz(x) (int)(x).size()\r\n\ttypedef long long ll;\r\n\ttypedef pair<int, int> pii;\r\n\ttypedef vector<int> vi;\r\n\t#define f first\r\n\t#define s second\r\n\r\n\tint64_t mod=(1<<23)*7*17+1,wn=31,r=1<<23,wn1=128805723;\r\n\tll POW (ll a, ll b) {\r\n\t\tll sol = 1;\r\n\t\tfor (; b; b /= 2, a = a * a % mod) if (b & 1) sol = sol * a % mod;\r\n\t\treturn sol;\r\n\t}\r\n\t// NTT for mod=998244353\r\n\tvoid fft (vector<int64_t>&a,bool inv) {\r\n\t    int n=a.size(),l=31-__builtin_clz(n);\r\n\t    vector<int> rev(n);\r\n\t    for (int i=1;i<n;i++) rev[i]=(rev[i/2]|((i&1)<<l))/2;\r\n\t    for (int i=0;i<n;i++) if (rev[i]>i) swap(a[rev[i]],a[i]);\r\n\t \r\n\t    for (int len=2;len<=n;len*=2) {\r\n\t        int64_t wlen=(!inv?POW(wn,r/len):POW(wn1,r/len));\r\n\t        for (int i=0;i<n;i+=len) {\r\n\t            int64_t w=1;\r\n\t            for (int j=0;j<len/2;j++,w=w*wlen%mod) {\r\n\t                int64_t u=a[i+j],v=a[i+j+len/2]*w%mod;\r\n\t                a[i+j]=(u+v)%mod;\r\n\t                a[i+j+len/2]=(u-v+mod)%mod;\r\n\t            }\r\n\t        }\r\n\t    }\r\n\t    if (inv) {\r\n\t        int64_t tmp=POW(n,mod-2);\r\n\t        for (int i=0;i<n;i++) a[i]=a[i]*tmp%mod;\r\n\t    }\r\n\t}\r\n\tvoid mul (vector<int64_t>&a, vector<int64_t>&b) {\r\n\t    //Answer of a * b is a\r\n\t    int n=1;\r\n\t    while (n<(int)(a.size()+b.size())) n*=2;\r\n\t    a.resize(n);\r\n\t    b.resize(n);\r\n\t    fft(a,false);\r\n\t    fft(b,false);\r\n\t    for (int i=0;i<n;i++) a[i]=a[i]*b[i]%mod;\r\n\t    fft(a,true);\r\n\t}\r\n\tvector<ll> fact((int)1e6);\r\n\tll C(ll a, ll b) {\r\n\t\treturn fact[b] * POW(fact[a] * fact[b - a] % mod, mod - 2) % mod;\r\n\t}\r\n\tvoid solve () {\r\n\t\tint n, m, k;\r\n\t\tcin >> n >> m >> k;\r\n\t\tk++;\r\n\t\tfact[0] = 1;\r\n\t\tfor (int i = 1; i < (int)1e6; i++) fact[i] = fact[i - 1] * i % mod;\r\n\t\tvector<ll> a(n + 1), b(n + 1), c(n + 1, 1), pow2(n + 1);\r\n\t\tpow2[0] = 1;\r\n\t\tfor (int i = 1; i <= n; i++) pow2[i] = pow2[i - 1] * 2 % mod;\r\n\t\tfor (int i = 0; i <= m; i++) {\r\n\t\t\tll deg = (ll)(k - 1) * (m - i) + (ll)k * m;\r\n\t\t\tif (deg > n) continue;\r\n\t\t\tll coef = C(i, m) * pow2[i] % mod;\r\n\t\t\tif ((m - i) % 2 == 1) coef = -coef;\r\n\t\t\ta[deg] = coef;\r\n\t\t}\r\n\t\tfor (int i = 0; i <= n; i++) {\r\n\t\t\tb[i] = C(m - 1, i + m - 1);\r\n\t\t}\r\n\t\tmul(a, b);\r\n\t\ta.resize(n + 1);\r\n\t\t// for (int i = 0; i <= n; i++) cout << b[i] % mod << \" \";\r\n\t\t// cout << '\\n';\r\n\t\tfor (int i = 1; i <= n; i++) a[i] = (a[i] + a[i - 1]) % mod;\r\n \t\tcout << (a[n] % mod + mod) % mod << '\\n';\r\n\t}\r\n\tint main (){\r\n\t\tios::sync_with_stdio(0);cin.tie(0);\r\n\t\t//freopen(\"input.inp\",\"r\",stdin);\r\n\t    //freopen(\"output.out\",\"w\",stdout);\r\n\t\tint casi = 1;\r\n\t    while (casi--) solve();\r\n\t\treturn 0;\r\n\t}"
}
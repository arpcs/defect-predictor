{
    "id": 213780641,
    "contestId": 1821,
    "creationTimeSeconds": 1689340946,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1821,
        "index": "F",
        "name": "Timber",
        "type": "PROGRAMMING",
        "rating": 2600,
        "tags": [
            "combinatorics",
            "dp",
            "fft",
            "math"
        ]
    },
    "author": {
        "contestId": 1821,
        "members": [
            {
                "handle": "pigpigger"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1682001300
    },
    "programmingLanguage": "GNU C++17",
    "verdict": "OK",
    "testset": "TESTS",
    "passedTestCount": 99,
    "timeConsumedMillis": 1185,
    "memoryConsumedBytes": 234086400,
    "source": "#include<bits/stdc++.h>\n#define de fprintf(stderr,\"on-%d\\n\",__LINE__)\n#define int long long\n#define fr(i,a,b) for(int i(a),end##i(b);i<=end##i;i++)\n#define fd(i,a,b) for(int i(a),end##i(b);i>=end##i;i--)\nusing namespace std;\nconst int maxn=4e6+5,mod=998244353,G=3;\ninline int upd(const int &x){\n\tif(x<0)return x+mod;\n\tif(x>=mod)return x-mod;\n\treturn x;\n}\ninline void add(int &x,const int &y){\n\tx=upd(x+y);\n}\nint ksm(int x,int k){\n\tint ans=1;\n\twhile(k){\n\t\tif(k&1)ans=ans*x%mod;\n\t\tx=x*x%mod;\n\t\tk>>=1;\n\t}\n\treturn ans;\n}\nint jc[maxn],iv[maxn];\nvoid init(int n){\n\tjc[0]=1;\n\tfr(i,1,n)jc[i]=jc[i-1]*i%mod;\n\tiv[n]=ksm(jc[n],mod-2);\n\tfd(i,n-1,0)iv[i]=iv[i+1]*(i+1)%mod;\n}\nint ny(int n){\n\treturn iv[n]*jc[n-1]%mod;\n}\nconst int invg=ksm(G,mod-2);\nint rev[maxn];\nvoid F(int *f,int n,int h){\n\tfr(i,0,n-1)if(rev[i]<i)swap(f[rev[i]],f[i]);\n\tfor(int p=1;p<n;p<<=1){\n\t\tint wn=ksm(h==1?G:invg,(mod-1)/(p<<1));\t\n\t\tfor(int i=0;i<n;i+=p<<1)\n\t\t\tfor(int k=i,w=1;k<i+p;k++,w=w*wn%mod){\n\t\t\t\tint x=f[k],y=f[k+p]*w%mod;\t\n\t\t\t\tf[k]=upd(x+y);\n\t\t\t\tf[k+p]=upd(x-y);\n\t\t\t}\n\t}\n\tif(h==-1){\n\t\tint invn=ksm(n,mod-2);\n\t\tfr(i,0,n-1)f[i]=f[i]*invn%mod;\n\t}\n}\nvector<int> operator *(const vector<int>& A,const vector<int>& B){\n\tstatic int a[maxn],b[maxn]; \n\tint N=1;\n\twhile(N-1<=A.size()-1+B.size()-1)N<<=1;\n\tfr(i,1,N)rev[i]=(rev[i>>1]>>1)|(i&1?N>>1:0);\n\tfr(i,0,N-1)a[i]=b[i]=0;\n\tfr(i,0,A.size()-1)a[i]=A[i];fr(i,0,B.size()-1)b[i]=B[i];\n\tF(a,N,1);F(b,N,1);\n\tfr(i,0,N-1)a[i]=a[i]*b[i]%mod;\n\tF(a,N,-1);\n\tvector<int> C;C.resize(A.size()+B.size()-1);\n\tfr(i,0,C.size()-1)C[i]=a[i];\n\treturn C;\n}\nvector<int> operator -(vector<int> A,const vector<int>&B){\n\tif(B.size()>A.size())A.resize(B.size());\n\tfr(i,0,B.size()-1)add(A[i],-B[i]);\n\treturn A;\n}\nvector<int> operator +(vector<int> A,const vector<int>&B){\n\tif(B.size()>A.size())A.resize(B.size());\n\tfr(i,0,B.size()-1)add(A[i],B[i]);\n\treturn A;\n}\nvector<int> operator *(vector<int> A,const int &x){\n\tfr(i,0,A.size()-1)A[i]=A[i]*x%mod;\n\treturn A;\n}\nvector<int> inv(vector<int> A,int N){\n\tvector<int> F,f0;\t\n\tF.push_back(ksm(A[0],mod-2));\n\tfor(int n=2;n>>1<N;n<<=1){\n\t\tf0=F;\n\t\tF=f0*2-f0*f0*A;\n\t\tF.resize(n);\n\t}\n\tF.resize(N);\n\treturn F;\n}\nvoid out(const vector<int> &A){\n\tfr(i,0,A.size()-1)printf(\"%lld \",A[i]);\n\tprintf(\"\\n\");\n}\nvector<int> D(vector<int> A){\n\tfr(i,0,A.size()-2)A[i]=A[i+1]*(i+1)%mod;\n\tA.resize(A.size()-1);\n\treturn A;\t\n}\nvector<int> Int(vector<int> A){\n\tA.resize(A.size()+1);\n\tfd(i,A.size()-1,1)A[i]=A[i-1]*ny(i)%mod;\n\tA[0]=0;\n\treturn A;\n}\nvector<int> ln(const vector<int> &A,int n){\n\tvector<int> C=D(A)*inv(A,n);\n\tC.resize(n);\n\tC=Int(C);\n\tC.resize(n);\t\n\treturn C;\n}\nvector<int> exp(const vector<int> &A,int N){\n\tvector<int> f0,F,G;\n\tF.push_back(1);\n\tfor(int n=2;n>>1<N;n<<=1){\n\t\tf0=F;\n\t\tG.resize(n);\n\t\tfr(i,0,G.size()-1)G[i]=i<(int)A.size()?A[i]:0;\n\t\tF=f0-(ln(f0,n)-G)*f0;\n\t\tF.resize(n);\n\t}\n\tF.resize(N);\n\treturn F;\n}\nint C(int n,int m){\n\tif(n<0||m<0||n<m)return 0;\n\treturn jc[n]*iv[m]%mod*iv[n-m]%mod;\n}\nint sgn(int n){\n\treturn n&1?-1:1;\n}\nint n,m,k;\nint p[maxn],ip[maxn];\n#define V(n) ((n)<0?0:A[n])\nvector<int> A,B;\nsigned main(){\n#ifdef pig\n\tfreopen(\"pig.in\",\"r\",stdin);\n\tfreopen(\"pig.out\",\"w\",stdout);\n#endif\n\tcin>>n>>m>>k;\n\tint N=1;\n\twhile(N-1<n)N<<=1;\n\t//cout<<N<<'\\n';\n\tinit(N<<1);\n\tA.resize(n+1);B.resize(n+1);\n\tp[0]=1;\n\tfr(i,1,n+1)p[i]=upd(p[i-1]<<1);\n\tip[0]=1;\n\tfr(i,1,n+1)ip[i]=ip[i-1]*iv[2]%mod;\n\tfr(i,0,n)A[i]=C(i+m,i);\n\tfr(i,0,min(n/k,m+1))B[i*k]=sgn(i)*C(m+1,i)*p[m+1-i]%mod;\n\t//fr(i,0,n)if(A[i])cout<<A[i]<<'';cout<<'\\n';\n\tA=A*B;\n\t//fr(i,0,n)assert(!A[i]);\n\tint ans=0;\n\tfr(i,0,n/k){\n\t\tadd(ans,V(n-(i+1)*k-(m+1)*k+2*k-m)*ip[i+1]%mod);\n\t\t//cout<<V(n-(i+1)*k-(m+1)*k+2*k-m)<<\"\\n\";\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n"
}
{
    "id": 209766338,
    "contestId": 1821,
    "creationTimeSeconds": 1686834953,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1821,
        "index": "F",
        "name": "Timber",
        "type": "PROGRAMMING",
        "rating": 2600,
        "tags": [
            "combinatorics",
            "dp",
            "fft",
            "math"
        ]
    },
    "author": {
        "contestId": 1821,
        "members": [
            {
                "handle": "Ctera"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1682001300
    },
    "programmingLanguage": "GNU C++14",
    "verdict": "RUNTIME_ERROR",
    "testset": "TESTS",
    "passedTestCount": 4,
    "timeConsumedMillis": 343,
    "memoryConsumedBytes": 8396800,
    "source": "// testing \r\n#include <bits/stdc++.h>\r\nusing namespace std;\r\nconst int N = 3e5 + 5;\r\nconst int P = 998244353;\r\nconst int G = 3;\r\nconst int GI = 332748118;\r\nint r[N];\r\nint c[N], p[N], q[N], u[N];\r\nint f[N], g[N];\r\nint fp(int x,int y) {\r\n    int res = 1;\r\n    for(;y;y >>= 1) {\r\n        if(y & 1) res = (1ll * res * x) % P;\r\n        x = (1ll * x * x) % P;\r\n    }\r\n    return res;\r\n}\r\nvoid NTT(int *a, int lim, int opt) {\r\n    for(int i=0;i<lim;i++) {\r\n        if(i < r[i]) swap(a[i], a[r[i]]);\r\n    }\r\n    for(int i=1;i<lim;i<<=1) {\r\n        int wn = fp((opt == 1 ? G : GI), (P - 1) / (i << 1));\r\n        for(int j=0;j<lim;j+=(i<<1)) {\r\n            int w = 1;\r\n            for(int k=0;k<i;k++, w = (1ll * w * wn) % P) {\r\n                int x = a[j + k];\r\n                int y = (1ll * w * a[j + k + i]) % P;\r\n                a[j + k] = (x + y) % P;\r\n                a[j + k + i] = (x - y + P) % P;\r\n            }\r\n        }\r\n    }\r\n    if(opt == 1) return;\r\n    int inv = fp(lim, P - 2);\r\n    for(int i=0;i<lim;i++) a[i] = (1ll * a[i] * inv) % P;\r\n}\r\nvoid invs(int *a,int *b,int d) {\r\n    if(d == 1) {\r\n        b[0] = fp(a[0], P - 2);\r\n        return;\r\n    }\r\n    invs(a, b, (d + 1) >> 1);\r\n    int lim = 1,l = 0;  \r\n    while(lim < (d << 1)) {\r\n        lim <<= 1;\r\n        l++;\r\n    }\r\n    for(int i=0;i<lim;i++) c[i] = a[i];\r\n    for(int i=d;i<lim;i++) c[i] = 0;\r\n    for(int i=0;i<lim;i++) r[i] = (r[i >> 1] >> 1) | ((i & 1) << (l - 1));\r\n    NTT(b, lim, 1);\r\n    NTT(c, lim , 1);\r\n    for(int i=0;i<lim;i++) b[i] = (2 - 1ll * c[i] * b[i] % P + P) % P * 1ll * b[i] % P;\r\n    NTT(b, lim, -1);\r\n    for(int i=d;i<lim;i++) b[i] = 0;\r\n}\r\nvoid lns(int *a,int *b,int d) {\r\n    for(int i=1;i<d;i++) p[i - 1] = (1ll * i * a[i]) % P;\r\n    p[d - 1] = 0;\r\n    invs(a, q, d);\r\n    int lim = 1,l = 0;  \r\n    while(lim < (d << 1)) {\r\n        lim <<= 1;\r\n        l++;\r\n    }\r\n    for(int i=0;i<lim;i++) r[i] = (r[i >> 1] >> 1) | ((i & 1) << (l - 1));\r\n    NTT(p, lim, 1);\r\n    NTT(q, lim, 1);\r\n    for(int i=0;i<lim;i++) p[i] = (1ll * p[i] * q[i]) % P;\r\n    NTT(p, lim, -1);\r\n    for(int i=1;i<d;i++) b[i] = (1ll * p[i - 1] * fp(i, P - 2)) % P;\r\n    b[0] = 0;\r\n    for(int i=0;i<lim;i++) p[i] = q[i] = 0;\r\n}\r\nvoid exps(int *a,int *b,int d){\r\n    if(d == 1){\r\n        b[0] = 1;\r\n        return;\r\n    }\r\n    exps(a, b, (d + 1) >> 1);\r\n    lns(b, u, d);\r\n    u[0] = (a[0] + 1 - u[0] + P) % P;\r\n    for(int i=1;i<d;i++) u[i] = (a[i] - u[i] + P) % P;\r\n    int lim = 1,l = 0;\r\n    while(lim < (d << 1)) {\r\n        lim <<= 1;\r\n        l++;\r\n    }\r\n    for(int i=0;i<lim;i++) r[i] = (r[i >> 1] >> 1) | ((i & 1) << (l - 1));\r\n    NTT(b,lim,1);\r\n    NTT(u,lim,1);\r\n    for(int i=0;i<lim;i++) b[i] = (1ll * b[i] * u[i]) % P;\r\n    NTT(b,lim,-1);\r\n    for(int i=d;i<lim;i++) u[i] = b[i] = 0;\r\n}\r\nvoid fps(int *a, int *b, int d, int x) {\r\n    int pos = 0;\r\n    for(int i=0;i<d;i++) if(a[i]) {pos = i; break;}\r\n    for(int i=0;i<d;i++) a[i] = a[i + pos];\r\n    if(1ll * pos * x > 1ll * d) {\r\n        for(int i=0;i<d;i++) a[i] = 0;\r\n        return;\r\n    }\r\n    pos *= x;\r\n    int val = a[0];\r\n    for(int i=0;i<d;i++) a[i] = (1ll * a[i] * fp(val, P - 2)) % P;\r\n    lns(a, b, d);\r\n    for(int i=0;i<d;i++) b[i] = (1ll * b[i] * x) % P;\r\n    for(int i=0;i<d;i++) a[i] = 0;\r\n    exps(b, a, d);\r\n    for(int i=0;i<d;i++) a[i] = (1ll * a[i] * fp(val, x)) % P;\r\n    for(int i=d-1;i>=pos;i--) a[i] = a[i - pos];\r\n    for(int i=0;i<pos;i++) a[i] = 0;\r\n}\r\nvoid solve() {\r\n    int n, m, k;\r\n    cin >> n >> m >> k;\r\n    for(int i=k + 1;i<=k * 2;i++) f[i] += 2;\r\n    for(int i=k * 2 + 1;i<=n;i++) f[i] += 1;\r\n    fps(f, g, n + 1, m);\r\n    int ans = 0;\r\n    for(int i=1;i<=n;i++) ans = (ans + f[i]) % P;\r\n    cout << ans << endl;\r\n    if (n==300000) puts(\"test\");\r\n}\r\nint main() {\r\n    ios :: sync_with_stdio(0);\r\n    cin.tie(0); cout.tie(0);\r\n    solve();\r\n    return 0;\r\n}"
}
{
    "id": 120301020,
    "contestId": 682,
    "creationTimeSeconds": 1624372832,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 682,
        "index": "E",
        "name": "Alyona and Triangles",
        "type": "PROGRAMMING",
        "points": 3000.0,
        "rating": 2600,
        "tags": [
            "geometry",
            "two pointers"
        ]
    },
    "author": {
        "contestId": 682,
        "members": [
            {
                "handle": "IAKCodeForces"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1466181300
    },
    "programmingLanguage": "GNU C++11",
    "verdict": "OK",
    "testset": "TESTS",
    "passedTestCount": 66,
    "timeConsumedMillis": 171,
    "memoryConsumedBytes": 2969600,
    "source": "#include <bits/stdc++.h>\r\nusing namespace std;\r\nconst double eps=1e-8;\r\nconst double inf = 1e20;\r\nconst double pi = acos(-1.0);\r\nconst int maxp = 10020;\r\n//Compares a double to zero\r\nint sgn(double x) {\r\n\tif(fabs(x) < eps)return 0;\r\n\tif(x < 0)return -1;\r\n\telse return 1;\r\n}\r\ndouble Abs(double x) {\r\n\treturn x*sgn(x);\r\n}//square of a double\r\ninline double sqr(double x) {\r\n\treturn x*x;\r\n}\r\nstruct Point {\r\n\tdouble x,y;\r\n\tPoint() {}\r\n\tPoint(double _x,double _y) {\r\n\t\tx = _x;\r\n\t\ty = _y;\r\n\t}\r\n\tvoid input() {\r\n\t\tscanf(\"%lf%lf\",&x,&y);\r\n\t}\r\n\tvoid output() {\r\n\t\tprintf(\"%.2f %.2f\\n\",x,y);\r\n\t}\r\n\tbool operator == (Point b)const {\r\n\t\treturn sgn(x-b.x) == 0 && sgn(y-b.y) == 0;\r\n\t}\r\n\tbool operator < (Point b)const {\r\n\t\treturn sgn(x-b.x)== 0?sgn(y-b.y)<0:x<b.x;\r\n\t}\r\n\tPoint operator -(const Point &b)const {\r\n\t\treturn Point(x-b.x,y-b.y);\r\n\t}\r\n\t//\u53c9\u79ef\r\n\tdouble operator ^(const Point &b)const {\r\n\t\treturn x*b.y-y*b.x;\r\n\t}\r\n\t//\u70b9\u79ef\r\n\tdouble operator *(const Point &b)const {\r\n\t\treturn x*b.x + y*b.y;\r\n\t}\r\n\t//\u8fd4\u56de\u957f\u5ea6\r\n\tdouble len() {\r\n\t\treturn hypot(x,y);//\u5e93\u51fd\u6570\r\n\t}\r\n\t//\u8fd4\u56de\u957f\u5ea6\u7684\u5e73\u65b9\r\n\tdouble len2() {\r\n\t\treturn x*x + y*y;\r\n\t}\r\n\t//\u8fd4\u56de\u4e24\u70b9\u7684\u8ddd\u79bb\r\n\tdouble distance(Point p) {\r\n\t\treturn hypot(x-p.x,y-p.y);\r\n\t}\r\n\tPoint operator +(const Point &b)const {\r\n\t\treturn Point(x+b.x,y+b.y);\r\n\t}\r\n\tPoint operator *(const double &k)const {\r\n\t\treturn Point(x*k,y*k);\r\n\t}\r\n\tPoint operator /(const double &k)const {\r\n\t\treturn Point(x/k,y/k);\r\n\t}\r\n\t//\u8ba1\u7b97 pa \u548c pb \u7684\u5939\u89d2\r\n\t//\u5c31\u662f\u6c42\u8fd9\u4e2a\u70b9\u770b a,b \u6240\u6210\u7684\u5939\u89d2\r\n\t//\u6d4b\u8bd5 LightOJ1203\r\n\tdouble rad(Point a,Point b) {\r\n\t\tPoint p = *this;\r\n\t\treturn fabs(atan2(fabs((a-p)^(b-p)),(a-p)*(b-p)));\r\n\t}\r\n\t//\u5316\u4e3a\u957f\u5ea6\u4e3a r \u7684\u5411\u91cf\r\n\tPoint trunc(double r) {\r\n\t\tdouble l = len();\r\n\t\tif(!sgn(l))return *this;\r\n\t\tr /= l;\r\n\t\treturn Point(x*r,y*r);\r\n\t}\r\n\t//\u9006\u65f6\u9488\u65cb\u8f6c 90 \u5ea6\r\n\tPoint rotleft() {\r\n\t\treturn Point(-y,x);\r\n\t}\r\n\t//\u987a\u65f6\u9488\u65cb\u8f6c 90 \u5ea6\r\n\tPoint rotright() {\r\n\t\treturn Point(y,-x);\r\n\t}\r\n\t//\u7ed5\u7740 p \u70b9\u9006\u65f6\u9488\u65cb\u8f6c angle\r\n\tPoint rotate(Point p,double angle) {\r\n\t\tPoint v = (*this)-p;\r\n\t\tdouble c = cos(angle), s = sin(angle);\r\n\t\treturn Point(p.x + v.x*c-v.y*s,p.y + v.x*s + v.y*c);\r\n\t}\r\n};\r\nstruct Line {\r\n\tPoint s,e;\r\n\tLine() {}\r\n\tLine(Point _s,Point _e) {\r\n\t\ts = _s;\r\n\t\te = _e;\r\n\t}\r\n\tbool operator ==(Line v) {\r\n\t\treturn (s == v.s)&&(e == v.e);\r\n\t}\r\n\t//\u6839\u636e\u4e00\u4e2a\u70b9\u548c\u503e\u659c\u89d2 angle \u786e\u5b9a\u76f4\u7ebf,0<=angle<pi\r\n\tLine(Point p,double angle) {\r\n\t\ts = p;\r\n\t\tif(sgn(angle-pi/2) == 0) {\r\n\t\t\te = (s + Point(0,1));\r\n\t\t} else {\r\n\t\t\te = (s + Point(1,tan(angle)));\r\n\t\t}\r\n\t}\r\n\t//ax+by+c=0\r\n\tLine(double a,double b,double c) {\r\n\t\tif(sgn(a) == 0) {\r\n\t\t\ts = Point(0,-c/b);\r\n\t\t\te = Point(1,-c/b);\r\n\t\t} else if(sgn(b) == 0) {\r\n\t\t\ts = Point(-c/a,0);\r\n\t\t\te = Point(-c/a,1);\r\n\t\t} else {\r\n\t\t\ts = Point(0,-c/b);\r\n\t\t\te = Point(1,-(c+a)/b);\r\n\t\t\t//e = Point(-c/a,0);\r\n\t\t}\r\n\t}\r\n\tvoid input() {\r\n\t\ts.input();\r\n\t\te.input();\r\n\t}\r\n\tvoid adjust() {\r\n\t\tif(e < s)swap(s,e);\r\n\t}\r\n\t//\u6c42\u7ebf\u6bb5\u957f\u5ea6\r\n\tdouble length() {\r\n\t\treturn s.distance(e);\r\n\t}\r\n\t//\u8fd4\u56de\u76f4\u7ebf\u503e\u659c\u89d2 0<=angle<pi\r\n\tdouble angle() {\r\n\t\tdouble k = atan2(e.y-s.y,e.x-s.x);\r\n\t\tif(sgn(k) < 0)k += pi;\r\n\t\tif(sgn(k-pi) == 0)k -= pi;\r\n\t\treturn k;\r\n\t}\r\n\t//\u70b9\u548c\u76f4\u7ebf\u5173\u7cfb\r\n\t//1 \u5728\u5de6\u4fa7\r\n\t//2 \u5728\u53f3\u4fa7\r\n\t//3 \u5728\u76f4\u7ebf\u4e0a\r\n\tint relation(Point p) {\r\n\t\tint c = sgn((p-s)^(e-s));\r\n\t\tif(c < 0)return 1;\r\n\t\telse if(c > 0)return 2;\r\n\t\telse return 3;\r\n\t}\r\n\t// \u70b9\u5728\u7ebf\u6bb5\u4e0a\u7684\u5224\u65ad\r\n\tbool pointonseg(Point p) {\r\n\t\treturn sgn((p-s)^(e-s)) == 0 && sgn((p- s)*(p- e)) <= 0;\r\n\t}\r\n\t//\u4e24\u5411\u91cf\u5e73\u884c (\u5bf9\u5e94\u76f4\u7ebf\u5e73\u884c\u6216\u91cd\u5408)\r\n\tbool parallel(Line v) {\r\n\t\treturn sgn((e-s)^(v.e-v.s)) == 0;\r\n\t}\r\n\t//\u4e24\u7ebf\u6bb5\u76f8\u4ea4\u5224\u65ad\r\n\t//2 \u89c4\u8303\u76f8\u4ea4\r\n\t//1 \u975e\u89c4\u8303\u76f8\u4ea4\r\n\t//0 \u4e0d\u76f8\u4ea4\r\n\tint segcrossseg(Line v) {\r\n\t\tint d1 = sgn((e-s)^(v.s-s));\r\n\t\tint d2 = sgn((e-s)^(v.e-s));\r\n\t\tint d3 = sgn((v.e-v.s)^(s-v.s));\r\n\t\tint d4 = sgn((v.e-v.s)^(e-v.s));\r\n\t\tif( (d1^d2)==-2 && (d3^d4)==-2 )return 2;\r\n\t\treturn (d1==0 && sgn((v.s-s)*(v.s-e))<=0) ||\r\n\t\t       (d2==0 && sgn((v.e-s)*(v.e-e))<=0) ||\r\n\t\t       (d3==0 && sgn((s-v.s)*(s-v.e))<=0) ||\r\n\t\t       (d4==0 && sgn((e-v.s)*(e-v.e))<=0);\r\n\t}\r\n\t//\u76f4\u7ebf\u548c\u7ebf\u6bb5\u76f8\u4ea4\u5224\u65ad\r\n\t//-*this line -v seg\r\n\t//2 \u89c4\u8303\u76f8\u4ea4\r\n\t//1 \u975e\u89c4\u8303\u76f8\u4ea4\r\n\t//0 \u4e0d\u76f8\u4ea4\r\n\tint linecrossseg(Line v) {\r\n\t\tint d1 = sgn((e-s)^(v.s-s));\r\n\t\tint d2 = sgn((e-s)^(v.e-s));\r\n\t\tif((d1^d2)==-2) return 2;\r\n\t\treturn (d1==0||d2==0);\r\n\t}\r\n\t//\u4e24\u76f4\u7ebf\u5173\u7cfb\r\n\t//0 \u5e73\u884c\r\n\t//1 \u91cd\u5408\r\n\t//2 \u76f8\u4ea4\r\n\tint linecrossline(Line v) {\r\n\t\tif((*this).parallel(v))\r\n\t\t\treturn v.relation(s)==3;\r\n\t\treturn 2;\r\n\t}\r\n\t//\u6c42\u4e24\u76f4\u7ebf\u7684\u4ea4\u70b9\r\n\t//\u8981\u4fdd\u8bc1\u4e24\u76f4\u7ebf\u4e0d\u5e73\u884c\u6216\u91cd\u5408\r\n\tPoint crosspoint(Line v) {\r\n\t\tdouble a1 = (v.e-v.s)^(s-v.s);\r\n\t\tdouble a2 = (v.e-v.s)^(e-v.s);\r\n\t\treturn Point((s.x*a2-e.x*a1)/(a2-a1),(s.y*a2-e.y*a1)/(a2-a1));\r\n\t}\r\n\t//\u70b9\u5230\u76f4\u7ebf\u7684\u8ddd\u79bb\r\n\tdouble dispointtoline(Point p) {\r\n\t\treturn fabs((p-s)^(e-s))/length();\r\n\t}\r\n\t//\u70b9\u5230\u5c04\u7ebf\u7684\u8ddd\u79bb s\u662f\u5c04\u7ebf\u8d77\u70b9 e\u63a7\u5236\u5c04\u7ebf\u65b9\u5411\r\n\tdouble dispointtoray(Point p) {\r\n\t\tif(sgn((p-s)*(e-s))<0) return p.distance(s);\r\n\t\treturn dispointtoline(p);\r\n\t}\r\n\t//\u70b9\u5230\u7ebf\u6bb5\u7684\u8ddd\u79bb\r\n\tdouble dispointtoseg(Point p) {\r\n\t\tif(sgn((p-s)*(e-s))<0 || sgn((p-e)*(s-e))<0)\r\n\t\t\treturn min(p.distance(s),p.distance(e));\r\n\t\treturn dispointtoline(p);\r\n\t}\r\n\t//\u8fd4\u56de\u7ebf\u6bb5\u5230\u7ebf\u6bb5\u7684\u8ddd\u79bb\r\n\t//\u524d\u63d0\u662f\u4e24\u7ebf\u6bb5\u4e0d\u76f8\u4ea4\uff0c\u76f8\u4ea4\u8ddd\u79bb\u5c31\u662f 0 \u4e86\r\n\tdouble dissegtoseg(Line v) {\r\n\t\treturn min(min(dispointtoseg(v.s),dispointtoseg(v.e)),min(v.dispointtoseg(s),v.dispointtoseg(e)));\r\n\t}\r\n\t//\u8fd4\u56de\u70b9 p \u5728\u76f4\u7ebf\u4e0a\u7684\u6295\u5f71\r\n\tPoint lineprog(Point p) {\r\n\t\treturn s+(((e-s)*((e-s)*(p-s)))/((e-s).len2()));\r\n\t}\r\n\t//\u8fd4\u56de\u70b9 p \u5173\u4e8e\u76f4\u7ebf\u7684\u5bf9\u79f0\u70b9\r\n\tPoint symmetrypoint(Point p) {\r\n\t\tPoint q = lineprog(p);\r\n\t\treturn Point(2*q.x-p.x,2*q.y-p.y);\r\n\t}\r\n} ll1,ll2,ll3,ll4;\r\n\r\nstruct circle {\r\n\tPoint p;//\u5706\u5fc3\r\n\tdouble r;//\u534a\u5f84\r\n\tcircle() {}\r\n\tcircle(Point _p,double _r) {\r\n\t\tp = _p;\r\n\t\tr = _r;\r\n\t}\r\n\tcircle(double x,double y,double _r) {\r\n\t\tp = Point(x,y);\r\n\t\tr = _r;\r\n\t}\r\n\t//\u4e09\u89d2\u5f62\u7684\u5916\u63a5\u5706\r\n\t//\u9700\u8981 Point \u7684 + / rotate() \u4ee5\u53ca Line \u7684 crosspoint()\r\n\t//\u5229\u7528\u4e24\u6761\u8fb9\u7684\u4e2d\u5782\u7ebf\u5f97\u5230\u5706\u5fc3\r\n\tcircle(Point a,Point b,Point c) {\r\n\t\tLine u = Line((a+b)/2,((a+b)/2)+((b-a).rotleft()));\r\n\t\tLine v = Line((b+c)/2,((b+c)/2)+((c-b).rotleft()));\r\n\t\tp = u.crosspoint(v);\r\n\t\tr = p.distance(a);\r\n\t}\r\n\t//\u4e09\u89d2\u5f62\u7684\u5185\u5207\u5706\r\n\t//\u53c2\u6570 bool t \u6ca1\u6709\u4f5c\u7528\uff0c\u53ea\u662f\u4e3a\u4e86\u548c\u4e0a\u9762\u5916\u63a5\u5706\u51fd\u6570\u533a\u522b\r\n\tcircle(Point a,Point b,Point c,bool t) {\r\n\t\tLine u,v;\r\n\t\tdouble m = atan2(b.y-a.y,b.x-a.x), n = atan2(c.y-a.y,c.x-a.x);\r\n\t\tu.s = a;\r\n\t\tu.e = u.s + Point(cos((n+m)/2),sin((n+m)/2));\r\n\t\tv.s = b;\r\n\t\tm = atan2(a.y-b.y,a.x-b.x) , n = atan2(c.y-b.y,c.x-b.x);\r\n\t\tv.e = v.s + Point(cos((n+m)/2),sin((n+m)/2));\r\n\t\tp = u.crosspoint(v);\r\n\t\tr = Line(a,b).dispointtoseg(p);\r\n\t}\r\n\t//\u8f93\u5165\r\n\tvoid input() {\r\n\t\tp.input();\r\n\t\tscanf(\"%lf\",&r);\r\n\t}\r\n\t//\u8f93\u51fa\r\n\tvoid output() {\r\n\t\tprintf(\"%.2lf %.2lf %.2lf\\n\",p.x,p.y,r);\r\n\t}\r\n\tbool operator == (circle v) {\r\n\t\treturn (p==v.p) && sgn(r-v.r)==0;\r\n\t}\r\n\tbool operator < (circle v)const {\r\n\t\treturn ((p<v.p)||((p==v.p)&&sgn(r-v.r)<0));\r\n\t}\r\n\t//\u9762\u79ef\r\n\tdouble area() {\r\n\t\treturn pi*r*r;\r\n\t}\r\n\t//\u5468\u957f\r\n\tdouble circumference() {\r\n\t\treturn 2*pi*r;\r\n\t}\r\n\t//\u70b9\u548c\u5706\u7684\u5173\u7cfb\r\n\t//0 \u5706\u5916\r\n\t//1 \u5706\u4e0a\r\n\t//2 \u5706\u5185\r\n\tint relation(Point b) {\r\n\t\tdouble dst = b.distance(p);\r\n\t\tif(sgn(dst-r) < 0)return 2;\r\n\t\telse if(sgn(dst-r)==0)return 1;\r\n\t\treturn 0;\r\n\t}\r\n\t//\u7ebf\u6bb5\u548c\u5706\u7684\u5173\u7cfb\r\n\t//\u6bd4\u8f83\u7684\u662f\u5706\u5fc3\u5230\u7ebf\u6bb5\u7684\u8ddd\u79bb\u548c\u534a\u5f84\u7684\u5173\u7cfb\r\n\t//0 \u5706\u5916\r\n\t//1 \u5706\u4e0a\r\n\t//2 \u5706\u5185\r\n\tint relationseg(Line v) {\r\n\t\tdouble dst = v.dispointtoseg(p);\r\n\t\tif(sgn(dst-r) < 0)return 2;\r\n\t\telse if(sgn(dst-r) == 0)return 1;\r\n\t\treturn 0;\r\n\t}\r\n\t//\u76f4\u7ebf\u548c\u5706\u7684\u5173\u7cfb\r\n\t//\u6bd4\u8f83\u7684\u662f\u5706\u5fc3\u5230\u76f4\u7ebf\u7684\u8ddd\u79bb\u548c\u534a\u5f84\u7684\u5173\u7cfb\r\n\tint relationline(Line v) {\r\n\t\tdouble dst = v.dispointtoline(p);\r\n\t\tif(sgn(dst-r) < 0)return 2;\r\n\t\telse if(sgn(dst-r) == 0)return 1;\r\n\t\treturn 0;\r\n\t}\r\n\t//\u4e24\u5706\u7684\u5173\u7cfb\r\n\t//5 \u76f8\u79bb\r\n\t//4 \u5916\u5207\r\n\t//3 \u76f8\u4ea4\r\n\t//2 \u5185\u5207\r\n\t//1 \u5185\u542b\r\n\t//\u9700\u8981 Point \u7684 distance\r\n\tint relationcircle(circle v) {\r\n\t\tdouble d = p.distance(v.p);\r\n\t\tif(sgn(d-r-v.r) > 0)return 5;\r\n\t\tif(sgn(d-r-v.r) == 0)return 4;\r\n\t\tdouble l = fabs(r-v.r);\r\n\t\tif(sgn(d-r-v.r)<0 && sgn(d-l)>0)return 3;\r\n\t\tif(sgn(d-l)==0)return 2;\r\n\t\tif(sgn(d-l)<0)return 1;\r\n\t}\r\n\t//\u6c42\u4e24\u4e2a\u5706\u7684\u4ea4\u70b9\uff0c\u8fd4\u56de 0 \u8868\u793a\u6ca1\u6709\u4ea4\u70b9\uff0c\u8fd4\u56de 1 \u662f\u4e00\u4e2a\u4ea4\u70b9\uff0c2 \u662f\u4e24\u4e2a\u4ea4\u70b9\r\n\t//\u9700\u8981 relationcircle\r\n\tint pointcrosscircle(circle v,Point &p1,Point &p2) {\r\n\t\tint rel = relationcircle(v);\r\n\t\tif(rel == 1 || rel == 5)return 0;\r\n\t\tdouble d = p.distance(v.p);\r\n\t\tdouble l = (d*d+r*r-v.r*v.r)/(2*d);\r\n\t\tdouble h = sqrt(r*r-l*l);\r\n\t\tPoint tmp = p + (v.p-p).trunc(l);\r\n\t\tp1 = tmp + ((v.p-p).rotleft().trunc(h));\r\n\t\tp2 = tmp + ((v.p-p).rotright().trunc(h));\r\n\t\tif(rel == 2 || rel == 4)\r\n\t\t\treturn 1;\r\n\t\treturn 2;\r\n\t}\r\n\t//\u6c42\u76f4\u7ebf\u548c\u5706\u7684\u4ea4\u70b9\uff0c\u8fd4\u56de\u4ea4\u70b9\u4e2a\u6570\r\n\tint pointcrossline(Line v,Point &p1,Point &p2) {\r\n\t\tif(!(*this).relationline(v))return 0;\r\n\t\tPoint a = v.lineprog(p);\r\n\t\tdouble d = v.dispointtoline(p);\r\n\t\td = sqrt(r*r-d*d);\r\n\t\tif(sgn(d) == 0) {\r\n\t\t\tp1 = a;\r\n\t\t\tp2 = a;\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tp1 = a + (v.e-v.s).trunc(d);\r\n\t\tp2 = a - (v.e-v.s).trunc(d);\r\n\t\treturn 2;\r\n\t}\r\n\t//\u5f97\u5230\u8fc7 a,b \u4e24\u70b9\uff0c\u534a\u5f84\u4e3a r1 \u7684\u4e24\u4e2a\u5706\r\n\tint gercircle(Point a,Point b,double r1,circle &c1,circle &c2) {\r\n\t\tcircle x(a,r1),y(b,r1);\r\n\t\tint t = x.pointcrosscircle(y,c1.p,c2.p);\r\n\t\tif(!t)return 0;\r\n\t\tc1.r = c2.r = r;\r\n\t\treturn t;\r\n\t}\r\n\t//\u5f97\u5230\u4e0e\u76f4\u7ebf u \u76f8\u5207\uff0c\u8fc7\u70b9 q, \u534a\u5f84\u4e3a r1 \u7684\u5706\r\n\tint getcircle(Line u,Point q,double r1,circle &c1,circle &c2) {\r\n\t\tdouble dis = u.dispointtoline(q);\r\n\t\tif(sgn(dis-r1*2)>0)return 0;\r\n\t\tif(sgn(dis) == 0) {\r\n\t\t\tc1.p = q + ((u.e-u.s).rotleft().trunc(r1));\r\n\t\t\tc2.p = q + ((u.e-u.s).rotright().trunc(r1));\r\n\t\t\tc1.r = c2.r = r1;\r\n\t\t\treturn 2;\r\n\t\t}\r\n\t\tLine u1 = Line((u.s + (u.e-u.s).rotleft().trunc(r1)),(u.e+(u.e-u.s).rotleft().trunc(r1)));\r\n\t\tLine u2 = Line((u.s + (u.e-u.s).rotright().trunc(r1)),(u.e+(u.e-u.s).rotright().trunc(r1)));\r\n\t\tcircle cc = circle(q,r1);\r\n\t\tPoint p1,p2;\r\n\t\tif(!cc.pointcrossline(u1,p1,p2))cc.pointcrossline(u2,p1,p2);\r\n\t\tc1 = circle(p1,r1);\r\n\t\tif(p1 == p2) {\r\n\t\t\tc2 = c1;\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tc2 = circle(p2,r1);\r\n\t\treturn 2;\r\n\t}\r\n\t//\u540c\u65f6\u4e0e\u76f4\u7ebf u,v \u76f8\u5207\uff0c\u534a\u5f84\u4e3a r1 \u7684\u5706\r\n\tint getcircle(Line u,Line v,double r1,circle &c1,circle &c2,circle &c3,circle &c4) {\r\n\t\tif(u.parallel(v))return 0;//\u4e24\u76f4\u7ebf\u5e73\u884c\r\n\t\tLine u1 = Line(u.s + (u.e-u.s).rotleft().trunc(r1),u.e + (u.e-u.s).rotleft().trunc(r1));\r\n\t\tLine u2 = Line(u.s + (u.e-u.s).rotright().trunc(r1),u.e + (u.e-u.s).rotright().trunc(r1));\r\n\t\tLine v1 = Line(v.s + (v.e-v.s).rotleft().trunc(r1),v.e + (v.e-v.s).rotleft().trunc(r1));\r\n\t\tLine v2 = Line(v.s + (v.e-v.s).rotright().trunc(r1),v.e + (v.e-v.s).rotright().trunc(r1));\r\n\t\tc1.r = c2.r = c3.r = c4.r = r1;\r\n\t\tc1.p = u1.crosspoint(v1);\r\n\t\tc2.p = u1.crosspoint(v2);\r\n\t\tc3.p = u2.crosspoint(v1);\r\n\t\tc4.p = u2.crosspoint(v2);\r\n\t\treturn 4;\r\n\t}\r\n\t//\u540c\u65f6\u4e0e\u4e0d\u76f8\u4ea4\u5706 cx,cy \u76f8\u5207\uff0c\u534a\u5f84\u4e3a r1 \u7684\u5706\r\n\tint getcircle(circle cx,circle cy,double r1,circle &c1,circle &c2) {\r\n\t\tcircle x(cx.p,r1+cx.r),y(cy.p,r1+cy.r);\r\n\t\tint t = x.pointcrosscircle(y,c1.p,c2.p);\r\n\t\tif(!t)return 0;\r\n\t\tc1.r = c2.r = r1;\r\n\t\treturn t;\r\n\t}\r\n\t//\u8fc7\u4e00\u70b9\u4f5c\u5706\u7684\u5207\u7ebf (\u5148\u5224\u65ad\u70b9\u548c\u5706\u7684\u5173\u7cfb)\r\n\tint tangentline(Point q,Line &u,Line &v) {\r\n\t\tint x = relation(q);\r\n\t\tif(x == 2)return 0;\r\n\t\tif(x == 1) {\r\n\t\t\tu = Line(q,q + (q-p).rotleft());\r\n\t\t\tv = u;\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tdouble d = p.distance(q);\r\n\t\tdouble l = r*r/d;\r\n\t\tdouble h = sqrt(r*r-l*l);\r\n\t\tu = Line(q,p + ((q-p).trunc(l) + (q-p).rotleft().trunc(h)));\r\n\t\tv = Line(q,p + ((q-p).trunc(l) + (q-p).rotright().trunc(h)));\r\n\t\treturn 2;\r\n\t}\r\n\t//\u6c42\u4e24\u5706\u76f8\u4ea4\u7684\u9762\u79ef\r\n\tdouble areacircle(circle v) {\r\n\t\tint rel = relationcircle(v);\r\n\t\tif(rel >= 4)return 0.0;\r\n\t\tif(rel <= 2)return min(area(),v.area());\r\n\t\tdouble d = p.distance(v.p);\r\n\t\tdouble hf = (r+v.r+d)/2.0;\r\n\t\tdouble ss = 2*sqrt(hf*(hf-r)*(hf-v.r)*(hf-d));\r\n\t\tdouble a1 = acos((r*r+d*d-v.r*v.r)/(2.0*r*d));\r\n\t\ta1 = a1*r*r;\r\n\t\tdouble a2 = acos((v.r*v.r+d*d-r*r)/(2.0*v.r*d));\r\n\t\ta2 = a2*v.r*v.r;\r\n\t\treturn a1+a2-ss;\r\n\t}\r\n\t//\u6c42\u5706\u548c\u4e09\u89d2\u5f62 pab \u7684\u76f8\u4ea4\u9762\u79ef\r\n\tdouble areatriangle(Point a,Point b) {\r\n\t\tif(sgn((p-a)^(p-b)) == 0)return 0.0;\r\n\t\tPoint q[5];\r\n\t\tint len = 0;\r\n\t\tq[len++] = a;\r\n\t\tLine l(a,b);\r\n\t\tPoint p1,p2;\r\n\t\tif(pointcrossline(l,q[1],q[2])==2) {\r\n\t\t\tif(sgn((a-q[1])*(b-q[1]))<0)q[len++] = q[1];\r\n\t\t\tif(sgn((a-q[2])*(b-q[2]))<0)q[len++] = q[2];\r\n\t\t}\r\n\t\tq[len++] = b;\r\n\t\tif(len == 4 && sgn((q[0]-q[1])*(q[2]-q[1]))>0)swap(q[1],q[2]);\r\n\t\tdouble res = 0;\r\n\t\tfor(int i = 0; i < len-1; i++) {\r\n\t\t\tif(relation(q[i])==0||relation(q[i+1])==0) {\r\n\t\t\t\tdouble arg = p.rad(q[i],q[i+1]);\r\n\t\t\t\tres += r*r*arg/2.0;\r\n\t\t\t} else {\r\n\t\t\t\tres += fabs((q[i]-p)^(q[i+1]-p))/2.0;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\t//\u4e0b\u4e09\u4e2a\u662f\u6c42\u4e00\u5806\u70b9\u7684\u6700\u5c0f\u5706\u8986\u76d6\uff0c\u590d\u6742\u5ea6O(n)\r\n\tdouble dis(Point a,Point b) {\r\n\t\treturn sqrt((a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y));\r\n\t}\r\n\tPoint o;\r\n\tdouble ri;\r\n\tvoid tt(Point p1,Point p2,Point p3) {\r\n\t\tdouble a,b,c,d,e,f;\r\n\t\ta=p2.y-p1.y;\r\n\t\tb=p3.y-p1.y;\r\n\t\tc=p2.x-p1.x;\r\n\t\td=p3.x-p1.x;\r\n\t\tf=p3.x*p3.x+p3.y*p3.y-p1.x*p1.x-p1.y*p1.y;\r\n\t\te=p2.x*p2.x+p2.y*p2.y-p1.x*p1.x-p1.y*p1.y;\r\n\t\to.x=(a*f-b*e)/(2*a*d-2*b*c);\r\n\t\to.y=(d*e-c*f)/(2*a*d-2*b*c);\r\n\t\tri=dis(o,p1);\r\n\t}\r\n\tvoid getmincircover(Point p[],int n,circle &c) {\r\n\t\trandom_shuffle(p,p+n);\r\n\t\to=p[0];\r\n\t\tri=0;\r\n\t\tfor(int i=1; i<n; i++) {\r\n\t\t\tif(dis(p[i],o)>ri+eps) {\r\n\t\t\t\to=p[i];\r\n\t\t\t\tri=0;\r\n\t\t\t\tfor(int j=0; j<=i-1; j++) {\r\n\t\t\t\t\tif(dis(o,p[j])>ri+eps) {\r\n\t\t\t\t\t\to.x=(p[i].x+p[j].x)/2;\r\n\t\t\t\t\t\to.y=(p[i].y+p[j].y)/2;\r\n\t\t\t\t\t\tri=dis(o,p[j]);\r\n\t\t\t\t\t\tfor(int k=0; k<=j-1; k++) {\r\n\t\t\t\t\t\t\tif(dis(o,p[k])>ri+eps) {\r\n\t\t\t\t\t\t\t\ttt(p[i],p[j],p[k]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tc.p=o;\r\n\t\tc.r=ri;\r\n\t}\r\n} ;\r\nconst int maxn = 1010;\r\nstruct circles {\r\n\tcircle c[maxn];\r\n\tdouble ans[maxn];//ans[i] \u8868\u793a\u88ab\u8986\u76d6\u4e86 i \u6b21\u7684\u9762\u79ef\r\n\tdouble pre[maxn];\r\n\tint n;\r\n\tcircles() {}\r\n\tvoid add(circle cc) {\r\n\t\tc[n++] = cc;\r\n\t}\r\n\t//x \u5305\u542b\u5728 y \u4e2d\r\n\tbool inner(circle x,circle y) {\r\n\t\tif(x.relationcircle(y) != 1)return 0;\r\n\t\treturn sgn(x.r-y.r)<=0?1:0;\r\n\t}\r\n\t//\u5706\u7684\u9762\u79ef\u5e76\u53bb\u6389\u5185\u542b\u7684\u5706\r\n\tvoid init_or() {\r\n\t\tbool mark[maxn] = {0};\r\n\t\tint i,j,k=0;\r\n\t\tfor(i = 0; i < n; i++) {\r\n\t\t\tfor(j = 0; j < n; j++)\r\n\t\t\t\tif(i != j && !mark[j]) {\r\n\t\t\t\t\tif( (c[i]==c[j])||inner(c[i],c[j]) )break;\r\n\t\t\t\t}\r\n\t\t\tif(j < n)mark[i] = 1;\r\n\t\t}\r\n\t\tfor(i = 0; i < n; i++)\r\n\t\t\tif(!mark[i])\r\n\t\t\t\tc[k++] = c[i];\r\n\t\tn = k;\r\n\t}\r\n\t//\u5706\u7684\u9762\u79ef\u4ea4\u53bb\u6389\u5185\u542b\u7684\u5706\r\n\tvoid init_add() {\r\n\t\tint i,j,k;\r\n\t\tbool mark[maxn] = {0};\r\n\t\tfor(i = 0; i < n; i++) {\r\n\t\t\tfor(j = 0; j < n; j++)\r\n\t\t\t\tif(i != j && !mark[j]) {\r\n\t\t\t\t\tif( (c[i]==c[j])||inner(c[j],c[i]) )break;\r\n\t\t\t\t}\r\n\t\t\tif(j < n)mark[i] = 1;\r\n\t\t}\r\n\t\tfor(i = 0; i < n; i++)\r\n\t\t\tif(!mark[i])\r\n\t\t\t\tc[k++] = c[i];\r\n\t\tn = k;\r\n\t}\r\n\t//\u534a\u5f84\u4e3a r \u7684\u5706\uff0c\u5f27\u5ea6\u4e3a th \u5bf9\u5e94\u7684\u5f13\u5f62\u7684\u9762\u79ef\r\n\tdouble areaarc(double th,double r) {\r\n\t\treturn 0.5*r*r*(th-sin(th));\r\n\t}\r\n\t//\u6d4b\u8bd5 SPOJVCIRCLES SPOJCIRUT\r\n\t//SPOJVCIRCLES \u6c42 n \u4e2a\u5706\u5e76\u7684\u9762\u79ef\uff0c\u9700\u8981\u52a0\u4e0a init_or() \u53bb\u6389\u91cd\u590d\u5706\uff08\u5426\u5219WA\uff09\r\n\t//SPOJCIRUT \u662f\u6c42\u88ab\u8986\u76d6 k \u6b21\u7684\u9762\u79ef\uff0c\u4e0d\u80fd\u52a0 init_or()\r\n\t//\u5bf9\u4e8e\u6c42\u8986\u76d6\u591a\u5c11\u6b21\u9762\u79ef\u7684\u95ee\u9898\uff0c\u4e0d\u80fd\u89e3\u51b3\u76f8\u540c\u5706\uff0c\u800c\u4e14\u4e0d\u80fd init_or()\r\n\t//\u6c42\u591a\u5706\u9762\u79ef\u5e76\uff0c\u9700\u8981 init_or, \u5176\u4e2d\u4e00\u4e2a\u76ee\u7684\u5c31\u662f\u53bb\u6389\u76f8\u540c\u5706\r\n\tvoid getarea() {\r\n\t\tmemset(ans,0,sizeof(ans));\r\n\t\tvector<pair<double,int> >v;\r\n\t\tfor(int i = 0; i < n; i++) {\r\n\t\t\tv.clear();\r\n\t\t\tv.push_back(make_pair(-pi,1));\r\n\t\t\tv.push_back(make_pair(pi,-1));\r\n\t\t\tfor(int j = 0; j < n; j++)\r\n\t\t\t\tif(i != j) {\r\n\t\t\t\t\tPoint q = (c[j].p-c[i].p);\r\n\t\t\t\t\tdouble ab = q.len(),ac = c[i].r, bc = c[j].r;\r\n\t\t\t\t\tif(sgn(ab+ac-bc)<=0) {\r\n\t\t\t\t\t\tv.push_back(make_pair(-pi,1));\r\n\t\t\t\t\t\tv.push_back(make_pair(pi,-1));\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(sgn(ab+bc-ac)<=0)continue;\r\n\t\t\t\t\tif(sgn(ab-ac-bc)>0)continue;\r\n\t\t\t\t\tdouble th = atan2(q.y,q.x), fai = acos((ac*ac+ab*ab-bc*bc)/(2.0*ac*ab));\r\n\t\t\t\t\tdouble a0 = th-fai;\r\n\t\t\t\t\tif(sgn(a0+pi)<0)a0+=2*pi;\r\n\t\t\t\t\tdouble a1 = th+fai;\r\n\t\t\t\t\tif(sgn(a1-pi)>0)a1 -=2*pi;\r\n\t\t\t\t\tif(sgn(a0-a1)>0) {\r\n\t\t\t\t\t\tv.push_back(make_pair(a0,1));\r\n\t\t\t\t\t\tv.push_back(make_pair(pi,-1));\r\n\t\t\t\t\t\tv.push_back(make_pair(-pi,1));\r\n\t\t\t\t\t\tv.push_back(make_pair(a1,-1));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tv.push_back(make_pair(a0,1));\r\n\t\t\t\t\t\tv.push_back(make_pair(a1,-1));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\tsort(v.begin(),v.end());\r\n\t\t\tint cur = 0;\r\n\t\t\tfor(int j = 0; j < v.size(); j++) {\r\n\t\t\t\tif(cur && sgn(v[j].first-pre[cur])) {\r\n\t\t\t\t\tans[cur] += areaarc(v[j].first-pre[cur],c[i].r);\r\n\t\t\t\t\tans[cur] += 0.5*(Point(c[i].p.x+c[i].r*cos(pre[cur]),c[i].p.y+c[i].r*sin(pre[cur]))^Point(c[i].p.x+c[i].r*cos(v[j].first),c[i].p.y+c[i].r*sin(v[j].first)));\r\n\t\t\t\t}\r\n\t\t\t\tcur += v[j].second;\r\n\t\t\t\tpre[cur] = v[j].first;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n} C;\r\nbool cmp2(Point A,Point B) {\r\n\treturn (A^B)>0||((A^B)==0&&A.len2()<B.len2());\r\n}\r\nstruct polygon {\r\n\tint n;\r\n\tPoint p[maxp];\r\n\tLine l[maxp];\r\n\tvoid input(int _n) {\r\n\t\tn = _n;\r\n\t\tfor(int i = 0; i < n; i++)\r\n\t\t\tp[i].input();\r\n\t}\r\n\tvoid add(Point q) {\r\n\t\tp[n++] = q;\r\n\t}\r\n\tvoid getline() {\r\n\t\tfor(int i = 0; i < n; i++) {\r\n\t\t\tl[i] = Line(p[i],p[(i+1)%n]);\r\n\t\t}\r\n\t}\r\n\tstruct cmp {\r\n\t\tPoint p;\r\n\t\tcmp(const Point &p0) {\r\n\t\t\tp = p0;\r\n\t\t}\r\n\t\tbool operator()(const Point &aa,const Point &bb) {\r\n\t\t\tPoint a = aa, b = bb;\r\n\t\t\tint d = sgn((a-p)^(b-p));\r\n\t\t\tif(d == 0) {\r\n\t\t\t\treturn sgn(a.distance(p)-b.distance(p)) < 0;\r\n\t\t\t}\r\n\t\t\treturn d > 0;\r\n\t\t}\r\n\t};\r\n\t//\u8fdb\u884c\u6781\u89d2\u6392\u5e8f\r\n\t//\u9996\u5148\u9700\u8981\u627e\u5230\u6700\u5de6\u4e0b\u89d2\u7684\u70b9\r\n\t//\u9700\u8981\u91cd\u8f7d\u53f7\u597d Point \u7684 < \u64cd\u4f5c\u7b26 (min \u51fd\u6570\u8981\u7528)\r\n\tvoid norm() {\r\n\t\tPoint mi = p[0];\r\n\t\tfor(int i = 1; i < n; i++)mi = min(mi,p[i]);\r\n\t\tsort(p,p+n,cmp(mi));\r\n\t}\r\n\t//\u5f97\u5230\u51f8\u5305\r\n\t//\u5f97\u5230\u7684\u51f8\u5305\u91cc\u9762\u7684\u70b9\u7f16\u53f7\u662f 0\uff5en-1 \u7684\r\n\t//\u4e24\u79cd\u51f8\u5305\u7684\u65b9\u6cd5\r\n\t//\u6ce8\u610f\u5982\u679c\u6709\u5f71\u54cd\uff0c\u8981\u7279\u5224\u4e0b\u6240\u6709\u70b9\u5171\u70b9\uff0c\u6216\u8005\u5171\u7ebf\u7684\u7279\u6b8a\u60c5\u51b5\r\n\t//\u6d4b\u8bd5 LightOJ1203 LightOJ1239\r\n\tvoid getconvex(polygon &convex) {\r\n\t\tsort(p,p+n);\r\n\t\tconvex.n = n;\r\n\t\tfor(int i = 0; i < min(n,2); i++) {\r\n\t\t\tconvex.p[i] = p[i];\r\n\t\t}\r\n\t\tif(convex.n == 2 && (convex.p[0] == convex.p[1]))convex.n--;//\u7279 \u5224\r\n\t\tif(n <= 2)return;\r\n\t\tint &top = convex.n;\r\n\t\ttop = 1;\r\n\t\tfor(int i = 2; i < n; i++) {\r\n\t\t\twhile(top && sgn((convex.p[top]-p[i])^(convex.p[top-1]-p[i]))<= 0)top--;\r\n\t\t\tconvex.p[++top] = p[i];\r\n\t\t}\r\n\t\tint temp = top;\r\n\t\tconvex.p[++top] = p[n-2];\r\n\t\tfor(int i = n-3; i >= 0; i--) {\r\n\t\t\twhile(top != temp && sgn((convex.p[top]-p[i])^(convex.p[top-1]-p[i])) <= 0)top--;\r\n\t\t\tconvex.p[++top] = p[i];\r\n\t\t}\r\n\t\tif(convex.n == 2 && (convex.p[0] == convex.p[1]))convex.n--;//\u7279 \u5224\r\n\t\tconvex.norm();//\u539f\u6765\u5f97\u5230\u7684\u662f\u987a\u65f6\u9488\u7684\u70b9\uff0c\u6392\u5e8f\u540e\u9006\u65f6\u9488\r\n\t}\r\n\t//\u5f97\u5230\u51f8\u5305\u7684\u53e6\u5916\u4e00\u79cd\u65b9\u6cd5\r\n\t//\u6d4b\u8bd5 LightOJ1203 LightOJ1239\r\n\tvoid Graham(polygon &convex) {\r\n\t\tnorm();\r\n\t\tint &top = convex.n;\r\n\t\ttop = 0;\r\n\t\tif(n == 1) {\r\n\t\t\ttop = 1;\r\n\t\t\tconvex.p[0] = p[0];\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(n == 2) {\r\n\t\t\ttop = 2;\r\n\t\t\tconvex.p[0] = p[0];\r\n\t\t\tconvex.p[1] = p[1];\r\n\t\t\tif(convex.p[0] == convex.p[1])top--;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconvex.p[0] = p[0];\r\n\t\tconvex.p[1] = p[1];\r\n\t\ttop = 2;\r\n\t\tfor(int i = 2; i < n; i++) {\r\n\t\t\twhile( top > 1 && sgn((convex.p[top-1]-convex.p[top-2])^(p[i]-convex.p[top-2])) <= 0 )top--;\r\n\t\t\tconvex.p[top++] = p[i];\r\n\t\t}\r\n\t\tif(convex.n == 2 && (convex.p[0] == convex.p[1]))convex.n--;//\u7279 \u5224\r\n\t}\r\n\t//\u5f97\u5230\u51f8\u5305\u7684\u76f4\u5f84(\u524d\u63d0\u5df2\u7ecf\u662f\u51f8\u5305) \u4e14\u7531Graham\u51fd\u6570\u5f97\u5230\u7684\u51f8\u5305\uff01\uff01\uff01\r\n\t//\u81ea\u6d4b\uff1ahttps://www.luogu.com.cn/problem/P1452 \u5f88\u5feb\u55f7\r\n\tdouble dis(Point a,Point b,Point c) {\r\n\t\treturn fabs((a-c)^(b-c)/(a-b).len());\r\n\t}\r\n\tdouble getD(polygon &convex) {\r\n\t\tdouble ans=0.0;\r\n\t\tint pos=1;\r\n\t\tconvex.p[convex.n+1]=convex.p[1];\r\n\t\tconvex.p[convex.n]=convex.p[0];\r\n\t\tif(convex.n==0||convex.n==1) return 0;\r\n\t\tif(convex.n==2) return (convex.p[1]-convex.p[0]).len();\r\n\t\tfor(int i=1; i<=convex.n; i++) {\r\n\t\t\twhile(dis(convex.p[i],convex.p[i+1],convex.p[pos])<=dis(convex.p[i],convex.p[i+1],convex.p[pos+1])) pos=pos%convex.n+1;\r\n\t\t\tans=max(ans,max((convex.p[i]-convex.p[pos]).len(),(convex.p[i+1]-convex.p[pos]).len()));\r\n\t\t}\r\n\t\tconvex.p[convex.n+1]=Point(0,0);\r\n\t\tconvex.p[convex.n]=Point(0,0);\r\n\t\treturn ans;\r\n\t}\r\n\t//\u5224\u65ad\u662f\u4e0d\u662f\u51f8\u7684\r\n\tbool isconvex() {\r\n\t\tbool s[2];\r\n\t\tmemset(s,false,sizeof(s));\r\n\t\tfor(int i = 0; i < n; i++) {\r\n\t\t\tint j = (i+1)%n;\r\n\t\t\tint k = (j+1)%n;\r\n\t\t\ts[sgn((p[j]-p[i])^(p[k]-p[i]))+1] = true;\r\n\t\t\tif(s[0] && s[2])return false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\t//\u5224\u65ad\u70b9\u548c\u4efb\u610f\u591a\u8fb9\u5f62\u7684\u5173\u7cfb\r\n\t// 3 \u70b9\u4e0a\r\n\t// 2 \u8fb9\u4e0a\r\n\t// 1 \u5185\u90e8\r\n\t// 0 \u5916\u90e8\r\n\tint relationpoint(Point q) {\r\n\t\tfor(int i = 0; i < n; i++) {\r\n\t\t\tif(p[i] == q)return 3;\r\n\t\t}\r\n\t\tgetline();\r\n\t\tfor(int i = 0; i < n; i++) {\r\n\t\t\tif(l[i].pointonseg(q))return 2;\r\n\t\t}\r\n\t\tint cnt = 0;\r\n\t\tfor(int i = 0; i < n; i++) {\r\n\t\t\tint j = (i+1)%n;\r\n\t\t\tint k = sgn((q-p[j])^(p[i]-p[j]));\r\n\t\t\tint u = sgn(p[i].y-q.y);\r\n\t\t\tint v = sgn(p[j].y-q.y);\r\n\t\t\tif(k > 0 && u < 0 && v >= 0)cnt++;\r\n\t\t\tif(k < 0 && v < 0 && u >= 0)cnt--;\r\n\t\t}\r\n\t\treturn cnt != 0;\r\n\t}\r\n\t//\u4f7f\u7528\u524d\u63d0\uff1a\u51f8\u5305\u9006\u65f6\u9488\u7b2c\u96f6\u4e2a\u70b9\u662f\u539f\u70b9 q\u4e5f\u662f\u76f8\u5bf9\u4e8e\u539f\u70b9\u7684\u4f4d\u7f6e\r\n\t//tmp\u503c\u7b49\u4e8e0\u8fb9\u4e0a \u5927\u4e8e\u96f6\u5728\u5916 \u5c0f\u4e8e\u96f6\u5728\u91cc \u8fd4\u56de0\u5916 1\u5185 2\u8fb9 3\u70b9 \u81ea\u6d4b\u5e94\u8be5\u6ca1\u95ee\u9898 \u8fd9\u4e2a\u590d\u6742\u5ea6\u662fO(logn)\u7684 \u6d4b\u8bd5\uff1ahttps://www.luogu.com.cn/problem/P4557\r\n\tint newrelationpoint(Point q) {\r\n\t\tif(sgn(q^p[0])>0||sgn(p[n-1]^q)>0) return 0;\r\n\t\tLine ltmp1,ltmp2,ltmp3;\r\n\t\tltmp3.s=p[0];\r\n\t\tltmp3.e=p[n-1];\r\n\t\tif(sgn(p[n-1]^q)==0&&!ltmp3.pointonseg(q)) return 0;\r\n\t\tif(ltmp3.pointonseg(q)) {\r\n\t\t\tif(!(q==p[0])&&!(q==p[n-1])) return 2;\r\n\t\t\treturn 3;\r\n\t\t}\r\n\t\tint pos=lower_bound(p,p+n,q,cmp2)-p;\r\n\t\tdouble tmp=((q-p[(pos+n-1)%n])^(p[pos%n]-p[(pos+n-1)%n]));\r\n\t\tltmp1.s=p[(pos+n-1)%n];\r\n\t\tltmp1.e=p[pos%n];\r\n\t\tltmp2.s=p[pos%n];\r\n\t\tltmp2.e=p[(pos+1)%n];\r\n\t\tif(ltmp1.pointonseg(q)&&ltmp2.pointonseg(q)) return 3;\r\n\t\tint flag=sgn(tmp);\r\n\t\tif(flag>0) return 0;\r\n\t\telse if(flag<0) return 1;\r\n\t\treturn 2;\r\n\t}\r\n\t//\u76f4\u7ebf u \u5207\u5272\u51f8\u591a\u8fb9\u5f62\u5de6\u4fa7\r\n\t//\u6ce8\u610f\u76f4\u7ebf\u65b9\u5411\r\n\t//\u6d4b\u8bd5\uff1aHDU3982\r\n\tvoid convexcut(Line u,polygon &po) {\r\n\t\tint &top = po.n;//\u6ce8\u610f\u5f15\u7528\r\n\t\ttop = 0;\r\n\t\tfor(int i = 0; i < n; i++) {\r\n\t\t\tint d1 = sgn((u.e-u.s)^(p[i]-u.s));\r\n\t\t\tint d2 = sgn((u.e-u.s)^(p[(i+1)%n]-u.s));\r\n\t\t\tif(d1 >= 0)po.p[top++] = p[i];\r\n\t\t\tif(d1*d2 < 0)po.p[top++] = u.crosspoint(Line(p[i],p[(i+1)%n]));\r\n\t\t}\r\n\t}\r\n\t//\u5f97\u5230\u5468\u957f\r\n\t//\u6d4b\u8bd5 LightOJ1239\r\n\tdouble getcircumference() {\r\n\t\tdouble sum = 0;\r\n\t\tfor(int i = 0; i < n; i++) {\r\n\t\t\tsum += p[i].distance(p[(i+1)%n]);\r\n\t\t}\r\n\t\treturn sum;\r\n\t}\r\n\t//\u5f97\u5230\u9762\u79ef\r\n\tdouble getarea() {\r\n\t\tdouble sum = 0;\r\n\t\tfor(int i = 0; i < n; i++) {\r\n\t\t\tsum += (p[i]^p[(i+1)%n]);\r\n\t\t}\r\n\t\treturn fabs(sum)/2;\r\n\t}\r\n\t//\u5f97\u5230\u65b9\u5411\r\n\t// 1 \u8868\u793a\u9006\u65f6\u9488\uff0c0 \u8868\u793a\u987a\u65f6\u9488\r\n\tbool getdir() {\r\n\t\tdouble sum = 0;\r\n\t\tfor(int i = 0; i < n; i++)\r\n\t\t\tsum += (p[i]^p[(i+1)%n]);\r\n\t\tif(sgn(sum) > 0)return 1;\r\n\t\treturn 0;\r\n\t}\r\n\t//\u5f97\u5230\u91cd\u5fc3\r\n\tPoint getbarycentre() {\r\n\t\tPoint ret(0,0);\r\n\t\tdouble area = 0;\r\n\t\tfor(int i = 1; i < n-1; i++) {\r\n\t\t\tdouble tmp = (p[i]-p[0])^(p[i+1]-p[0]);\r\n\t\t\tif(sgn(tmp) == 0)continue;\r\n\t\t\tarea += tmp;\r\n\t\t\tret.x += (p[0].x+p[i].x+p[i+1].x)/3*tmp;\r\n\t\t\tret.y += (p[0].y+p[i].y+p[i+1].y)/3*tmp;\r\n\t\t}\r\n\t\tif(sgn(area)) ret = ret/area;\r\n\t\treturn ret;\r\n\t}\r\n\t//AB X AC\r\n\tdouble cross(Point A,Point B,Point C) {\r\n\t\treturn (B-A)^(C-A);\r\n\t}\r\n\t//AB*AC\r\n\tdouble dot(Point A,Point B,Point C) {\r\n\t\treturn (B-A)*(C-A);\r\n\t}\r\n\t//\u6700\u5c0f\u77e9\u5f62\u9762\u79ef\u8986\u76d6\r\n\t//A\u5fc5\u987b\u662f\u51f8\u5305 (\u800c\u4e14\u662f\u9006\u65f6\u9488\u987a\u5e8f)\r\n\t//\u6d4b\u8bd5 UVA 10173\r\n\tdouble minRectangleCover() {\r\n\t\t//\u8981\u7279\u5224 A.n < 3 \u7684\u60c5\u51b5\r\n\t\tif(n < 3)return 0.0;\r\n\t\tp[n] = p[0];\r\n\t\tdouble ans = -1;\r\n\t\tint r = 1, pp = 1, q;\r\n\t\tfor(int i = 0; i < n; i++) {\r\n\t\t\t//\u5361\u51fa\u79bb\u8fb9 A.p[i] - A.p[i+1] \u6700\u8fdc\u7684\u70b9\r\n\t\t\twhile( sgn( cross(p[i],p[i+1],p[r+1])-cross(p[i],p[i+1],p[r]) ) >= 0 )\r\n\t\t\t\tr = (r+1)%n;\r\n\t\t\t//\u5361\u51fa A.p[i] - A.p[i+1] \u65b9\u5411\u4e0a\u6b63\u5411 n \u6700\u8fdc\u7684\u70b9\r\n\t\t\twhile(sgn( dot(p[i],p[i+1],p[pp+1])-dot(p[i],p[i+1],p[pp]) ) >= 0 )\r\n\t\t\t\tpp = (pp+1)%n;\r\n\t\t\tif(i == 0)q = pp;\r\n\t\t\t//\u5361\u51fa A.p[i] - A.p[i+1] \u65b9\u5411\u4e0a\u8d1f\u5411\u6700\u8fdc\u7684\u70b9\r\n\t\t\twhile(sgn(dot(p[i],p[i+1],p[q+1])-dot(p[i],p[i+1],p[q])) <= 0)\r\n\t\t\t\tq = (q+1)%n;\r\n\t\t\tdouble d = (p[i]-p[i+1]).len2();\r\n\t\t\tdouble tmp = cross(p[i],p[i+1],p[r])*(dot(p[i],p[i+1],p[pp])-dot(p[i],p[i+1],p[q]))/d;\r\n\t\t\tif(ans < 0 || ans > tmp) {\r\n\t\t\t\tans = tmp;\r\n\t\t\t\t//r\u662f\u5bf9\u9762\u7684\u8fb9 i\u548ci+1\u662f\u4e00\u6761\u8fb9 pp\u662f\u5782\u76f4\u7684 q\u4e5f\u662f\u5782\u76f4\u7684 \u6240\u4ee5\u56db\u6761\u7ebf\u5c31\u6709\u4e86 \u7528\u76f8\u4ea4\u51fd\u6570\u6c42\u56db\u4e2a\u7684\u4ea4\u70b9\u5c31\u662f\u77e9\u5f62\u7684\u56db\u4e2a\u9876\u70b9\r\n\t\t\t\tll1.s=p[i];\r\n\t\t\t\tll1.e=p[i+1];\r\n\t\t\t\tdouble an1=ll1.angle();\r\n\t\t\t\tdouble an2=an1+pi/2;\r\n\t\t\t\tif(an2>=pi) an2-=pi;\r\n\t\t\t\tll2=Line(p[pp],an2);\r\n\t\t\t\tll3=Line(p[q],an2);\r\n\t\t\t\tll4=Line(p[r],an1);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ans;\r\n\t}\r\n\t//\u76f4\u7ebf\u5207\u51f8\u591a\u8fb9\u5f62\r\n\t//\u591a\u8fb9\u5f62\u662f\u9006\u65f6\u9488\u7684\uff0c\u5728 q1q2 \u7684\u5de6\u4fa7\r\n\tvector<Point> convexCut(const vector<Point>&ps,Point q1,Point q2) {\r\n\t\tvector<Point>qs;\r\n\t\tint n=ps.size();\r\n\t\tfor(int i=0; i<n; i++) {\r\n\t\t\tPoint p1=ps[i],p2 = ps[(i+1)%n];\r\n\t\t\tint d1 = sgn((q2-q1)^(p1-q1)), d2 = sgn((q2-q1)^(p2-q1));\r\n\t\t\t//printf(\"%d %lf %lf %lf %lf %lf %lf\\n\",i,(q2-q1).x,(q2-q1).y,(p1-q1).x,(p1-q1).y,(q2-q1)^(p1-q1),(q2-q1)^(p2-q1));\r\n\t\t\tif(d1>=0) qs.push_back(p1);//\u5982\u679cq1q2\u8fde\u7ebf\u5728p1q1\u7684\u53f3\u8fb9\uff08\u4e5f\u5fc5\u5728p2q1\u53f3\u8fb9\uff09 p1\u80af\u5b9a\u6ee1\u8db3\u8981\u6c42\r\n\t\t\tif(d1*d2<0) qs.push_back(Line(p1,p2).crosspoint(Line(q1,q2)));//\u5982\u679c\u5939\u5728\u4e24\u8fb9\u4e2d\u95f4 \u4ea4\u70b9\u80af\u5b9a\u6ee1\u8db3\u8981\u6c42\r\n\t\t}\r\n\t\treturn qs;\r\n\t}\r\n\t//\u6c42\u4e00\u4e2a\u51f8\u5305\u4e2d\u9762\u79ef\u6700\u5927\u7684\u4e09\u89d2\u5f62 n\u65b9 \u8981\u4fdd\u8bc1n\u5927\u4e8e\u7b49\u4e8e3\r\n\tvoid maxareaTriangles(Point &a1,Point &a2,Point &a3,double &maxarea) {\r\n\t\tmaxarea=0;\r\n\t\tfor(register int i=0; i<n; i++) {\r\n\t\t\tfor(register int j=i+1,k=(j+1)%n; j<n&&k!=i; j++) {\r\n\t\t\t\twhile(sgn(((p[j]-p[i])^(p[k]-p[i]))-((p[j]-p[i])^(p[k+1]-p[i])))<0) k=(k+1)%n;\r\n\t\t\t\tif(k!=i&&k!=j) {\r\n\t\t\t\t\tdouble areanow=(p[j]-p[i])^(p[k]-p[i]);\r\n\t\t\t\t\tif(areanow>maxarea) {\r\n\t\t\t\t\t\tmaxarea=areanow;\r\n\t\t\t\t\t\ta1=p[i],a2=p[j],a3=p[k];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n} PO1,po1,PO2,po2;\r\n\r\nPoint s1[maxp],s2[maxp];\r\n//\u5f97\u5230\u4e24\u4e2a\u51f8\u5305\u7684\u95f5\u53ef\u592b\u65af\u57fa\u548c \u524d\u63d0\u662f\u4e8c\u8005\u5df2\u7ecf\u90fd\u662f\u51f8\u5305\u4e86\r\nvoid getMinkowski(polygon thi,polygon convex,polygon &po) {\r\n\t/*\r\n\tprintf(\"    %d %d\\n\",this->n,convex.n);\r\n\tfor(int i=0;i<this->n;i++){\r\n\t\tthis->p[i].output();\r\n\t}\r\n\tputchar(10);\r\n\tfor(int i=0;i<convex.n;i++){\r\n\t\tconvex.p[i].output();\r\n\t}\r\n\t*/\r\n\tfor(int i=0; i<thi.n-1; i++) s1[i]=thi.p[i+1]-thi.p[i];\r\n\ts1[thi.n-1]=thi.p[0]-thi.p[thi.n-1];\r\n\t/*\r\n\tputchar(10);\r\n\tfor(int i=0;i<this->n;i++){\r\n\t\ts1[i].output();\r\n\t}\r\n\tputchar(10);\r\n\t*/\r\n\tfor(int i=0; i<convex.n-1; i++) s2[i]=convex.p[i+1]-convex.p[i];\r\n\ts2[convex.n-1]=convex.p[0]-convex.p[convex.n-1];\r\n\t/*\r\n\tfor(int i=0;i<convex.n;i++){\r\n\t\ts2[i].output();\r\n\t}\r\n\tputchar(10);\r\n\t*/\r\n\tint tot;\r\n\tpo.p[tot=0]=thi.p[0]+convex.p[0];\r\n\tint pos1=0,pos2=0;\r\n\twhile(pos1<thi.n&&pos2<convex.n) {\r\n\t\t++tot;\r\n\t\tpo.p[tot]=po.p[tot-1]+((s1[pos1]^s2[pos2])>=0?s1[pos1++]:s2[pos2++]);\r\n\t}\r\n\twhile(pos1<thi.n) {\r\n\t\t++tot;\r\n\t\tpo.p[tot]=po.p[tot-1]+s1[pos1++];\r\n\t}\r\n\twhile(pos2<convex.n) {\r\n\t\t++tot;\r\n\t\tpo.p[tot]=po.p[tot-1]+s2[pos2++];\r\n\t}\r\n\tpo.n=tot+1;\r\n\tpo.p[po.n]=po.p[0];\r\n}\r\nstruct halfplane:public Line {\r\n\tdouble angle;\r\n\thalfplane() {}\r\n\t//\u8868\u793a\u5411\u91cf s->e \u9006\u65f6\u9488 (\u5de6\u4fa7) \u7684\u534a\u5e73\u9762\r\n\thalfplane(Point _s,Point _e) {\r\n\t\ts=_s;\r\n\t\te=_e;\r\n\t}\r\n\thalfplane(Line v) {\r\n\t\ts=v.s;\r\n\t\te=v.e;\r\n\t}\r\n\tvoid calcangle() {\r\n\t\tangle = atan2(e.y-s.y,e.x-s.x);\r\n\t}\r\n\tbool operator <(const halfplane &b) const {\r\n\t\treturn angle<b.angle;\r\n\t}\r\n};\r\nstruct halfplanes {\r\n\tint n;\r\n\thalfplane hp[maxp];\r\n\tPoint p[maxp];\r\n\tint que[maxp];\r\n\tint st,ed;\r\n\tvoid push(halfplane tmp) {\r\n\t\thp[n++]=tmp;\r\n\t}\r\n\t//\u53bb\u91cd\r\n\tvoid unique() {\r\n\t\tint m = 1;\r\n\t\tfor(int i = 1; i < n; i++) {\r\n\t\t\tif(sgn(hp[i].angle-hp[i-1].angle) != 0) hp[m++]=hp[i];\r\n\t\t\telse if(sgn( (hp[m-1].e-hp[m-1].s)^(hp[i].s-hp[m-1].s)) > 0) {\r\n\t\t\t\thp[m-1]=hp[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\tn=m;\r\n\t}\r\n\tbool halfplaneinsert() {\r\n\t\tfor(int i = 0; i < n; i++)hp[i].calcangle();\r\n\t\tsort(hp,hp+n);\r\n\t\tunique();\r\n\t\tque[st=0] = 0;\r\n\t\tque[ed=1] = 1;\r\n\t\tp[1] = hp[0].crosspoint(hp[1]);\r\n\t\tfor(int i = 2; i < n; i++) {\r\n\t\t\twhile(st<ed && sgn((hp[i].e-hp[i].s)^(p[ed]-hp[i].s))<0) ed--;\r\n\t\t\twhile(st<ed && sgn((hp[i].e-hp[i].s)^(p[st+1]-hp[i].s))<0) st++;\r\n\t\t\tque[++ed] = i;\r\n\t\t\tif(hp[i].parallel(hp[que[ed-1]])) return false;\r\n\t\t\tp[ed]=hp[i].crosspoint(hp[que[ed-1]]);\r\n\t\t}\r\n\t\twhile(st<ed && sgn((hp[que[st]].e-hp[que[st]].s)^(p[ed]-hp[que[st]].s))<0) ed--;\r\n\t\twhile(st<ed && sgn((hp[que[ed]].e-hp[que[ed]].s)^(p[st+1]-hp[que[ed]].s))<0) st++;\r\n\t\tif(st+1>=ed) return false;\r\n\t\treturn true;\r\n\t}\r\n\tvoid getconvex(polygon &con) {\r\n\t\tp[st]=hp[que[st]].crosspoint(hp[que[ed]]);\r\n\t\tcon.n=ed-st+1;\r\n\t\tfor(int j=st,i=0; j <= ed; i++,j++) con.p[i]=p[j];\r\n\t}\r\n} HP;\r\n\r\n/*\r\nbool operator < (Point b)const{\r\n\t\tif(sgn(this->ang-b.ang)==0) return this->x<b.x;\r\n\t\treturn this->ang<b.ang;\r\n\t}\r\n*/\r\n/*\u8fd9\u4e2a\u662f\u52a8\u6001\u51f8\u5305\u4ee3\u66ff\u5e73\u8861\u6811\u7684 \u6ce8\u610f\u6bd4\u8f83\u51fd\u6570\u7528\u4e0a\u9762\u8fd9\u4e2a\u4ee3\u66ff\u539f\u6765\u90a3\u4e2a\r\nset<Point> sp;\r\nset<Point>::iterator pre,suc;\r\nset<Point>::iterator PRE(set<Point>::iterator x){\r\n\tif(x==sp.begin()) return --sp.end();\r\n\treturn --x;\r\n}\r\n\r\nset<Point>::iterator SUC(set<Point>::iterator x){\r\n\tif((++x)==sp.end()) return sp.begin();\r\n\treturn x;\r\n}\r\n*/\r\n/*1\u63d2\u5165 2\u67e5\u8be2\u5728\u4e0d\u5728\u51f8\u5305\u5185\r\n\tint t;\r\n\tscanf(\"%d\",&t);\r\n\tPoint pt=Point(0,0);\r\n\tint num;\r\n\tscanf(\"%d\",&num);\r\n\tpp[0].input();\r\n\tpt=pt+pp[0];\r\n\tscanf(\"%d\",&num);\r\n\tpp[1].input();\r\n\tpt=pt+pp[1];\r\n\tscanf(\"%d\",&num);\r\n\tpp[2].input();\r\n\tpt=pt+pp[2];\r\n\tpt=pt/3.0;\r\n\tpp[0]=pp[0]-pt;\r\n\tpp[1]=pp[1]-pt;\r\n\tpp[2]=pp[2]-pt;\r\n\tpp[0].ang=atan2(pp[0].y,pp[0].x);\r\n\tpp[1].ang=atan2(pp[1].y,pp[1].x);\r\n\tpp[2].ang=atan2(pp[2].y,pp[2].x);\r\n\tsp.insert(pp[0]);\r\n\tsp.insert(pp[1]);\r\n\tsp.insert(pp[2]);\r\n\tt-=3;\r\n\tint op;\r\n\tPoint ppt;\r\n\twhile(t--){\r\n\t\tscanf(\"%d\",&op);\r\n\t\tppt.input();\r\n\t\tppt=ppt-pt;\r\n\t\tppt.ang=atan2(ppt.y,ppt.x);\r\n\t\tif((suc=sp.lower_bound(ppt))==sp.end()) suc=sp.begin();\r\n\t\tpre=PRE(suc);\r\n\t\tif(op==1){\r\n\t\t\tdouble dt=(*pre-ppt)^(*suc-ppt);\r\n\t\t\tif(dt>=0) continue;\r\n\t\t\tsp.insert(ppt);\r\n\t\t\tset<Point> :: iterator it=sp.find(ppt);\r\n\t\t\tset<Point> :: iterator itq=PRE(it);\r\n\t\t\tset<Point> :: iterator itqq=PRE(itq);\r\n\t\t\twhile(((*itqq-*itq)^(*it-*itq))>=0) {\r\n\t\t\t\tsp.erase(itq);\r\n\t\t\t\titq=itqq;\r\n\t\t\t\titqq=PRE(itq);\r\n\t\t\t}\r\n\t\t\titq=SUC(it);\r\n\t\t\titqq=SUC(itq);\r\n\t\t\twhile(((*it-*itq)^(*itqq-*itq))>=0) {\r\n\t\t\t\tsp.erase(itq);\r\n\t\t\t\titq=itqq;\r\n\t\t\t\titqq=SUC(itq);\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tdouble dt=(*pre-ppt)^(*suc-ppt);\r\n\t\t\tif(sgn(dt)>=0) puts(\"YES\");\r\n\t\t\telse puts(\"NO\");\r\n\t\t}\r\n\t}\r\n\t*/\r\nlong long SS;\r\ndouble aaa;\r\nPoint a1,a2,a3,aa1,aa2,aa3;\r\nint main() {\r\n\tscanf(\"%d %lld\",&PO1.n,&SS);\r\n\tfor(int i=0; i<PO1.n; i++) {\r\n\t\tPO1.p[i].input();\r\n\t}\r\n\tPO1.Graham(po1);\r\n\tpo1.maxareaTriangles(a1,a2,a3,aaa);\r\n\taa3=a1+a2-a3;\r\n\taa1=a2+a3-a1;\r\n\taa2=a1+a3-a2;\r\n\tprintf(\"%.0f %.0f\\n\",aa1.x,aa1.y);\r\n\tprintf(\"%.0f %.0f\\n\",aa2.x,aa2.y);\r\n\tprintf(\"%.0f %.0f\\n\",aa3.x,aa3.y);\r\n\treturn 0;\r\n}//I am a bot for remotejudge"
}
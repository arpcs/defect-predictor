{
    "id": 236050355,
    "contestId": 1307,
    "creationTimeSeconds": 1701868749,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1307,
        "index": "G",
        "name": "Cow and Exercise",
        "type": "PROGRAMMING",
        "points": 3500.0,
        "rating": 3100,
        "tags": [
            "flows",
            "graphs",
            "shortest paths"
        ]
    },
    "author": {
        "contestId": 1307,
        "members": [
            {
                "handle": "pp_orange"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1581953700
    },
    "programmingLanguage": "GNU C++17 (64)",
    "verdict": "RUNTIME_ERROR",
    "testset": "TESTS",
    "passedTestCount": 1,
    "timeConsumedMillis": 93,
    "memoryConsumedBytes": 2560000,
    "source": "/* Code by pp_orange */\r\n#include<bits/stdc++.h>\r\n#define m_p(a,b) make_pair(a,b)\r\n#define pb push_back\r\n#define ll long long\r\n#define ull unsigned long long\r\n#define lld long double\r\n#define inf 0x7FFFFFFF\r\n#define inff 9223372036854775807\r\n#define rep(i,l,r) for(int i=l;i<r;++i)\r\n#define repp(i,l,r) for(int i=l;i<=r;++i)\r\n#define per(i,r,l) for(int i=r-1;i>=l;--i)\r\n#define pper(i,r,l) for(int i=r;i>=l;--i)\r\n#define pii pair<int,int>\r\n#define fi first\r\n#define se second\r\n#define p_q priority_queue\r\n#define all(x) x.begin(),x.end()\r\n#define rall(x) x.rbegin(),x.rend()\r\n#define ls(x) ((x)<<1)\r\n#define rs(x) ((x)<<1|1)\r\n#define lb(x) ((x)&-(x))\r\nconst int mod = 998244353;\r\n//#define int ll\r\nusing namespace std;\r\ninline int rd(){\r\n\tint x(0),f(1);char ch=getchar();\r\n\twhile(!isdigit(ch)){if(ch=='-')f=-f;ch=getchar();}\r\n\twhile (isdigit(ch)){x=(x<<3)+(x<<1)+(ch^48);ch=getchar();}\r\n\treturn x*f;\r\n}\r\ninline void out(int X){\r\n\tif(X<0) {X=~(X-1); putchar('-');}\r\n\tif(X>9) out(X/10);\r\n\tputchar(X%10+'0');\r\n}\r\nll pw(ll x,int d){\r\n\tll t = 1;\r\n\tfor(;d;d>>=1,x=x*x%mod)if(d&1)t = t*x%mod;\r\n\treturn t;\r\n}\r\n#define MAX 55\r\nbool mrk[MAX];\r\nnamespace Dinic{\r\n\tconst int de = 1;//0 unsafe , 1 safe , 2 visalbe\r\n\tconst int N = 55;\r\n\tconst int M = 10505;\r\n\tint fir[N];\r\n\tint cur[N];\r\n\tint e[M],flw[M],nxt[M];\r\n\tint dis[N];\r\n\tint flowS=-1,flowT=-1;\r\n\tint tot = 1;\r\n\tqueue<int> q;\r\n\tvoid clear(){\r\n\t\tmemset(fir,0,sizeof(fir));\r\n\t\tmemset(cur,0,sizeof(cur));\r\n\t\tmemset(e,0,sizeof(e));\r\n\t\tmemset(flw,0,sizeof(flw));\r\n\t\tmemset(nxt,0,sizeof(nxt));\r\n\t\tflowS = flowT = -1;\r\n\t\ttot = 1;\r\n\t\treturn ;\r\n\t}\r\n\tvoid adde(int x,int y,int z){\r\n\t//adde(ver_x ,ver_y ,flow)\r\n\t\tif(de>=2){\r\n\t\t\tcout<<\"link : \"<<x<<\"->\"<<y<<\"  (\"<<z<<\")\"<<endl;\r\n\t\t}\r\n\t\tnxt[++tot] = fir[x];\r\n\t\tfir[x] = tot;\r\n\t\tflw[tot] = z;\r\n\t\te[tot] = y;\r\n\t\r\n\t\tnxt[++tot] = fir[y];\r\n\t\tfir[y] = tot;\r\n\t\tflw[tot] = 0;\r\n\t\te[tot] = x;\r\n\t\treturn ;\r\n\t}\r\n\tbool bfs(){\r\n\t\tmemset(dis,0x3f,sizeof(dis));\r\n\t\tmemcpy(cur,fir,sizeof(fir));\r\n\t\twhile(!q.empty())q.pop();\r\n\t\tq.push(flowS);\r\n\t\tdis[flowS] = 0;\r\n\t\twhile(!q.empty()){\r\n\t\t\tint x = q.front();q.pop();\r\n\t\t\tif(x==flowT)return 1;\r\n\t\t\tfor(int i=fir[x],y;i;i=nxt[i]){\r\n\t\t\t\ty = e[i];\r\n\t\t\t\tif(flw[i]){\r\n\t\t\t\t\tif(dis[y]>dis[x]+1){\r\n\t\t\t\t\t\tdis[y] = dis[x]+1;\r\n\t\t\t\t\t\tq.push(y);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\tll dfs(int x,ll infl){\r\n\t\tif(!infl)return 0;\r\n\t\tif(x==flowT)return infl;\r\n\t\tll res = infl,tmp;\r\n\t\tfor(int i=cur[x],y;i&&res;i=nxt[i]){\r\n\t\t\tcur[x] = i;\r\n\t\t\ty = e[i];\r\n\t\t\tif(dis[y]!=dis[x]+1)continue;\r\n\t\t\ttmp = dfs(y,min(res,(ll)flw[i]));\r\n\t\t\tflw[i] -= tmp;\r\n\t\t\tflw[i^1] += tmp;\r\n\t\t\tres -= tmp;\r\n\t\t}\r\n\t\treturn infl-res;\r\n\t}\r\n\tll rlt = 0;\r\n\tll dinic(){\r\n\t\tif(de)assert(flowS!=-1&&flowT!=-1);\r\n\t\twhile(bfs()){\r\n\t\t\trlt += dfs(flowS,inff);\r\n\t\t}\r\n\t\treturn rlt;\r\n\t}\r\n\tvoid dfs(int x){\r\n\t\tmrk[x] = 1;\r\n\t\tfor(int i=fir[x],y;i;i=nxt[i]){\r\n\t\t\ty = e[i];\r\n\t\t\tif(flw[i]&&!mrk[y]){\r\n\t\t\t\tdfs(y);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ;\r\n\t}\r\n\tvoid cover(){\r\n\t\tmemset(mrk,0,sizeof(mrk));\r\n\t\tdfs(flowS);\r\n\t\treturn ;\r\n\t}\r\n}\r\nusing Dinic::dinic,Dinic::adde,Dinic::flowS,Dinic::flowT;\r\nint dis[MAX];\r\nint idis[MAX];\r\nvector<pii> v[MAX];\r\nvector<pii> iv[MAX];\r\nbool in[MAX*MAX];\r\nbool vis[MAX];\r\nvoid dij(int S,int *d ,vector<pii> *E){\r\n\t// cout<<\"dij: \"<<S<<endl;\r\n\t// repp(i,1,3){\r\n\t// \tfor(auto [x,y]:E[i]){\r\n\t// \t\tcout<<i<<' '<<x<<' '<<y<<endl;\r\n\t// \t}\r\n\t// }cout<<endl;\r\n\r\n\tp_q<pii > q;//<dis,ver>\r\n\tmemset(d,0x3f,sizeof(dis));\r\n\tmemset(vis,0,sizeof(vis));\r\n\td[S] = 0;\r\n\tq.push({0,S});\r\n\twhile(!q.empty()){\r\n\t\tint x = q.top().se;q.pop();\r\n\t\tif(vis[x])continue;\r\n\t\tvis[x] = 1;\r\n\t\tfor(auto [to,val]:E[x]){\r\n\t\t\tif(d[to]>d[x]+val){\r\n\t\t\t\td[to] = d[x]+val;\r\n\t\t\t\tq.push({d[to],to});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn ;\r\n}\r\npii qry[100005];\r\npii point[MAX*MAX];\r\nlld ans[100005];\r\narray<int,3> ed[MAX*MAX];\r\nsigned main(){\r\n\t//freopen(\"in.in\",\"r\",stdin);\r\n\t//freopen(\"out.out\",\"w\",stdout);\r\n\tint n = rd();\r\n\tint m = rd();\r\n\tint x,y,z;\r\n\trep(i,0,m){\r\n\t\tx = rd();\r\n\t\ty = rd();\r\n\t\tz = rd();\r\n\t\ted[i] = {x,y,z};\r\n\t}\r\n\tint Q = rd();\r\n\trep(i,0,Q){\r\n\t\tqry[i] = {rd(),i};\r\n\t}\r\n\tsort(qry,qry+Q);\r\n\tint prex = 0;\r\n\tint predis = 0;\r\n\tint cnt = 0;\r\n\r\n\trepp(i,1,n)v[i].clear();\r\n\trepp(i,1,n)iv[i].clear();\r\n\trep(i,0,m){\r\n\t\tauto [x,y,z] = ed[i];\r\n\t\tv[x].pb({y,z});iv[y].pb({x,z});\r\n\t}\r\n\tdij(1,dis,v);\r\n\r\n\tpoint[0] = {0,dis[n]};\r\n\tpredis = dis[n];\r\n\tint nw=0;\r\n\tflowS = 1,flowT = n;\r\n\twhile(1){\r\n\t//\tcout<<cnt<<endl;\r\n\t\trepp(i,1,n)v[i].clear();\r\n\t\trepp(i,1,n)iv[i].clear();\r\n\t\trep(i,0,m){\r\n\t\t\tauto [x,y,z] = ed[i];\r\n\t\t\tv[x].pb({y,z});iv[y].pb({x,z});\r\n\t\t}\r\n\t\tdij(1,dis,v);\r\n\t\tdij(n,idis,iv);\r\n\r\n\t\t// repp(i,1,n)cout<<dis[i]<<',';cout<<endl;\r\n\t\t// repp(i,1,n)cout<<idis[i]<<',';cout<<endl;\r\n\t\tint mndis = dis[n];\r\n\t\trep(i,0,m){\r\n\t\t\tif(in[i])continue;\r\n\t\t\tauto [x,y,z] = ed[i];\r\n\t\t\tif(dis[x]+idis[y]+z==mndis){\r\n\t\t\t\tin[i] = 1;\r\n\t\t\t\tadde(x,y,1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tnw = dinic();\r\n\t\tDinic::cover();\r\n\r\n\t\trepp(i,1,n)v[i].clear();\r\n\t\trepp(i,1,n)iv[i].clear();\r\n\t\trep(i,0,m){\r\n\t\t\tif(in[i]&&mrk[x]&&!mrk[y]){\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tauto [x,y,z] = ed[i];\r\n\t\t\tv[x].pb({y,z});iv[y].pb({x,z});\r\n\t\t}\r\n\t\tdij(1,dis,v);\r\n\t\tdij(n,idis,iv);\r\n\t\t\r\n\t\tint lim = inf;\r\n\t\trep(i,0,m){\r\n\t\t\tif(in[i])continue;\r\n\t\t\tauto [x,y,z] = ed[i];\r\n\t\t//\tif(mrk[x]&&!mrk[y]){\r\n\t\t\t\tlim = min(lim,dis[x]+idis[y]+z-mndis);\r\n\t\t//\t}\r\n\t\t}\r\n\t\t// cout<<\"in[] : \\n\";\r\n\t\t// rep(i,0,m)cout<<in[i]<<' ';cout<<endl;\r\n\t\t// rep(i,0,m)cout<<ed[i][2]<<' ';cout<<endl;\r\n\t\t// cout<<\"lim = \"<<lim<<' '<<\"mndis = \"<<mndis<<' '<<inf/2<<endl;\r\n\r\n\t\tif(lim>inf/2)break;\r\n\r\n\t\trep(i,0,m){\r\n\t\t\tif(!in[i])continue;\r\n\t\t\tauto [x,y,z] = ed[i];\r\n\t\t\tif(mrk[x]&&!mrk[y]){\r\n\t\t\t\ted[i][2] += lim;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprex += lim*nw;\r\n\t\tpredis += lim;\r\n\t\tpoint[++cnt] = {prex,predis};\r\n\t}\r\n\tint upp = (100500/nw+200);\r\n\tpoint[++cnt] = {prex+nw*upp,predis+(100500/nw+200)};\r\n\t//cout<<\"ok\\n\";\r\n\tint pos = 0;\r\n\t// cout<<\"point: \\n\";\r\n\t// repp(i,0,cnt){\r\n\t// \tcout<<point[i].fi<<','<<point[i].se<<endl;\r\n\t// }cout<<endl;\r\n\trep(i,0,Q){\r\n\t\tauto [x,idx] = qry[i];\r\n\t\twhile(pos<cnt&&x>point[pos+1].fi){\r\n\t\t\t++pos;\r\n\t\t}\r\n\t\tans[idx] = (lld)(point[pos+1].se-point[pos].se)/(point[pos+1].fi-point[pos].fi)*(x-point[pos].fi)+point[pos].se;\r\n\t}\r\n\trep(i,0,Q){\r\n\t\tprintf(\"%.10Lf\\n\",ans[i]);\r\n\t}\r\n\treturn 0;\r\n}"
}
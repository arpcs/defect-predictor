{
    "id": 236138016,
    "contestId": 1896,
    "creationTimeSeconds": 1701922606,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1896,
        "index": "C",
        "name": "Matching Arrays",
        "type": "PROGRAMMING",
        "points": 1500.0,
        "rating": 1400,
        "tags": [
            "binary search",
            "constructive algorithms",
            "greedy",
            "sortings"
        ]
    },
    "author": {
        "contestId": 1896,
        "members": [
            {
                "handle": "galen_colin"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1700923800
    },
    "programmingLanguage": "GNU C++17 (64)",
    "verdict": "RUNTIME_ERROR",
    "testset": "TESTS",
    "passedTestCount": 1,
    "timeConsumedMillis": 0,
    "memoryConsumedBytes": 26931200,
    "source": "#include \"bits/stdc++.h\"\r\nusing namespace std;\r\n \r\n// #pragma GCC optimize(\"O3,unroll-loops\")\r\n// #pragma GCC target(\"avx2,bmi,bmi2,lzcnt,popcnt\")\r\n \r\n/* \r\nfind my code templates at https://github.com/galencolin/cp-templates\r\nalso maybe subscribe please thanks \r\n*/\r\n \r\n#define send {ios_base::sync_with_stdio(false);}\r\n#define help {cin.tie(NULL);}\r\n#define f first\r\n#define s second\r\n#define getunique(v) {sort(v.begin(), v.end()); v.erase(unique(v.begin(), v.end()), v.end());}\r\n \r\nusing ll = long long;\r\n// using ll = int;\r\n// #pragma warning(\"int\")\r\n//\r\nusing vl = vector<ll>;\r\nusing pl = pair<ll, ll>;\r\n \r\ntypedef long double ld;\r\ntypedef unsigned long long ull;\r\n \r\n#include <ext/pb_ds/assoc_container.hpp> \r\n#include <ext/pb_ds/tree_policy.hpp>\r\n \r\nusing namespace std;\r\nusing namespace __gnu_pbds; \r\n \r\ntemplate <typename num_t>\r\nusing ordered_set = tree<num_t, null_type, less<num_t>, rb_tree_tag, tree_order_statistics_node_update>;\r\n \r\n// benq - print any container + pair\r\ntemplate<typename T, typename = void> struct is_iterable : false_type {};\r\ntemplate<typename T> struct is_iterable<T, void_t<decltype(begin(declval<T>())),decltype(end(declval<T>()))>> : true_type {};\r\ntemplate<typename T> typename enable_if<is_iterable<T>::value&&!is_same<T, string>::value,ostream&>::type operator<<(ostream &cout, T const &v);\r\ntemplate<typename A, typename B> ostream& operator<<(ostream &cout, pair<A, B> const &p) { return cout << \"(\" << p.f << \", \" << p.s << \")\"; }\r\ntemplate<typename T> typename enable_if<is_iterable<T>::value&&!is_same<T, string>::value,ostream&>::type operator<<(ostream &cout, T const &v) {\r\n    cout << \"[\"; \r\n    for (auto it = v.begin(); it != v.end();) {\r\n        cout << *it;\r\n        if (++it != v.end()) cout << \", \";\r\n    }\r\n    return cout << \"]\";\r\n}\r\ntemplate<typename A, typename B> istream& operator>>(istream& cin, pair<A, B> &p) {\r\n    cin >> p.first;\r\n    return cin >> p.second;\r\n}\r\n\r\ntemplate<typename T> void debug(string s, T x) {cerr << \"\\033[1;34m\" << s << \"\\033[0;32m = \\033[35m\" << x << \"\\033[0m\\n\";}\r\ntemplate<typename T, typename... Args> void debug(string s, T x, Args... args) {for (int i=0, b=0; i<(int)s.size(); i++) if (s[i] == '(' || s[i] == '{') b++; else\r\n        if (s[i] == ')' || s[i] == '}') b--; else if (s[i] == ',' && b == 0) {cerr << \"\\033[1;34m\" << s.substr(0, i) << \"\\033[0;32m = \\033[35m\" << x << \"\\033[31m | \"; debug(s.substr(s.find_first_not_of(' ', i + 1)), args...); break;}}\r\ntemplate<typename T> void debug_nameless(T x) {cerr << \"\\033[35m\" << x << \"\\033[0m\\n\";}\r\ntemplate<typename T, typename... Args> void debug_nameless(T x, Args... args) {cerr << \"\\033[35m\" << x << \"\\033[31m | \"; debug_nameless(args...);}\r\n\r\n#ifdef galen_colin_local\r\n#define pr(...) debug(#__VA_ARGS__, __VA_ARGS__)\r\n#define prs(...) debug_nameless(__VA_ARGS__)\r\nconst bool local_ = true;\r\n#else\r\n#define pr(...) 135\r\n#define prs(...) 135\r\nconst bool local_ = false;\r\n#endif\r\n \r\nmt19937_64 rng(std::chrono::steady_clock::now().time_since_epoch().count());\r\n// mt19937_64 rng(61378913);\r\n/* usage - just do rng() */\r\n \r\nvoid usaco(string filename) {\r\n  // #pragma message(\"be careful, freopen may be wrong\")\r\n    freopen((filename + \".in\").c_str(), \"r\", stdin);\r\n    freopen((filename + \".out\").c_str(), \"w\", stdout);\r\n}\r\n \r\n// #include <atcoder/all>\r\n// using namespace atcoder;\r\n \r\nconst ld pi = 3.14159265358979323846;\r\n// const ll mod = 1000000007;\r\n// const ll mod = 998244353;\r\n// ll mod;\r\n\r\n\r\n\r\nll n, m, q, k, l, r, x, y, z;\r\nconst ll template_array_size = 1e6 + 121532;\r\nll a[template_array_size];\r\nll b[template_array_size];\r\nll c[template_array_size];\r\nstring s, t;\r\n\r\n\r\n\r\nvoid solve(int tc = 0) {  \r\n    \r\n    n = 3, k = rng() % n;\r\n    if (!local_) cin >> n >> k;\r\n    vector<pl> a(n);\r\n    pr(n, k);\r\n    for (ll i = 0; i < n; i++) {\r\n        \r\n        a[i].f = rng() % 10;\r\n        if (!local_) cin >> a[i].f;\r\n        a[i].s = i;\r\n    }\r\n    // sort(a.begin(), a.end());\r\n\r\n    vl b(n);\r\n    for (ll &x: b) {\r\n        x = rng() % 10;\r\n        if (!local_) cin >> x;\r\n        \r\n    }\r\n    sort(b.begin(), b.end());\r\n\r\n    sort(a.begin(), a.end());\r\n    if (local_) {\r\n        for (ll i = 0; i < n; i++) a[i].s = i;\r\n    }\r\n\r\n    bool pos = 0;\r\n   if (local_) {\r\n        vl r = b;\r\n        do {\r\n            ll c = 0;\r\n            for (ll i = 0; i < n; i++) c += r[i] < a[i].f;\r\n            if (c == k) {\r\n                pos = 1;\r\n                pr(r);\r\n            }\r\n        } while (next_permutation(r.begin(), r.end()));\r\n    }\r\n\r\n    \r\n\r\n    pr(n, k, a, b);\r\n\r\n    pr(a, b);\r\n\r\n    multiset<ll> v(b.begin(), b.end());\r\n    vl ret(n, -1);\r\n    ll pt = 0;\r\n    for (auto [x, y]: a) {\r\n        auto it = v.lower_bound(x);\r\n        if (it != v.end()) {\r\n            ret[y] = *it;\r\n            v.erase(it);\r\n            ++pt;\r\n        }\r\n    }\r\n\r\n    if (v.size() > k) {\r\n        if (local_ && pos) assert(0);\r\n        cout << \"NO\\n\";\r\n        return;\r\n    }\r\n\r\n    vl rr;\r\n    ll t = v.size();\r\n    pr(v, t, ret, pt);\r\n    ll r = pt - 1;\r\n    vl mk(n);\r\n    for (ll i = pt; i < n; i++) {\r\n        pr(i, a[i]);\r\n        auto [x, y] = a[i];\r\n        while (r >= 0 && ret[a[r].s] >= x) --r;\r\n        pr(r, v);\r\n        while (v.size() && *v.rbegin() >= a[r].f) {\r\n            rr.push_back(*v.rbegin());\r\n            v.erase(v.find(*v.rbegin()));\r\n        }\r\n        pr(v);\r\n        if (v.size() && r >= 0 && t < k) {\r\n            ret[a[pt].s] = ret[a[r].s];\r\n            ret[a[r].s] = *v.rbegin();\r\n            v.erase(v.find(*v.rbegin()));\r\n            ++t;\r\n            mk[r] = 1;\r\n        }\r\n        pr(ret);\r\n    }\r\n\r\n    ll p = pt - 1;\r\n    for (ll i = pt - 1; i >= 0; i--) {\r\n        if (mk[i]) continue;\r\n        while (p >= 0 && mk[p]) --p;\r\n        if (p >= 0 && ret[a[i].s] < a[p].f && t < k) {\r\n            swap(ret[a[i].s], ret[a[p].s]);\r\n            --p;\r\n            ++t;\r\n        }\r\n    }\r\n\r\n    pr(v, rr, ret);\r\n\r\n    for (ll i = pt; i < n; i++) {\r\n        auto [x, y] = a[i];\r\n        if (ret[y] == -1) {\r\n            if (v.size()) {\r\n                ret[y] = *v.begin();\r\n                v.erase(v.begin());\r\n            } else {\r\n                ret[y] = rr.back();\r\n                rr.pop_back();\r\n            }\r\n        }\r\n    }\r\n\r\n    pr(ret, t);\r\n\r\n    // pr(ret, tot);\r\n\r\n    if (t != k) {\r\n        if (local_ && pos) assert(0);\r\n        cout << \"NO\\n\";\r\n        return;\r\n    }\r\n\r\n    pr(\"made\");\r\n\r\n    if (local_ && !pos) assert(0);\r\n\r\n    // for (ll x: f) v.insert(x);\r\n\r\n    // pr(f, v, ret);\r\n    // for (auto [x, y]: a) if (ret[y] == -1) {\r\n    //     pr(f, v, ret);\r\n    //     if (v.size() && *v.begin() >= x) {\r\n    //         ret[y] = *v.begin();\r\n    //         v.erase(v.begin());\r\n    //     }\r\n    // }\r\n\r\n    ll cnt = 0;\r\n    for (auto [x, y]: a) cnt += ret[y] < x;\r\n    assert(cnt == k);\r\n\r\n    cout << \"YES\\n\";\r\n\r\n    for (ll x: ret) cout << x << \" \";\r\n    cout << '\\n';\r\n}\r\n\r\nint main() {\r\n    #ifdef galen_colin_local\r\n        auto begin = std::chrono::high_resolution_clock::now();\r\n    #endif\r\n    \r\n    send help\r\n \r\n    #ifndef galen_colin_local\r\n        // usaco(\"evacuation\");\r\n    #endif\r\n    \r\n    // usaco(\"cowland\");\r\n    \r\n    // freopen(\"tc.cpp\", \"r\", stdin);\r\n    // freopen(\"tc.cpp\", \"w\", stdout);\r\n    // freopen(\"tc2.cpp\", \"w\", stdout);\r\n    // freopen(\"in.txt\", \"r\", stdin);\r\n    // freopen(\"out.txt\", \"w\", stdout);\r\n\r\n    \r\n        \r\n    cout << setprecision(15) << fixed;\r\n    cerr << setprecision(4) << fixed;\r\n            \r\n    int tc = 1;\r\n    // if (local_)\r\n    cin >> tc;\r\n    for (int t = 0; t < tc; t++) {\r\n        pr(t); prs(string(50, '-'));\r\n        solve(t);\r\n        prs(string(50, '-') + \"\\n\");\r\n    }\r\n    \r\n    #ifdef galen_colin_local\r\n        auto end = std::chrono::high_resolution_clock::now();\r\n        cerr << setprecision(4) << fixed;\r\n        cerr << \"Execution time: \" << std::chrono::duration_cast<std::chrono::duration<double>>(end - begin).count() << \" seconds\" << endl;\r\n    #endif\r\n}"
}
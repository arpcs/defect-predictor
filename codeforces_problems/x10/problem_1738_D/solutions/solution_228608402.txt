{
    "id": 228608402,
    "contestId": 1738,
    "creationTimeSeconds": 1697579797,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1738,
        "index": "D",
        "name": "Permutation Addicts",
        "type": "PROGRAMMING",
        "points": 2000.0,
        "rating": 1900,
        "tags": [
            "constructive algorithms",
            "data structures",
            "dfs and similar",
            "dsu",
            "graphs",
            "trees"
        ]
    },
    "author": {
        "contestId": 1738,
        "members": [
            {
                "handle": "ararasayonara"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1664548500
    },
    "programmingLanguage": "GNU C++20 (64)",
    "verdict": "OK",
    "testset": "TESTS",
    "passedTestCount": 52,
    "timeConsumedMillis": 140,
    "memoryConsumedBytes": 27136000,
    "source": "#include <bits/stdc++.h>\r\n#define FOR(i,a,n) for(ll i = a;i<n;i++)\r\n#define RFOR(i,a,n) for(ll i = n-1;i>=a;i--)\r\ntypedef long long ll;\r\n#include <bitset>\r\nusing namespace std;\r\n#define f first \r\n#define se second \r\n#define pb push_back\r\n#define pob pop_back\r\n#define sz(x) (int)x.size()\r\n#define outp cout\r\n// DEBUG FUNCTIONS \r\nvoid __print(int x) {outp << x;}\r\nvoid __print(long x) {outp << x;}\r\nvoid __print(long long x) {outp << x;}\r\nvoid __print(unsigned x) {outp << x;}\r\nvoid __print(unsigned long x) {outp << x;}\r\nvoid __print(unsigned long long x) {outp << x;}\r\nvoid __print(float x) {outp << x;}\r\nvoid __print(double x) {outp << x;}\r\nvoid __print(long double x) {outp << x;}\r\nvoid __print(char x) {outp << '\\'' << x << '\\'';}\r\nvoid __print(const char *x) {outp << '\\\"' << x << '\\\"';}\r\nvoid __print(const string &x) {outp << '\\\"' << x << '\\\"';}\r\nvoid __print(bool x) {outp << (x ? \"true\" : \"false\");}\r\n \r\ntemplate<typename T, typename V>\r\nvoid __print(const pair<T, V> &x) {outp << '{'; __print(x.first); outp << ','; __print(x.second); outp << '}';}\r\ntemplate<typename T>\r\nvoid __print(const T &x) {int f = 0; outp << '{'; for (auto &i: x) outp << (f++ ? \",\" : \"\"), __print(i); outp << \"}\";}\r\nvoid _print() {outp << \"]\\n\";}\r\ntemplate <typename T, typename... V>\r\nvoid _print(T t, V... v) {__print(t); if (sizeof...(v)) outp << \", \"; _print(v...);}\r\n#ifndef ONLINE_JUDGE\r\n#define debug(x...) outp << \"[\" << #x << \"] = [\"; _print(x)\r\n#else\r\n#define debug(x...)\r\n#endif\r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n#include <ext/pb_ds/assoc_container.hpp>\r\n#include <ext/pb_ds/tree_policy.hpp>\r\nusing namespace __gnu_pbds;\r\n#define PI 3.14159265\r\n \r\n#define ordered_set tree<pair<long,long>, null_type,less<pair<long,long>>, rb_tree_tag,tree_order_statistics_node_update>\r\n  \r\n// 1554B \r\n//  https://codeforces.com/contest/1554/problem/B\r\n// https://codeforces.com/contest/1617/problem/C\r\nll inf=1e18;\r\nll mod=1e9+7; \r\nll mod1=998244353;\r\n#define PI 3.14159265\r\n \r\n \r\n//long long inf=1000*1000*((double)1000)*1000*1000*1000*1000; \r\n \r\npair<ll,ll> querymax(vector<vector<pair<ll,ll>>>& spt, ll l, ll r){\r\n\t\r\n\tll len=(r-l+1);\r\n\tll j=0;\r\n\twhile(len>(1<<(j+1))){\r\n\t\tj++;\r\n\t}\r\n\t\r\n\tpair<ll,ll> z1=spt[l][j];\r\n\tpair<ll,ll> z2=spt[r-(1<<j)+1][j];\r\n \r\n\t\r\n\treturn max(z1,z2);\r\n\t\r\n}\r\n \r\n \r\n \r\n \r\nvector<vector<pair<ll,ll>>> makesptmax(vector<ll>& a){\r\n\tll n=a.size();\r\n\tvector<vector<pair<ll,ll>>> spt(n,vector<pair<ll,ll>> (20));\r\n\tFOR(i,0,n){\r\n\t\tspt[i][0].f=a[i];\r\n\t\tspt[i][0].se=i;\r\n\t}\r\n\t\r\n\tFOR(j,1,20){\r\n\t\tFOR(i,0,n){\r\n\t\t\tll z1=i+(1<<(j-1));\r\n\t\t\tz1=min(n-1,z1);\t\r\n\t\t\tspt[i][j]=max(spt[z1][j-1],spt[i][j-1]);\r\n\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn spt;\r\n}\r\n \r\n \r\nvoid update(vector<ll>& fenwick, ll sum,ll index){\r\n    ll k=index;\r\n    while(k<fenwick.size() && k!=0){\r\n        fenwick[k]+=sum;\r\n        \r\n        k+=k&(-1*k);\r\n    }\r\n \r\n \r\n}\r\n \r\n \r\n \r\n \r\nll sum(vector<ll>& fenwick,ll i){\r\n \r\n    ll val=0;\r\n    while(i>0){\r\n        val+=fenwick[i];\r\n        \r\n        i-=i&(-1*i);\r\n    }\r\n \r\n    return val;\r\n \r\n}\r\n \r\n \r\nll gcd(ll a, ll b)\r\n{\r\n    while (a > 0 && b > 0) {\r\n        if (a > b) {\r\n            a = a % b;\r\n        }\r\n        else {\r\n            b = b % a;\r\n        }\r\n    }\r\n    if (a == 0) {\r\n        return b;\r\n    }\r\n    return a;\r\n}\r\n \r\n \r\n \r\n \r\nll binpow(ll a, ll b){\r\n\tll z=a;\r\n\tll ans=1;\r\n\t\r\n\tz%=mod;\r\n\twhile(b>0){\r\n\t\tif(b%2==1){\r\n\t\t\tans*=z;\r\n\t\t\tans%=mod;\r\n\t\t}\r\n\t\t\r\n\t\tz*=z;\r\n\t\tz%=mod;\r\n\t\tb=b/2;\r\n\t}\r\n\t\r\n\t\r\n\treturn ans;\r\n\t\r\n\t\r\n}\r\n \r\n \r\nvoid genperm(vector<ll>& inp, vector<vector<ll>>& perm, ll i){\r\n\t\r\n\tif(i==inp.size()){\r\n\t\treturn ;\r\n\t}\r\n\t\r\n\tvector<vector<ll>> perm2;\r\n\tfor(ll j=0;j<perm.size();j++){\r\n\t\tfor(ll k=0;k<perm[j].size();k++){\r\n\t\t\tvector<ll> v2;\r\n\t\t\tFOR(l,0,k){\r\n\t\t\t\tv2.push_back(perm[j][l]);\r\n\t\t\t}\r\n\t\t\tv2.pb(inp[i]);\r\n\t\t\tFOR(l,k,perm[j].size()){\r\n\t\t\t\tv2.pb(perm[j][l]);\r\n\t\t\t}\r\n\t\t\tperm2.pb(v2);\r\n\t\t}\r\n\t\tvector<ll> v=perm[j];\r\n\t\tv.pb(inp[i]);\r\n\t\tperm2.pb(v);\r\n\t}\r\n\tperm=perm2;\r\n\t\r\n \r\n\tgenperm(inp,perm,i+1);\r\n\t\r\n} \r\n \r\n \r\n\r\nvoid generateall(vector<pair<ll,ll>>& prime, vector<ll>& fac, ll i){\r\n\t\r\n\tif(i==prime.size()){\r\n\t\treturn ;\r\n\t}\r\n\tll n=fac.size();\r\n\tfor(ll j=0;j<n;j++){\r\n\t\tll num=fac[j];\r\n\t\t// debug(num);\r\n\t\tfor(ll k=0;k<prime[i].se;k++){\r\n\t\t\tnum*=prime[i].f;\r\n\t\t\t\r\n\t\t\tfac.pb(num);\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\tgenerateall(prime,fac,i+1);\r\n\t\r\n\t\r\n\t\r\n}\r\n\r\nvoid pop(ll z,vector<pair<ll,ll>>& prime){\r\n\t// ll z=a2-a1;\r\n\t// vector<pair<ll,ll>> prime;\r\n\t\r\n\tfor(ll i=2;i*i<=z;i++){\r\n\t\tll count=0;\r\n\t\twhile(z%i==0){\r\n\t\t\tz=z/i;\r\n\t\t\tcount++;\r\n\t\t}\r\n\t\t\r\n\t\tif(count>0){\r\n\t\t\tprime.pb({i,count});\r\n\t\t\t// mp[i]+=count;\r\n\t\t}\r\n\t}\r\n\t\r\n\tif(z>1){\r\n\t\tprime.pb({z,1});\r\n\t\t// mp[z]++;\r\n\t}\r\n\t// vector<ll> fac(1,1);\r\n\t// generateall(prime,fac,0);\r\n// \t\r\n\t\r\n\t// return prime;\t\r\n}\r\n\r\n\r\n\r\nll find(vector<ll>& par, ll i){\r\n\tstack<ll> st;\r\n\twhile(par[i]!=i){\r\n\t\tst.push(i);\r\n\t\ti=par[i];\r\n\t}\r\n\t\r\n\twhile(!st.empty()){\r\n\t\tpar[st.top()]=i;\r\n\t\tst.pop();\r\n\t}\r\n\t\r\n\treturn i;\r\n}\r\n\r\n\r\nll unions(vector<ll>& par, ll i, ll j){\r\n\tll z1=find(par,i);\r\n\tll z2=find(par,j);\r\n\t\r\n\tif(z1!=z2){\r\n\t\tpar[z1]=z2;\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n}\r\n\r\n\r\nll fac[500000+1];\r\nll infac[500000+1];\r\n\r\nll ncr(ll n, ll r){\r\n\tif(n<r){\r\n\t\treturn 0;\r\n\t}\r\n\tll z=fac[n];\r\n\tz*=infac[r];\r\n\tz%=mod;\r\n\tz*=infac[n-r];\r\n\tz%=mod;\r\n\treturn z;\r\n\t\r\n}\r\n\r\n\r\n \r\nint main(){\r\n\tios_base::sync_with_stdio(false);\r\n    cin.tie(NULL);\r\n\t\r\n\t\r\n\t\r\n\tll t;\r\n\tcin>>t;\r\n\t\r\n\tFOR(I,0,t){\r\n\t\tll n;\r\n\t\tcin>>n;\r\n\t\t\r\n\t\tvector<ll> b(n+1);\r\n\t\tFOR(i,1,n+1){\r\n\t\t\tcin>>b[i];\r\n\t\t}\r\n\t\t\r\n\t\tvector<ll> mar(n+1),mil(n+1);\r\n\t\tmar[n]=b[n];\r\n\t\tfor(ll i=n-1;i>=1;i--){\r\n\t\t\tmar[i]=max(mar[i+1],b[i]);\r\n\t\t}\r\n\t\t\r\n\t\tmil[1]=b[1];\r\n\t\tfor(ll i=2;i<=n;i++){\r\n\t\t\tmil[i]=min(mil[i-1],b[i]);\r\n\t\t}\r\n\t\t\r\n\t\tll k=0;\r\n\t\tfor(ll i=1;i<=n;i++){\r\n\t\t\tll mi=mil[i];\r\n\t\t\tll ma=0;\r\n\t\t\tif(i+1<=n){\r\n\t\t\t\tma=mar[i+1];\r\n\t\t\t}\r\n\t\t\tif(mi>i && ma<=i){\r\n\t\t\t\tk=i;break;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tcout<<k<<\"\\n\";\r\n\t\t\r\n\t\tll lla=0;\r\n\t\tll rla=n+1;\r\n\t\tvector<ll> a;\r\n\t\t\r\n\t\tmap<ll,set<ll>> ms1;\r\n\t\tmap<ll,set<ll>> ms2;\r\n\t\tfor(ll i=1;i<=k;i++){\r\n\t\t\tms1[b[i]].insert(i);\r\n\t\t}\r\n\t\tfor(ll i=k+1;i<=n;i++){\r\n\t\t\tms2[b[i]].insert(i);\r\n\t\t}\r\n\t\t\r\n\t\twhile(a.size()<n){\r\n\t\t\t\r\n\t\t\tif(ms2.find(lla)!=ms2.end()){\r\n\t\t\t\tll last=-1;\r\n\t\t\t\tfor(auto j : ms2[lla]){\r\n\t\t\t\t\tif(ms1.find(j)!=ms1.end()){\r\n\t\t\t\t\t\tlast=j;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\ta.pb(j);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tms2.erase(lla);\r\n\t\t\t\trla=last;\r\n\t\t\t\ta.pb(last);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tll last=-1;\r\n\t\t\t\tfor(auto j : ms1[rla]){\r\n\t\t\t\t\tif(ms2.find(j)!=ms2.end()){\r\n\t\t\t\t\t\tlast=j;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\ta.pb(j);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tms1.erase(rla);\r\n\t\t\t\tlla=last;\r\n\t\t\t\ta.pb(last);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tFOR(i,0,a.size()-1){\r\n\t\t\tcout<<a[i]<<\" \";\r\n\t\t}cout<<\"\\n\";\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n   \treturn 0;\r\n }"
}
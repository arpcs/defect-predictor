{
    "id": 221985895,
    "contestId": 1260,
    "creationTimeSeconds": 1693940760,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1260,
        "index": "D",
        "name": "A Game with Traps",
        "type": "PROGRAMMING",
        "rating": 1900,
        "tags": [
            "binary search",
            "dp",
            "greedy",
            "sortings"
        ]
    },
    "author": {
        "contestId": 1260,
        "members": [
            {
                "handle": "SAHAL01"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1574862600
    },
    "programmingLanguage": "GNU C++20 (64)",
    "verdict": "OK",
    "testset": "TESTS",
    "passedTestCount": 51,
    "timeConsumedMillis": 1153,
    "memoryConsumedBytes": 22016000,
    "source": "///******* In the name of ALLAH, Who is Most Gracious, Most Merciful *******///\r\n///******* There is no God but ALLAH, MUHAMMAD(S.A.W) is the Messenger of ALLAH. *******///\r\n///******* Every soul shall taste death.*******///\r\n\r\n//  AL-HAMDULILLAH    //  AL-HAMDULILLAH     //  AL-HAMDULILLAH    //  AL-HAMDULILLAH\r\n//  AL-HAMDULILLAH    //  AL-HAMDULILLAH     //  AL-HAMDULILLAH    //  AL-HAMDULILLAH\r\n//  AL-HAMDULILLAH    //  AL-HAMDULILLAH     //  AL-HAMDULILLAH    //  AL-HAMDULILLAH\r\n//  AL-HAMDULILLAH    //  AL-HAMDULILLAH     //  AL-HAMDULILLAH    //  AL-HAMDULILLAH\r\n//  AL-HAMDULILLAH    //  AL-HAMDULILLAH     //  AL-HAMDULILLAH    //  AL-HAMDULILLAH\r\n\r\n/**************************************************************************************\r\n    ___  _          _   _  ___ ___  ________ _   _ _    _____ _     _      ___  _   _\r\n   / _ \\| |        | | | |/ _ \\|  \\/  |  _  | | | | |  |_   _| |   | |    / _ \\| | | |\r\n  / /_\\ | |  ____  | |_| / /_\\ | .  . | | | | | | | |    | | | |   | |   / /_\\ | |_| |\r\n  |  _  | | |____| |  _  |  _  | |\\/| | | | | | | | |    | | | |   | |   |  _  |  _  |\r\n  | | | | |____    | | | | | | | |  | | |/ /| |_| | |____| |_| |___| |___| | | | | | |\r\n  \\_| |_\\_____/    \\_| |_\\_| |_\\_|  |_|___/  \\___/\\_____\\___/\\_____\\_____\\_| |_\\_| |_/\r\n\r\n***************************************************************************************/\r\n\r\n//  AL-HAMDULILLAH    //  AL-HAMDULILLAH     //  AL-HAMDULILLAH    //  AL-HAMDULILLAH\r\n//  AL-HAMDULILLAH    //  AL-HAMDULILLAH     //  AL-HAMDULILLAH    //  AL-HAMDULILLAH\r\n//  AL-HAMDULILLAH    //  AL-HAMDULILLAH     //  AL-HAMDULILLAH    //  AL-HAMDULILLAH\r\n\r\n\r\n//#pragma GCC optimize(\"Ofast\")\r\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,avx2,fma\")\r\n//#pragma GCC optimize(\"unroll-loops\")\r\n//#include <bits/stdc++.h>\r\n#include<iostream>\r\n#include<algorithm>\r\n#include<vector>\r\n#include<stdlib.h>\r\n#include<string.h>\r\n#include<math.h>\r\n#include<map>\r\n\r\n#define \tll              long long\r\n#define \tsize1           1000001\r\n#define \tbm              1000000007   //bigmod\r\n#define\t\treset(arr,n,i)  fill(arr,arr+n,i)  //cbrt(n) means cube root\r\n#define\t\trset(arr,x)  \tmemset(arr,x,sizeof(arr))\r\n#define\t\t_ceil(x,y)      ((x)/(y))+(((x)%(y))>0)\r\n#define\t\tINF             (ll)1e18 + 10\r\n#define\t\tmod             1e9 + 7//998244353;\r\n#define \tendl            \"\\n\"\r\n\r\n#define\t\t_cpy(c,a,n)     for(int i=0;i<n;i++) c[i]=a[i];\r\n#define \t_iin(a,n)       int a[n]; for(int i=0;i<n;i++) cin>>a[i]\r\n#define \t_lin(a,n)       ll a[n]; for(int i=0;i<n;i++) cin>>a[i]\r\n#define \t_in(a,n)        for(int i=0;i<n;i++) cin>>a[i]\r\n#define \t_out(a,n)       for(int i=0;i<n;i++) cout<<a[i]<<\" \"; cout<<endl\r\n#define\t\t_celi(x,y)      (x+y-1)/(y)  //use this version of _ceil [note: ceil is risky]\r\n#define     eps             0.0000000001\r\n\r\n#define \tfopr()          freopen(\"input.txt\", \"r\", stdin)\r\n#define \tfopw()          freopen(\"output.txt\", \"w\", stdout)\r\n#define \tFastIO          ios_base::sync_with_stdio(false), cin.tie(0)\r\n\r\n// Math :\r\nvoid  mns(int *x, int *y)\t\t{\r\n\tif(*x>=*y) *x-=*y, *y=0;\r\n\telse *y-=*x, *x=0;\r\n}\r\n\r\nint\t log_2(ll n)\t\t\t\t{\r\n\tint cnt=0;\r\n\twhile(n/2) cnt++, n/=2;\r\n\treturn cnt;\r\n}\r\n\r\n// Debuging :\r\n#define\t\t_dbg(_x,_y,_z)  cout<<_x<<\" \"<<_y<<\" \"<<_z<<endl\r\n#define\t\t_dbl\t\t\tcout<<\"_________________ \"<<endl\r\n#define\t\t_db(_x,_y)      cout<<_x<<\" \"<<_y<<endl\r\n#define     OK              cout<<\"Ok\"<<endl;\r\n\r\nusing namespace std;\r\n\r\nmap<ll,vector<pair<ll,ll> > >mp;\r\nll a[200007],ans=-10000000,t;\r\n\r\nbool can(ll mid, ll n, ll m) {\r\n\tll pre=0,post=0,ok=0,cnt=0,c=0;\r\n\r\n\tfor(ll i=1; i<=n; i++) {\r\n\t\tll great=-1;\r\n\r\n\t\tfor(ll j=0; j<mp[i].size(); j++) {\r\n\t\t\tif(mp[i][j].first<=n){\r\n\t\t\t\tif(mp[i][j].second>mid) great=max(great,mp[i][j].first);\r\n\t\t\t\telse ok=max(ok,mp[i][j].second);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(c==0){\r\n\t\t\tif(great!=-1) post=great, c=1;\r\n\t\t\telse pre=i;\r\n\t\t\tcnt++;\r\n\t\t}\r\n\t\t\r\n\t\tif(c==1){\r\n\t\t\tif(post<great) post=great, cnt++;\r\n\t\t\telse if(post==i){\r\n\t\t\t\tcnt+=i-pre+i-pre;\r\n\t\t\t\tpre=i, c=0;\r\n\t\t\t}\r\n\t\t\telse cnt++;\r\n\t\t}\r\n\t}\r\n\t\r\n\tcnt++;\r\n\t\r\n\tif(cnt<=t) {\r\n\t\tans=max(m-(upper_bound(a,a+m,ok-1)-a),ans);\r\n\t\treturn 1;\r\n \t}\r\n\telse return 0;\r\n}\r\n\r\nvoid solve() {\r\n\tll m,n,k,mx=0;\r\n\tcin>>m>>n>>k>>t;\r\n\r\n\t_in(a,m);\r\n\tsort(a,a+m);\r\n\r\n\twhile(k--) {\r\n\t\tll l,r,d;\r\n\t\tcin>>l>>r>>d;\r\n\t\tmp[l].push_back({r,d});\r\n\t\tmx=max(mx,d);\r\n\t}\r\n\r\n\tll low=0,hi=mx+1;\r\n\twhile(low<=hi) {\r\n\t\tll mid=low+(hi-low)/2;\r\n\t\tif(can(mid,n,m)) hi=mid-1;\r\n\t\telse low=mid+1;\r\n\t}\r\n \tcout<<ans<<endl;\r\n}\r\n\r\nint main() {\r\n\tFastIO;\r\n\tint n=1;\r\n\twhile(n--) {\r\n\t\tsolve();\r\n\t}\r\n\treturn 0;\r\n}\r\n//written by MAMUN\r\n\r\n/*  Cautions:\r\n\t1.array out of bound!!! [check array size and last accessed index]\r\n\t2.signed integer overflow!!! [int*int!=ll @typecast(ll) one of them or, multiply with 1LL]\r\n\t3.floating point numbers numbers are equal if the difference between them is less than 1e-9 [better way to compare floating point numbers]\r\n\t4.any square number when divided by 4 must have a remainder of either 0 or 1.\r\n*/\r\n\r\n\r\n/********************************************************************************************************************************************************\r\n _   _            _   _       _____          _     _   _       _                    _ _          ______                   _           _           _\r\n| \\ | |          | | | |     |  ___|        | |   | | | |     (_)                  (_) |         | ___ \\                 | |         | |         | |\r\n|  \\| | ___  _ __| |_| |__   | |__  __ _ ___| |_  | | | |_ __  ___   _____ _ __ ___ _| |_ _   _  | |_/ / __ _ _ __   __ _| | __ _  __| | ___  ___| |__\r\n| . ` |/ _ \\| '__| __| '_ \\  |  __|/ _` / __| __| | | | | '_ \\| \\ \\ / / _ \\ '__/ __| | __| | | | | ___ \\/ _` | '_ \\ / _` | |/ _` |/ _` |/ _ \\/ __| '_ \\\r\n| |\\  | (_) | |  | |_| | | | | |__| (_| \\__ \\ |_  | |_| | | | | |\\ V /  __/ |  \\__ \\ | |_| |_| | | |_/ / (_| | | | | (_| | | (_| | (_| |  __/\\__ \\ | | |\r\n\\_| \\_/\\___/|_|   \\__|_| |_| \\____/\\__,_|___/\\__|  \\___/|_| |_|_| \\_/ \\___|_|  |___/_|\\__|\\__, | \\____/ \\__,_|_| |_|\\__, |_|\\__,_|\\__,_|\\___||___/_| |_|\r\n                                                                                           __/ |                     __/ |\r\n                                                                                          |___/                     |___/\r\n*********************************************************************************************************************************************************/\r\n"
}
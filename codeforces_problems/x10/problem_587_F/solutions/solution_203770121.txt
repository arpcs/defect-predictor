{
    "id": 203770121,
    "contestId": 587,
    "creationTimeSeconds": 1682664139,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 587,
        "index": "F",
        "name": "Duff is Mad",
        "type": "PROGRAMMING",
        "points": 2750.0,
        "rating": 3000,
        "tags": [
            "data structures",
            "strings"
        ]
    },
    "author": {
        "contestId": 587,
        "members": [
            {
                "handle": "c1120231020"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1444926600
    },
    "programmingLanguage": "GNU C++20 (64)",
    "verdict": "OK",
    "testset": "TESTS",
    "passedTestCount": 87,
    "timeConsumedMillis": 311,
    "memoryConsumedBytes": 32051200,
    "source": "// LUOGU_RID: 109086421\n/*\r\n\u819c\u62dc\u4f20\u5947\u7279\u7ea7\u5b97\u5e08 Afterglow \u5927\u795e\u513f\r\n\u4eca\u5929\u5728 florr \u9996\u9875\u79f0\u60a8\u4e3a\u5927\u590f\u5c0a\u8d35\u7684\u5927\u540d\u513f\r\n\u4e00\u80a1\u656c\u4f69\u4e4b\u60c5\u6cb9\u751f\u7136\u800c\r\n\u60a8\u5728 florr \u4e3a\u56fd\u4e89\u5149\uff0c\u626c\u6211\u5927\u590f\u5a01\u540d\r\n\u5411\u60a8\u732e\u4e0a\u6700\u771f\u631a\u7684\u819c\u62dc\uff01\uff01\uff01\r\n\u819c\u62dc\u4f20\u5947\u7279\u7ea7\u5b97\u5e08 Afterglow \u5927\u795e\u513f\uff0c\u4eca\uff0c\u4e00\uff0c\u60a8\uff0c\u626c\u3002\u5411\uff01\r\n\u819c\u62dc\u4f20\u5947\u7279\u7ea7\u5b97\u5e08 Afterglow \u5927\u795e\u513f\uff0c\u4eca\uff0c\u4e00\uff0c\u60a8\uff0c\u626c\u3002\u5411\uff01\r\n\u819c\u62dc\u4f20\u5947\u7279\u7ea7\u5b97\u5e08 Afterglow \u5927\u795e\u513f\uff0c\u4eca\uff0c\u4e00\uff0c\u60a8\uff0c\u626c\u3002\u5411\uff01\r\n*/\r\n/*\r\n          _____                    _____                     _____                    _____\r\n         /\\    \\                  /\\    \\                   /\\    \\                  /\\    \\\r\n        /  \\    \\                /  \\    \\                 /  \\____\\                /  \\    \\\r\n        \\   \\    \\              /    \\    \\               /   /    /                \\   \\    \\\r\n         \\   \\    \\            /      \\    \\             /   /    /                  \\   \\    \\\r\n          \\   \\    \\          /   /\\   \\    \\           /   /____/                    \\   \\    \\\r\n           \\   \\    \\        /   /  \\   \\    \\         /    |    |                     \\   \\    \\\r\n            \\   \\    \\      /   /    \\   \\    \\       /     |    |                      \\   \\    \\\r\n             \\   \\    \\    /   /    / \\   \\    \\     /      |    |                       \\   \\    \\\r\n              \\   \\    \\  /   /    /   \\   \\    \\   /       |____|__ _____                \\   \\    \\\r\n_______________\\   \\____\\/   /____/     \\   \\    \\ /   /|            \\    \\ _______________\\   \\____\\\r\n\\                  /    /\\   \\    \\      \\   \\    \\\\  / |    _________\\____\\\\                  /    /\r\n \\    ____________/____/  \\   \\    \\      \\   \\____\\\\/__|   |    |           \\    ____________/____/\r\n  \\   \\    \\               \\   \\    \\     |   |    |    |   |    |            \\   \\    \\\r\n   \\   \\    \\               \\   \\    \\    |   |    |    |   |    |             \\   \\    \\\r\n    \\   \\    \\               \\   \\    \\   |   |____|    |   |    |              \\   \\    \\\r\n     \\   \\    \\               \\   \\    \\  /   /    /    \\   |    |               \\   \\    \\\r\n      \\   \\    \\               \\   \\    \\/   /    /      \\  |    |                \\   \\    \\\r\n       \\   \\____\\               \\   \\___/   /    /        \\ |    |                 \\   \\____\\\r\n        \\  /    /                \\         /    /          \\|    |                  \\  /    /\r\n         \\/____/                  \\_______/____/            \\____|                   \\/____/\r\n*/\r\n#define poj\r\n#define zcz\r\n#ifdef poj\r\n//C++\r\n#include<iomanip>\r\n#include<iostream>\r\n//C\r\n#include<cassert>\r\n#include<cmath>\r\n#include<cstdio>\r\n#include<cstdlib>\r\n#include<cstring>\r\n#include<ctime>\r\n//STL\r\n#include<algorithm>\r\n#include<bitset>\r\n#include<functional>\r\n#include<map>\r\n#include<queue>\r\n#include<set>\r\n#include<stack>\r\n#include<string>\r\n#include<vector>\r\n//C++11\r\n#if __cplusplus>=201103L\r\n#include<chrono>\r\n#include<random>\r\n#include<unordered_set>\r\n#include<unordered_map>\r\n#endif\r\n#else\r\n#include<bits/stdc++.h>\r\n#endif\r\nusing namespace std;\r\n#ifdef zcz\r\nclass fastin{\r\n\tprivate:\r\n#ifdef poj\r\n\tstatic const int MAXBF=1<<20;\r\n#else\r\n\tconst int MAXBF=1<<27;\r\n#endif\r\n\tFILE *inf;\r\n\tchar *inbuf,*inst,*ined;\r\n\tinline char _getchar(){\r\n\t\tif(inst==ined)inst=inbuf,ined=inbuf+fread(inbuf,1,MAXBF,inf);\r\n\t\treturn inst==ined?EOF:*inst++;\r\n\t}\r\n\tpublic:\r\n\tfastin(FILE*_inf=stdin){\r\n\t\tinbuf=new char[MAXBF],inf=_inf,inst=inbuf,ined=inbuf;\r\n\t}\r\n\t~fastin(){delete inbuf;}\r\n\ttemplate<typename Int> fastin&operator>>(Int &n){\r\n\t\tstatic char c;\r\n\t\tInt t=1;\r\n\t\twhile((c=_getchar())<'0'||c>'9')if(c=='-')t=-1;\r\n\t\tn=(c^48);\r\n\t\twhile((c=_getchar())>='0'&&c<='9')n=n*10+(c^48);\r\n\t\tn*=t;\r\n\t\treturn *this;\r\n\t}\r\n\tfastin&operator>>(char&c){\r\n\t\twhile((c=_getchar())<'!'||c>'~');\r\n\t\treturn *this;\r\n\t}\r\n\tfastin&operator>>(char*s){\r\n\t\tint t=0;\r\n\t\tstatic char c;\r\n\t\twhile((c=_getchar())==' '||c=='\\n');\r\n\t\ts[t++]=c;\r\n\t\twhile((c=_getchar())>='!'&&c<='~')s[t++]=c;\r\n\t\ts[t]='\\0';\r\n\t\treturn *this;\r\n\t}\r\n}fi;\r\nclass fastout{\r\n\tprivate:\r\n#ifdef poj\r\n\tstatic const int MAXBF=1<<20;\r\n#else\r\n\tconst int MAXBF=1<<27;\r\n#endif\r\n\tFILE *ouf;\r\n\tchar *oubuf,*oust,*oued;\r\n\tinline void _flush(){fwrite(oubuf,1,oued-oust,ouf);oued=oust;}\r\n\tinline void _putchar(char c){\r\n\t\tif(oued==oust+MAXBF)_flush(),oued=oubuf;\r\n\t\t*oued++=c;\r\n\t\t#ifdef local\r\n\t\t_flush();\r\n\t\t#endif\r\n\t}\r\n\tpublic:\r\n\tfastout(FILE*_ouf=stdout){\r\n\t\toubuf=new char[MAXBF],ouf=_ouf,oust=oubuf,oued=oubuf;\r\n\t}\r\n\t~fastout(){_flush();delete oubuf;}\r\n\ttemplate<typename Int> fastout&operator<<(Int n){\r\n\t\tif(n<0)_putchar('-'),n=-n;\r\n\t\tstatic char S[20];\r\n\t\tint t=0;\r\n\t\tdo{S[t++]='0'+n%10,n/=10;}while(n);\r\n\t\tfor(int i=0;i<t;++i)_putchar(S[t-i-1]);\r\n\t\treturn *this;\r\n\t}\r\n\tfastout&operator<<(char c){_putchar(c);return *this;}\r\n\tfastout&operator<<(char*s){\r\n\t\tfor(int i=0;s[i];++i)_putchar(s[i]);\r\n\t\treturn *this;\r\n\t}\r\n\tfastout&operator<<(const char*s){\r\n\t\tfor(int i=0;s[i];++i)_putchar(s[i]);\r\n\t\treturn *this;\r\n\t}\r\n}fo;\r\n#define cin fi\r\n#define cout fo\r\n#else\r\n#define czc ios::sync_with_stdio(0);cin.tie(0);cout.tie(0)\r\n#endif\r\n#define mod 1000000007\r\n#define ll long long\r\n#define isinf 0x3f3f3f3f\r\n#define ilinf 0x7fffffff\r\n#define lsinf 0x3f3f3f3f3f3f3f3f\r\n#define llinf 0x7fffffffffffffff\r\n#define pii pair<int,int>\r\n#define fr first\r\n#define sc second\r\n#define next ___\r\n#define pb push_back\r\n#define N 100010\r\n#define M 500010\r\n#define For(i,a,b) for(int i=(a);i<=(b);++i)\r\n#define Rep(i,a,b,c) for(int i=(a);i<=(b);i+=c)\r\n#define Per(i,a,b,c) for(int i=(a);i>=(b);i-=c)\r\n#define Gra(i) for(int i=h[x];i;i=next[i])\r\ntypedef int arr[N];\r\ntypedef int arm[M];\r\ntypedef ll arl[N];\r\ntypedef ll alm[M];\r\ntypedef double ard[N];\r\ntypedef double adm[M];\r\nint n,sq,q,p,t,l,c=1;arr ed,f,d,z,r,k;arl a,b;char ss[N];\r\nstruct G{int a[27],fl;}tr[N];vector<int>e[N],h[N];\r\nstruct H{int x,y,z;};vector<H>ha[N];\r\nvector<string>s;\r\nvoid dfs(int x){\r\n\td[x]=++t;z[x]=1;\r\n\tfor(int y:e[x])dfs(y),z[x]+=z[y];\r\n}\r\nvoid ch(int x,int y){for(;x<=c;x+=x&-x)r[x]+=y;}\r\nint ask(int x){int ans=0;for(;x;x-=x&-x)ans+=r[x];return ans;}\r\nvoid solve(){\r\n\tcin>>n>>q;s.pb(\"\");\r\n\tFor(i,1,n){\r\n\t\tcin>>(ss+1);s.pb(ss+1);\r\n\t\tp=1,l=strlen(ss+1);sq+=l;\r\n\t\tFor(j,1,l){\r\n\t\t\tint&m=tr[p].a[ss[j]-'a'+1];\r\n\t\t\tif(!m)m=++c;\r\n\t\t\tf[m]=p;p=m;\r\n\t\t}\r\n\t\ted[i]=p;\r\n\t}\r\n\tqueue<int>Q;sq=sqrt(sq);\r\n\tFor(i,1,26)if(tr[1].a[i])Q.push(tr[1].a[i]),tr[tr[1].a[i]].fl=1;\r\n\twhile(Q.size()){\r\n\t\tint x=Q.front();Q.pop();\r\n\t\tFor(i,1,26)if(tr[x].a[i]){\r\n\t\t\tp=tr[tr[x].fl].a[i];\r\n\t\t\t!p?p=1:0;tr[tr[x].a[i]].fl=p;\r\n\t\t\tQ.push(tr[x].a[i]);\r\n\t\t}else tr[x].a[i]=tr[tr[x].fl].a[i];\r\n\t}\r\n\tFor(i,2,c)e[tr[i].fl].pb(i);\r\n\tt=0;dfs(1);\r\n\tFor(i,1,q){\r\n\t\tcin>>p>>l>>k[i];\r\n\t\tif(s[k[i]].size()>sq)ha[k[i]].pb({p,l,i});\r\n\t\telse h[p-1].pb(-i),h[l].pb(i);\r\n\t}\r\n\tFor(i,1,n){\r\n\t\tch(d[ed[i]],1);ch(d[ed[i]]+z[ed[i]],-1);\r\n\t\tfor(int x:h[i]){\r\n\t\t\tl=x>0?1:-1;t=abs(x);p=ed[k[t]];\r\n\t\t\twhile(p)a[t]+=l*ask(d[p]),p=f[p];\r\n\t\t}\r\n\t}\r\n\tFor(i,1,n)if(ha[i].size()){\r\n\t\tfill(r+1,r+1+c,0);\r\n\t\tp=ed[i];while(p)ch(d[p],1),p=f[p];\r\n\t\tFor(j,1,n)b[j]=b[j-1]+ask(d[ed[j]]+z[ed[j]]-1)-ask(d[ed[j]]-1);\r\n\t\tfor(H x:ha[i])a[x.z]=b[x.y]-b[x.x-1];\r\n\t}\r\n\tFor(i,1,q)cout<<a[i]<<'\\n';\r\n\treturn;\r\n}\r\nint main(){\r\n\t#ifndef zcz\r\n\tczc;\r\n\t#endif\r\n\tint t=1;\r\n\twhile(t--)solve();\r\n\treturn 0;\r\n}"
}
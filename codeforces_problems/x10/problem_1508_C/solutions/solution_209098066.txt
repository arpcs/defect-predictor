{
    "id": 209098066,
    "contestId": 1508,
    "creationTimeSeconds": 1686316173,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1508,
        "index": "C",
        "name": "Complete the MST",
        "type": "PROGRAMMING",
        "points": 1500.0,
        "rating": 2500,
        "tags": [
            "bitmasks",
            "brute force",
            "data structures",
            "dfs and similar",
            "dsu",
            "graphs",
            "greedy",
            "trees"
        ]
    },
    "author": {
        "contestId": 1508,
        "members": [
            {
                "handle": "programpiggy"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1618583700
    },
    "programmingLanguage": "GNU C++14",
    "verdict": "WRONG_ANSWER",
    "testset": "TESTS",
    "passedTestCount": 7,
    "timeConsumedMillis": 2293,
    "memoryConsumedBytes": 46489600,
    "source": "#include <bits/stdc++.h>\r\n#define ll long long\r\n#define ull unsigned long long\r\nusing namespace std;\r\n\r\nvector<pair<ll,ll> > vct[200005];\r\nll ga[705][705],f[200005],du[200005],d[200005],vis[200005],vis2[200005];\r\n\r\nll find(ll a) {\r\n\tif (f[a]!=a)f[a]=find(f[a]);\r\n\treturn f[a];\r\n}\r\n\r\nint main() {\r\n\tll n,m,xo=0;\r\n\tcin >> n >> m;\r\n\tfor (ll i=1; i<=m; i++) {\r\n\t\tll u,v,w;\r\n\t\tcin >> u >> v >> w;\r\n\t\tvct[u].push_back({v,w});\r\n\t\tvct[v].push_back({u,w});\r\n\t\txo^=w;\r\n\t\tdu[u]++,du[v]++;\r\n\t}\r\n\tif(n*(n-1)/2-m<n) {\r\n\t\tfor (ll i=1; i<=n; i++) {\r\n\t\t\tfor (pair<ll,ll> j:vct[i]) {\r\n\t\t\t\tga[i][j.first]=j.second;\r\n\t\t\t}\r\n\t\t}\r\n\t\tll rel=1e18;\r\n\t\tfor (ll i=1; i<=n; i++) {\r\n\t\t\tfor (ll j=i+1; j<=n; j++) {\r\n\t\t\t\tif (!ga[i][j]) {\r\n\t\t\t\t\tga[i][j]=xo;\r\n\t\t\t\t\tll ans=0;\r\n\t\t\t\t\tfor (ll i=1;i<=n;i++)d[i]=1e18,vis[i]=0;\r\n\t\t\t\t\td[1]=0;\r\n\t\t\t\t\tfor (ll i=1;i<=n;i++){\r\n\t\t\t\t\t\tll mi=-1;\r\n\t\t\t\t\t\tfor (ll j=1;j<=n;j++){\r\n\t\t\t\t\t\t\tif ((mi==-1&&!vis[j])||(!vis[j]&&d[mi]>d[j]))mi=j;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (mi==-1)break;\r\n//\t\t\t\t\t\tcout<<mi<<\":\"<<d[mi]<< endl;\r\n\t\t\t\t\t\tans+=d[mi];\r\n\t\t\t\t\t\tvis[mi]=1;\r\n\t\t\t\t\t\tfor (ll j=1;j<=n;j++){\r\n\t\t\t\t\t\t\td[j]=min(d[j],ga[min(mi,j)][max(mi,j)]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n//\t\t\t\t\tcout<<i<<\",\"<<j<<\":\"<<ans<< endl;\r\n\t\t\t\t\trel=min(rel,ans);\r\n\t\t\t\t\tga[i][j]=0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcout<< rel<< endl;\r\n\t} else {\r\n\t\tll mi=1;\r\n\t\tfor (ll i=1; i<=n; i++) {\r\n\t\t\tf[i]=i;\r\n\t\t\tif (du[i]<du[mi])mi=i;\r\n\t\t}\r\n\t\tvis[mi]=1;\r\n\t\tfor (pair<ll,ll> i:vct[mi]) {\r\n\t\t\tvis[i.first]=1;\r\n\t\t}\r\n\t\tfor (ll i=1; i<=n; i++) {\r\n\t\t\tif (!vis[i]) {\r\n\t\t\t\tf[find(i)]=find(mi);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (ll i=1; i<=n; i++) {\r\n\t\t\tif (vis[i])continue;\r\n\t\t\tvis2[i]=1; \r\n\t\t\tfor (pair<ll,ll> j:vct[i]) {\r\n\t\t\t\tvis2[j.first]=1;\r\n\t\t\t}\r\n\t\t\tfor (ll j=1; j<=n; j++) {\r\n\t\t\t\tif (vis2[j]) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tf[find(i)]=find(j);\r\n\t\t\t}\r\n\t\t\tvis2[i]=0;\r\n\t\t\tfor (pair<ll,ll> j:vct[i]) {\r\n\t\t\t\tvis2[j.first]=0;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvector<pair<ll,pair<ll,ll>>> edg;\r\n\t\tfor (ll i=1; i<=n; i++) {\r\n\t\t\tfor (pair<ll,ll> j:vct[i]) {\r\n\t\t\t\tedg.push_back({j.second,{i,j.first}});\r\n\t\t\t}\r\n\t\t}\r\n\t\tsort(edg.begin(),edg.end());\r\n\t\tll ans=0;\r\n\t\tfor (ll i=0; i<edg.size(); i++) {\r\n\t\t\tll x=find(edg[i].second.first),y=find(edg[i].second.second);\r\n\t\t\tif (x==y)continue;\r\n\t\t\tf[x]=y;\r\n\t\t\tans+=edg[i].first;\r\n\t\t}\r\n\t\tcout<<ans<< endl;\r\n\t}\r\n\treturn 0;\r\n}\r\n\r\n/*\r\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\r\n\u3000\u25a0\u25a0\u25a0\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u25a0\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u25a0\u25a0\u3000\u3000\r\n\u3000\u25a0\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u25a0\u3000\u3000\u25a0\u25a0\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u25a0\u25a0\u3000\u3000\u25a0\u25a0\u3000\u3000\u25a0\u3000\u3000\r\n\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u25a0\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u25a0\u25a0\u3000\u3000\u25a0\u3000\u3000\u3000\u25a0\u25a0\u3000\r\n\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u25a0\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\r\n\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\r\n\u3000\u25a0\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u25a0\u25a0\u25a0\u3000\u3000\u25a0\u3000\u3000\u25a0\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u25a0\u3000\u3000\r\n\u3000\u25a0\u25a0\u25a0\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\r\n\u3000\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u3000\r\n\u3000\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u25a0\u25a0\u3000\r\n\u3000\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u25a0\u25a0\u3000\u3000\u25a0\u25a0\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u25a0\u25a0\u3000\r\n\u3000\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u3000\u3000\u25a0\u25a0\u3000\u3000\u3000\u3000\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u3000\u3000\u3000\u25a0\u25a0\u25a0\u25a0\u3000\u3000\r\n*/\r\n"
}
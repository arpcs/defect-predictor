{
    "id": 223847817,
    "contestId": 724,
    "creationTimeSeconds": 1695045752,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 724,
        "index": "B",
        "name": "Batch Sort",
        "type": "PROGRAMMING",
        "points": 1000.0,
        "rating": 1500,
        "tags": [
            "brute force",
            "greedy",
            "implementation",
            "math"
        ]
    },
    "author": {
        "contestId": 724,
        "members": [
            {
                "handle": "bkifhr10"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1475928900
    },
    "programmingLanguage": "GNU C++20 (64)",
    "verdict": "OK",
    "testset": "TESTS",
    "passedTestCount": 86,
    "timeConsumedMillis": 15,
    "memoryConsumedBytes": 0,
    "source": "///********************** \u0628\u0650\u0633\u0652\u0645\u0650 \u0671\u0644\u0644\u0651\u064e\u0647\u0650 \u0671\u0644\u0631\u0651\u064e\u062d\u0652\u0645\u064e\u0640\u0670\u0646\u0650 \u0671\u0644\u0631\u0651\u064e\u062d\u0650\u064a\u0645\u0650 **********************///\n\n/**\n *     author: Shefat Hossen Shoikat\n *     date  : 2023-09-18 18:11:10\n **/\n\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define fastio ios_base::sync_with_stdio(false), cin.tie(NULL), cout.tie(NULL)\n#define mod 1000000007\n#define inf 1e18\n#define all(x) x.begin(), x.end()\n#define eb emplace_back\n#define ff first\n#define ss second\n#define yes cout << \"YES\" << endl\n#define no cout << \"NO\" << endl\n#define dtob(p, n) bitset<p>(n).to_string()\n#define btod(bin) stoi(bin, nullptr, 2)\n#define ok cout << \"Eureka\" << nl\n#define nl '\\n'\n#define SH 0\ntypedef long long ll;\ntypedef pair<ll, ll> pll;\ntypedef vector<ll> vl;\ntypedef vector<pll> vpll;\n\nint main()\n{\n    fastio;\n    ll n, m;\n    bool flag = true, fun = false, f = true;\n    bool ans = false;\n    cin >> n >> m;\n    ll a[n + 5][m + 5];\n    ll b[n + 5][m + 5];\n    for (ll i = 1; i <= n; i++)\n    {\n        for (ll j = 1; j <= m; j++)\n        {\n            cin >> a[i][j];\n        }\n    }\n    ll cnt = 0;\n    ll mxc = 0;\n    for (ll i = 1; i <= n; i++)\n    {\n        cnt = 0;\n        for (ll j = 1; j <= m; j++)\n        {\n            if (a[i][j] != j)\n                cnt++;\n        }\n        mxc = max(cnt, mxc);\n    }\n    if (mxc == 0 || mxc == 2)\n    {\n        ans = true;\n    }\n    if (mxc == 4)\n    {\n        for (ll i = 1; i <= n; i++)\n        {\n            cnt = 0;\n            for (ll j = 1; j <= m; j++)\n            {\n                if (a[i][j] != j)\n                    cnt++;\n            }\n            if (cnt == 4)\n            {\n                vl v;\n                for (ll j = 1; j <= m; j++)\n                {\n                    if (a[i][j] != j)\n                        v.eb(j);\n                }\n                for (ll k = 0; k < 4; k++)\n                {\n                    for (ll l = k + 1; l < 4; l++)\n                    {\n                        for (ll ii = 1; ii <= n; ii++)\n                        {\n                            for (ll jj = 1; jj <= m; jj++)\n                            {\n                                b[ii][jj] = a[ii][jj];\n                            }\n                        }\n                        for (ll o = 1; o <= n; o++)\n                        {\n                            swap(b[o][v[k]], b[o][v[l]]);\n                        }\n                        for (ll iii = 1; iii <= n; iii++)\n                        {\n                            pll p1 = {iii, 1}, p2 = {iii, 1};\n                            for (ll jjj = 1; jjj <= m; jjj++)\n                            {\n                                if (b[iii][jjj] != jjj)\n                                {\n                                    p1 = {iii, jjj};\n                                    break;\n                                }\n                            }\n                            for (ll jjj = 1; jjj <= m; jjj++)\n                            {\n                                if (b[iii][jjj] != jjj)\n                                {\n                                    p2 = {iii, jjj};\n                                }\n                            }\n                            swap(b[p1.ff][p1.ss], b[p2.ff][p2.ss]);\n                        }\n                        fun = true;\n                        for (ll ii = 1; ii <= n; ii++)\n                        {\n                            for (ll jj = 1; jj <= m; jj++)\n                            {\n                                if (b[ii][jj] != jj)\n                                    fun = false;\n                            }\n                        }\n                        if (fun)\n                            ans = true;\n                    }\n                }\n            }\n        }\n    }\n\n    if (mxc == 3)\n    {\n        for (ll i = 1; i <= n; i++)\n        {\n            cnt = 0;\n            for (ll j = 1; j <= m; j++)\n            {\n                if (a[i][j] != j)\n                    cnt++;\n            }\n            if (cnt == 3)\n            {\n                vl v;\n                for (ll j = 1; j <= m; j++)\n                {\n                    if (a[i][j] != j)\n                        v.eb(j);\n                }\n                for (ll k = 0; k < 3; k++)\n                {\n                    for (ll l = k + 1; l < 3; l++)\n                    {\n                        for (ll ii = 1; ii <= n; ii++)\n                        {\n                            for (ll jj = 1; jj <= m; jj++)\n                            {\n                                b[ii][jj] = a[ii][jj];\n                            }\n                        }\n                        for (ll o = 1; o <= n; o++)\n                        {\n                            swap(b[o][v[k]], b[o][v[l]]);\n                        }\n\n                        for (ll iii = 1; iii <= n; iii++)\n                        {\n                            pll p1 = {iii, 1}, p2 = {iii, 1};\n                            for (ll jjj = 1; jjj <= m; jjj++)\n                            {\n                                if (b[iii][jjj] != jjj)\n                                {\n                                    p1 = {iii, jjj};\n                                    break;\n                                }\n                            }\n                            for (ll jjj = 1; jjj <= m; jjj++)\n                            {\n                                if (b[iii][jjj] != jjj)\n                                {\n                                    p2 = {iii, jjj};\n                                }\n                            }\n                            swap(b[p1.ff][p1.ss], b[p2.ff][p2.ss]);\n                        }\n                        fun = true;\n                        for (ll ii = 1; ii <= n; ii++)\n                        {\n                            for (ll jj = 1; jj <= m; jj++)\n                            {\n                                if (b[ii][jj] != jj)\n                                    fun = false;\n                            }\n                        }\n                        if (fun)\n                            ans = true;\n                    }\n                }\n            }\n        }\n    }\n\n    ans ? yes : no;\n\n    return SH;\n}\n \t  \t   \t \t \t \t  \t   \t    \t \t \t"
}
{
    "contestId": 536,
    "index": "E",
    "name": "Tavas on the Path",
    "type": "PROGRAMMING",
    "points": 2500.0,
    "rating": 3100,
    "tags": [
        "data structures",
        "divide and conquer",
        "trees"
    ],
    "desc": {
        "title": "E. Tavas on the Path",
        "statement": "<p>Tavas lives in Tavaspolis. Tavaspolis has <span class=\"tex-span\"><i>n</i></span> cities numbered from <span class=\"tex-span\">1</span> to <span class=\"tex-span\"><i>n</i></span> connected by <span class=\"tex-span\"><i>n</i>\u2009-\u20091</span> bidirectional roads. There exists a path between any two cities. Also each road has a length.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/07cd8ad090de776cb1fa8958a3c4e2da57ca40c6.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><p>Tavas' favorite strings are binary strings (they contain only 0 and 1). For any binary string like <span class=\"tex-span\"><i>s</i>\u2009=\u2009<i>s</i><sub class=\"lower-index\">1</sub><i>s</i><sub class=\"lower-index\">2</sub>... <i>s</i><sub class=\"lower-index\"><i>k</i></sub></span>, <span class=\"tex-span\"><i>T</i>(<i>s</i>)</span> is its <span class=\"tex-span\"><i>Goodness</i></span>. <span class=\"tex-span\"><i>T</i>(<i>s</i>)</span> can be calculated as follows:</p><p>Consider there are exactly <span class=\"tex-span\"><i>m</i></span> blocks of <span class=\"tex-span\">1</span>s in this string (a block of <span class=\"tex-span\">1</span>s in <span class=\"tex-span\"><i>s</i></span> is a maximal consecutive substring of <span class=\"tex-span\"><i>s</i></span> that only contains <span class=\"tex-span\">1</span>) with lengths <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\">1</sub>,\u2009<i>x</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>x</i><sub class=\"lower-index\"><i>m</i></sub></span>.</p><p>Define <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/231509db8a9272afaaa6767a38a06a9ab6977aeb.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> where <span class=\"tex-span\"><i>f</i></span> is a given sequence (if <span class=\"tex-span\"><i>m</i>\u2009=\u20090</span>, then <span class=\"tex-span\"><i>T</i>(<i>s</i>)\u2009=\u20090</span>).</p><p>Tavas loves queries. He asks you to answer <span class=\"tex-span\"><i>q</i></span> queries. In each query he gives you numbers <span class=\"tex-span\"><i>v</i>,\u2009<i>u</i>,\u2009<i>l</i></span> and you should print following number:</p><p>Consider the roads on the path from city <span class=\"tex-span\"><i>v</i></span> to city <span class=\"tex-span\"><i>u</i></span>: <span class=\"tex-span\"><i>e</i><sub class=\"lower-index\">1</sub>,\u2009<i>e</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>e</i><sub class=\"lower-index\"><i>x</i></sub></span>.</p><p>Build the binary string <span class=\"tex-span\"><i>b</i></span> of length <span class=\"tex-span\"><i>x</i></span> such that: <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub>\u2009=\u20091</span> if and only if <span class=\"tex-span\"><i>l</i>\u2009\u2264\u2009<i>w</i>(<i>e</i><sub class=\"lower-index\"><i>i</i></sub>)</span> where <span class=\"tex-span\"><i>w</i>(<i>e</i>)</span> is the length of road <span class=\"tex-span\"><i>e</i></span>.</p><p>You should print <span class=\"tex-span\"><i>T</i>(<i>b</i>)</span> for this query.</p>",
        "inputSpecification": "<p>The first line of input contains integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">2\u2009\u2264\u2009<i>n</i>\u2009\u2264\u200910<sup class=\"upper-index\">5</sup></span> and <span class=\"tex-span\">1\u2009\u2264\u2009<i>q</i>\u2009\u2264\u200910<sup class=\"upper-index\">5</sup></span>).</p><p>The next line contains <span class=\"tex-span\"><i>n</i>\u2009-\u20091</span> space separated integers <span class=\"tex-span\"><i>f</i><sub class=\"lower-index\">1</sub>,\u2009<i>f</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>f</i><sub class=\"lower-index\"><i>n</i>\u2009-\u20091</sub></span> (<span class=\"tex-span\">|<i>f</i><sub class=\"lower-index\"><i>i</i></sub>|\u2009\u2264\u20091000</span>).</p><p>The next <span class=\"tex-span\"><i>n</i>\u2009-\u20091</span> lines contain the details of the roads. Each line contains integers <span class=\"tex-span\"><i>v</i>,\u2009<i>u</i></span> and <span class=\"tex-span\"><i>w</i></span> and it means that there's a road between cities <span class=\"tex-span\"><i>v</i></span> and <span class=\"tex-span\"><i>u</i></span> of length <span class=\"tex-span\"><i>w</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>v</i>,\u2009<i>u</i>\u2009\u2264\u2009<i>n</i></span> and <span class=\"tex-span\">1\u2009\u2264\u2009<i>w</i>\u2009\u2264\u200910<sup class=\"upper-index\">9</sup></span>).</p><p>The next <span class=\"tex-span\"><i>q</i></span> lines contain the details of the queries. Each line contains integers <span class=\"tex-span\"><i>v</i>,\u2009<i>u</i>,\u2009<i>l</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>v</i>,\u2009<i>u</i>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\"><i>v</i>\u2009\u2260\u2009<i>u</i></span> and <span class=\"tex-span\">1\u2009\u2264\u2009<i>l</i>\u2009\u2264\u200910<sup class=\"upper-index\">9</sup></span>).</p>",
        "outputSpecification": "<p>Print the answer of each query in a single line.</p>",
        "samples": [
            {
                "input": "2 3<br/>10<br/>1 2 3<br/>1 2 2<br/>1 2 3<br/>1 2 4<br/>",
                "output": "10<br/>10<br/>0<br/>"
            },
            {
                "input": "6 6<br/>-5 0 0 2 10<br/>1 2 1<br/>2 3 2<br/>3 4 5<br/>4 5 1<br/>5 6 5<br/>1 6 1<br/>1 6 2<br/>1 6 5<br/>3 6 5<br/>4 6 4<br/>1 4 2<br/>",
                "output": "10<br/>-5<br/>-10<br/>-10<br/>-5<br/>0<br/>"
            }
        ],
        "note": null
    }
}
{
    "contestId": 477,
    "index": "E",
    "name": "Dreamoon and Notepad",
    "type": "PROGRAMMING",
    "points": 3000.0,
    "rating": 3100,
    "tags": [
        "data structures"
    ],
    "desc": {
        "title": "E. Dreamoon and Notepad",
        "statement": "<p>Dreamoon has just created a document of hard problems using notepad.exe. The document consists of <span class=\"tex-span\"><i>n</i></span> lines of text, <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span> denotes the length of the <span class=\"tex-span\"><i>i</i></span>-th line. He now wants to know what is the fastest way to move the cursor around because the document is really long.</p><p>Let <span class=\"tex-span\">(<i>r</i>,\u2009<i>c</i>)</span> be a current cursor position, where <span class=\"tex-span\"><i>r</i></span> is row number and <span class=\"tex-span\"><i>c</i></span> is position of cursor in the row. We have <span class=\"tex-span\">1\u2009\u2264\u2009<i>r</i>\u2009\u2264\u2009<i>n</i></span> and <span class=\"tex-span\">0\u2009\u2264\u2009<i>c</i>\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>r</i></sub></span>.</p><p>We can use following six operations in notepad.exe to move our cursor assuming the current cursor position is at <span class=\"tex-span\">(<i>r</i>,\u2009<i>c</i>)</span>:</p><ol> <li> up key: the new cursor position <span class=\"tex-span\">(<i>nr</i>,\u2009<i>nc</i>)\u2009=\u2009(<i>max</i>(<i>r</i>\u2009-\u20091,\u20091),\u2009<i>min</i>(<i>a</i><sub class=\"lower-index\"><i>nr</i></sub>,\u2009<i>c</i>))</span> </li><li> down key: the new cursor position <span class=\"tex-span\">(<i>nr</i>,\u2009<i>nc</i>)\u2009=\u2009(<i>min</i>(<i>r</i>\u2009+\u20091,\u2009<i>n</i>),\u2009<i>min</i>(<i>a</i><sub class=\"lower-index\"><i>nr</i></sub>,\u2009<i>c</i>))</span> </li><li> left key: the new cursor position <span class=\"tex-span\">(<i>nr</i>,\u2009<i>nc</i>)\u2009=\u2009(<i>r</i>,\u2009<i>max</i>(0,\u2009<i>c</i>\u2009-\u20091))</span> </li><li> right key: the new cursor position <span class=\"tex-span\">(<i>nr</i>,\u2009<i>nc</i>)\u2009=\u2009(<i>r</i>,\u2009<i>min</i>(<i>a</i><sub class=\"lower-index\"><i>nr</i></sub>,\u2009<i>c</i>\u2009+\u20091))</span> </li><li> HOME key: the new cursor position <span class=\"tex-span\">(<i>nr</i>,\u2009<i>nc</i>)\u2009=\u2009(<i>r</i>,\u20090)</span> </li><li> END key: the new cursor position <span class=\"tex-span\">(<i>nr</i>,\u2009<i>nc</i>)\u2009=\u2009(<i>r</i>,\u2009<i>a</i><sub class=\"lower-index\"><i>r</i></sub>)</span> </li></ol><p>You're given the document description (<span class=\"tex-span\"><i>n</i></span> and sequence <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span>) and <span class=\"tex-span\"><i>q</i></span> queries from Dreamoon. Each query asks what minimal number of key presses is needed to move the cursor from <span class=\"tex-span\">(<i>r</i><sub class=\"lower-index\">1</sub>,\u2009<i>c</i><sub class=\"lower-index\">1</sub>)</span> to <span class=\"tex-span\">(<i>r</i><sub class=\"lower-index\">2</sub>,\u2009<i>c</i><sub class=\"lower-index\">2</sub>)</span>.</p>",
        "inputSpecification": "<p>The first line contains an integer <span class=\"tex-span\"><i>n</i>(1\u2009\u2264\u2009<i>n</i>\u2009\u2264\u2009400,\u2009000)</span> \u2014 the number of lines of text. </p><p>The second line contains <span class=\"tex-span\"><i>n</i></span> integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub>(1\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u200910<sup class=\"upper-index\">8</sup>)</span>.</p><p>The third line contains an integer <span class=\"tex-span\"><i>q</i>(1\u2009\u2264\u2009<i>q</i>\u2009\u2264\u2009400,\u2009000)</span>. </p><p>Each of the next <span class=\"tex-span\"><i>q</i></span> lines contains four integers <span class=\"tex-span\"><i>r</i><sub class=\"lower-index\">1</sub>,\u2009<i>c</i><sub class=\"lower-index\">1</sub>,\u2009<i>r</i><sub class=\"lower-index\">2</sub>,\u2009<i>c</i><sub class=\"lower-index\">2</sub></span> representing a query (<span class=\"tex-span\">1\u2009\u2264\u2009<i>r</i><sub class=\"lower-index\">1</sub>,\u2009<i>r</i><sub class=\"lower-index\">2</sub>\u2009\u2264\u2009<i>n</i>,\u20090\u2009\u2264\u2009<i>c</i><sub class=\"lower-index\">1</sub>\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>r</i>1</sub>,\u20090\u2009\u2264\u2009<i>c</i><sub class=\"lower-index\">2</sub>\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>r</i>2</sub></span>).</p>",
        "outputSpecification": "<p>For each query print the result of the query.</p>",
        "samples": [
            {
                "input": "9<br/>1 3 5 3 1 3 5 3 1<br/>4<br/>3 5 3 1<br/>3 3 7 3<br/>1 0 3 3<br/>6 0 7 3<br/>",
                "output": "2<br/>5<br/>3<br/>2<br/>"
            },
            {
                "input": "2<br/>10 5<br/>1<br/>1 0 1 5<br/>",
                "output": "3<br/>"
            }
        ],
        "note": "<p>In the first sample, the first query can be solved with keys: HOME, right.</p><p>The second query can be solved with keys: down, down, down, END, down.</p><p>The third query can be solved with keys: down, END, down.</p><p>The fourth query can be solved with keys: END, down.</p>"
    }
}
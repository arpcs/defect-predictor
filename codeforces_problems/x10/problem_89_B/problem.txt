{
    "contestId": 89,
    "index": "B",
    "name": "Widget Library",
    "type": "PROGRAMMING",
    "points": 1000.0,
    "rating": 2300,
    "tags": [
        "dp",
        "expression parsing",
        "graphs",
        "implementation"
    ],
    "desc": {
        "title": "B. Widget Library",
        "statement": "<p>Vasya writes his own library for building graphical user interface. Vasya called his creation <span class=\"tex-font-style-tt\">VTK</span> (<span class=\"tex-font-style-tt\">VasyaToolKit</span>). One of the interesting aspects of this library is that widgets are packed in each other. </p><p>A widget is some element of graphical interface. Each widget has width and height, and occupies some rectangle on the screen. Any widget in Vasya's library is of type <span class=\"tex-font-style-tt\">Widget</span>. For simplicity we will identify the widget and its type. </p><p>Types <span class=\"tex-font-style-tt\">HBox</span> and <span class=\"tex-font-style-tt\">VBox</span> are derivatives of type <span class=\"tex-font-style-tt\">Widget</span>, so they also are types <span class=\"tex-font-style-tt\">Widget</span>. Widgets <span class=\"tex-font-style-tt\">HBox</span> and <span class=\"tex-font-style-tt\">VBox</span> are special. They can store other widgets. Both those widgets can use the <span class=\"tex-font-style-tt\">pack()</span> method to pack directly in itself some other widget. Widgets of types <span class=\"tex-font-style-tt\">HBox</span> and <span class=\"tex-font-style-tt\">VBox</span> can store several other widgets, even several equal widgets \u2014 they will simply appear several times. As a result of using the method <span class=\"tex-font-style-tt\">pack()</span> only the link to the packed widget is saved, that is when the packed widget is changed, its image in the widget, into which it is packed, will also change. </p><p>We shall assume that the widget <span class=\"tex-span\"><i>a</i></span> is packed in the widget <span class=\"tex-span\"><i>b</i></span> if there exists a chain of widgets <span class=\"tex-span\"><i>a</i>\u2009=\u2009<i>c</i><sub class=\"lower-index\">1</sub>,\u2009<i>c</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>c</i><sub class=\"lower-index\"><i>k</i></sub>\u2009=\u2009<i>b</i></span>, <span class=\"tex-span\"><i>k</i>\u2009\u2265\u20092</span>, for which <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> is packed directly to <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i>\u2009+\u20091</sub></span> for any <span class=\"tex-span\">1\u2009\u2264\u2009<i>i</i>\u2009&lt;\u2009<i>k</i></span>. In Vasya's library the situation when the widget <span class=\"tex-span\"><i>a</i></span> is packed in the widget <span class=\"tex-span\"><i>a</i></span> (that is, in itself) is not allowed. If you try to pack the widgets into each other in this manner immediately results in an error.</p><p>Also, the widgets <span class=\"tex-font-style-tt\">HBox</span> and <span class=\"tex-font-style-tt\">VBox</span> have parameters <span class=\"tex-font-style-tt\">border</span> and <span class=\"tex-font-style-tt\">spacing</span>, which are determined by the methods <span class=\"tex-font-style-tt\">set_border()</span> and <span class=\"tex-font-style-tt\">set_spacing()</span> respectively. By default both of these options equal <span class=\"tex-span\">0</span>. </p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/97cb04c28ad2f30eda6300851f3f113a1214e336.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center> <p>The picture above shows how the widgets are packed into <span class=\"tex-font-style-tt\">HBox</span> and <span class=\"tex-font-style-tt\">VBox</span>. At that <span class=\"tex-font-style-tt\">HBox</span> and <span class=\"tex-font-style-tt\">VBox</span> automatically change their size depending on the size of packed widgets. As for <span class=\"tex-font-style-tt\">HBox</span> and <span class=\"tex-font-style-tt\">VBox</span>, they only differ in that in <span class=\"tex-font-style-tt\">HBox</span> the widgets are packed horizontally and in <span class=\"tex-font-style-tt\">VBox</span> \u2014 vertically. The parameter <span class=\"tex-font-style-tt\">spacing</span> sets the distance between adjacent widgets, and <span class=\"tex-font-style-tt\">border</span> \u2014 a frame around all packed widgets of the desired width. Packed widgets are placed exactly in the order in which the <span class=\"tex-font-style-tt\">pack()</span> method was called for them. If within <span class=\"tex-font-style-tt\">HBox</span> or <span class=\"tex-font-style-tt\">VBox</span> there are no packed widgets, their sizes are equal to <span class=\"tex-span\">0\u2009\u00d7\u20090</span>, regardless of the options <span class=\"tex-font-style-tt\">border</span> and <span class=\"tex-font-style-tt\">spacing</span>. </p><p>The construction of all the widgets is performed using a scripting language <span class=\"tex-font-style-tt\">VasyaScript</span>. The description of the language can be found in the input data. </p><p>For the final verification of the code Vasya asks you to write a program that calculates the sizes of all the widgets on the source code in the language of <span class=\"tex-font-style-tt\">VasyaScript</span>. </p>",
        "inputSpecification": "<p>The first line contains an integer <span class=\"tex-span\"><i>n</i></span> \u2014 the number of instructions (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>\u2009\u2264\u2009100</span>). Next <span class=\"tex-span\"><i>n</i></span> lines contain instructions in the language <span class=\"tex-font-style-tt\">VasyaScript</span> \u2014 one instruction per line. There is a list of possible instructions below. </p><ul><li> \"<span class=\"tex-font-style-tt\">Widget [name]([x],[y])</span>\" \u2014 create a new widget <span class=\"tex-font-style-tt\">[name]</span> of the type <span class=\"tex-font-style-tt\">Widget</span> possessing the width of <span class=\"tex-font-style-tt\">[x]</span> units and the height of <span class=\"tex-font-style-tt\">[y]</span> units. </li><li> \"<span class=\"tex-font-style-tt\">HBox [name]</span>\" \u2014 create a new widget <span class=\"tex-font-style-tt\">[name]</span> of the type <span class=\"tex-font-style-tt\">HBox</span>. </li><li> \"<span class=\"tex-font-style-tt\">VBox [name]</span>\" \u2014 create a new widget <span class=\"tex-font-style-tt\">[name]</span> of the type <span class=\"tex-font-style-tt\">VBox</span>. </li><li> \"<span class=\"tex-font-style-tt\">[name1].pack([name2])</span>\" \u2014 pack the widget <span class=\"tex-font-style-tt\">[name2]</span> in the widget <span class=\"tex-font-style-tt\">[name1]</span>. At that, the widget <span class=\"tex-font-style-tt\">[name1]</span> must be of type <span class=\"tex-font-style-tt\">HBox</span> or <span class=\"tex-font-style-tt\">VBox</span>. </li><li> \"<span class=\"tex-font-style-tt\">[name].set_border([x])</span>\" \u2014 set for a widget <span class=\"tex-font-style-tt\">[name]</span> the <span class=\"tex-font-style-tt\">border</span> parameter to <span class=\"tex-font-style-tt\">[x]</span> units. The widget <span class=\"tex-font-style-tt\">[name]</span> must be of type <span class=\"tex-font-style-tt\">HBox</span> or <span class=\"tex-font-style-tt\">VBox</span>. </li><li> \"<span class=\"tex-font-style-tt\">[name].set_spacing([x])</span>\" \u2014 set for a widget <span class=\"tex-font-style-tt\">[name]</span> the <span class=\"tex-font-style-tt\">spacing</span> parameter to <span class=\"tex-font-style-tt\">[x]</span> units. The widget <span class=\"tex-font-style-tt\">[name]</span> must be of type <span class=\"tex-font-style-tt\">HBox</span> or <span class=\"tex-font-style-tt\">VBox</span>. </li></ul> <p>All instructions are written without spaces at the beginning and at the end of the string. The words inside the instruction are separated by exactly one space. There are no spaces directly before the numbers and directly after them. </p><p>The case matters, for example, \"<span class=\"tex-font-style-tt\">wiDget x</span>\" is not a correct instruction. The case of the letters is correct in the input data.</p><p>All names of the widgets consist of lowercase Latin letters and has the length from <span class=\"tex-span\">1</span> to <span class=\"tex-span\">10</span> characters inclusive. The names of all widgets are pairwise different. All numbers in the script are integers from <span class=\"tex-span\">0</span> to <span class=\"tex-span\">100</span> inclusive</p><p>It is guaranteed that the above-given script is correct, that is that all the operations with the widgets take place after the widgets are created and no widget is packed in itself. It is guaranteed that the script creates at least one widget. </p>",
        "outputSpecification": "<p>For each widget print on a single line its name, width and height, separated by spaces. The lines must be ordered lexicographically by a widget's name. </p><p>Please, do not use the <span class=\"tex-font-style-tt\">%lld</span> specificator to read or write 64-bit integers in C++. It is preferred to use <span class=\"tex-font-style-tt\">cout</span> stream (also you may use <span class=\"tex-font-style-tt\">%I64d</span> specificator)</p>",
        "samples": [
            {
                "input": "12<br/>Widget me(50,40)<br/>VBox grandpa<br/>HBox father<br/>grandpa.pack(father)<br/>father.pack(me)<br/>grandpa.set_border(10)<br/>grandpa.set_spacing(20)<br/>Widget brother(30,60)<br/>father.pack(brother)<br/>Widget friend(20,60)<br/>Widget uncle(100,20)<br/>grandpa.pack(uncle)<br/>",
                "output": "brother 30 60<br/>father 80 60<br/>friend 20 60<br/>grandpa 120 120<br/>me 50 40<br/>uncle 100 20<br/>"
            },
            {
                "input": "15<br/>Widget pack(10,10)<br/>HBox dummy<br/>HBox x<br/>VBox y<br/>y.pack(dummy)<br/>y.set_border(5)<br/>y.set_spacing(55)<br/>dummy.set_border(10)<br/>dummy.set_spacing(20)<br/>x.set_border(10)<br/>x.set_spacing(10)<br/>x.pack(pack)<br/>x.pack(dummy)<br/>x.pack(pack)<br/>x.set_border(0)<br/>",
                "output": "dummy 0 0<br/>pack 10 10<br/>x 40 10<br/>y 10 10<br/>"
            }
        ],
        "note": "<p>In the first sample the widgets are arranged as follows: </p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/8c8065ebfc8054e78663954ca0efb0d4fc2c17e4.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center>"
    }
}
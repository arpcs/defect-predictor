{
    "id": 213046491,
    "contestId": 1184,
    "creationTimeSeconds": 1688958378,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1184,
        "index": "A3",
        "name": "Heidi Learns Hashing (Hard)",
        "type": "PROGRAMMING",
        "rating": 3100,
        "tags": [
            "fft",
            "math",
            "number theory"
        ]
    },
    "author": {
        "contestId": 1184,
        "members": [
            {
                "handle": "cyffff"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1562483100
    },
    "programmingLanguage": "GNU C++14",
    "verdict": "RUNTIME_ERROR",
    "testset": "TESTS",
    "passedTestCount": 5,
    "timeConsumedMillis": 93,
    "memoryConsumedBytes": 45363200,
    "source": "#include<bits/stdc++.h>\r\nusing namespace std;\r\n#define ll long long\r\nnamespace IO{//by cyffff\r\n\tint len=0;\r\n\tchar ibuf[(1<<21)+1],*iS,*iT,out[(1<<23)+1];\r\n\t#if ONLINE_JUDGE\r\n\t#define gh() (iS==iT?iT=(iS=ibuf)+fread(ibuf,1,(1<<21)+1,stdin),(iS==iT?EOF:*iS++):*iS++)\r\n \t#else\r\n\t#define gh() getchar()\r\n\t#endif\r\n\t#define reg register\r\n\tinline int read(){\r\n\t\treg char ch=gh();\r\n\t\treg int x=0;\r\n\t\treg char t=0;\r\n\t\twhile(ch<'0'||ch>'9')   t|=ch=='-',ch=gh();\r\n\t\twhile(ch>='0'&&ch<='9') x=x*10+(ch^48),ch=gh();\r\n\t\treturn t?-x:x;\r\n\t}\r\n\tinline void putc(char ch){\r\n\t\tout[len++]=ch;\r\n\t}\r\n\ttemplate<class T>\r\n\tinline void write(T x){\r\n\t\tif(x<0)putc('-'),x=-x;\r\n\t\tif(x>9)write(x/10);\r\n\t\tout[len++]=x%10+48;\r\n\t}\r\n\tinline void flush(){\r\n\t\tfwrite(out,1,len,stdout);\r\n\t\tlen=0;\r\n\t}\r\n\tinline char getc(){\r\n\t\tchar ch=gh();\r\n\t\twhile(ch<'a'||ch>'z') ch=gh();\r\n\t\treturn ch;\r\n\t}\r\n}\r\nusing IO::read;\r\nusing IO::write;\r\nusing IO::flush;\r\nusing IO::getc;\r\nusing IO::putc;\r\n#define ld double\r\nconst int N=131072+10;\r\nint mod;\r\nnamespace Init{\r\n\tconst double pi=acos(-1);\r\n\tstruct comp{\r\n\t\tdouble x,y;\r\n\t\tcomp(ld a=0,ld b=0){x=a,y=b;}\r\n\t\tcomp neg(){ return comp(x,-y); }\r\n\t\tfriend comp operator+(const comp &a,const comp &b){ return comp(a.x+b.x,a.y+b.y); }\r\n\t\tfriend comp operator-(const comp &a,const comp &b){ return comp(a.x-b.x,a.y-b.y); }\r\n\t\tfriend comp operator*(const comp &a,const comp &b){ return comp(a.x*b.x-a.y*b.y,a.y*b.x+a.x*b.y); }\r\n\t};\r\n\tinline int qpow(int x,int y){\r\n\t\tint res=1;\r\n\t\twhile(y){\r\n\t\t\tif(y&1) res=1ll*res*x%mod;\r\n\t\t\tx=1ll*x*x%mod;\r\n\t\t\ty>>=1;\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n}\r\nusing namespace Init;\r\nnamespace Poly{\r\n\tint lim,rev[N];\r\n//\tint F[N],G[N],H[N];\r\n//\tint T1[N],T2[N],T3[N];\r\n\tcomp qp[N];\r\n\tinline void init(int n,int mode=1){\r\n\t\tif(mode){\r\n\t\t\tint l=0;\r\n\t\t\tfor(lim=1;lim<=n;lim<<=1)l++;\r\n\t\t\tfor(int i=1;i<lim;i++)\r\n\t\t\t\trev[i]=(rev[i>>1]>>1)|((i&1)<<(l-1));\r\n\t\t\tfor(int i=1;i<lim;i<<=1)\r\n\t\t\t\tfor(int j=0;j<i;j++)\r\n\t\t\t\t\tqp[lim/i*j]=comp(cos(j*pi/i),sin(j*pi/i));\r\n\t\t}else{\r\n\t\t\tfor(lim=1;lim<=n;lim<<=1);\r\n\t\t}\r\n\t}\r\n\tinline void FFT(comp *a,int T){\r\n\t\tfor(int i=0;i<lim;i++)\r\n\t\t\tif(i<rev[i])\r\n\t\t\t\tswap(a[i],a[rev[i]]);\r\n\t\tfor(int i=1,o=0;i<lim;i<<=1,o++){\r\n\t\t\tfor(int j=0;j<lim;j+=(i<<1)){\r\n\t\t\t\tfor(int k=0;k<i;k++){\r\n\t\t\t\t\tcomp u=T==1?qp[lim/i*k]:qp[lim/i*k].neg();\r\n\t\t\t\t\tcomp t=a[i+j+k]*u;\r\n\t\t\t\t\ta[i+j+k]=a[j+k]-t;\r\n\t\t\t\t\ta[j+k]=a[j+k]+t;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tinline void Mul(int *a,int *b,int *c,int n,int m){\r\n\t\tstatic comp A[N],B[N],C[N],D[N];\r\n\t\tstatic int T1[N];\r\n\t\tfor(int i=0;i<n;i++)\r\n\t\t\tA[i].x=a[i]>>15,A[i].y=a[i]&32767;\r\n\t\tfor(int i=0;i<m;i++)\r\n\t\t\tC[i].x=b[i]>>15,C[i].y=b[i]&32767;\r\n\t\tfor(int i=n;i<lim;i++)\r\n\t\t\tA[i]=comp();\r\n\t\tfor(int i=m;i<lim;i++)\r\n\t\t\tC[i]=comp();\r\n\t\tFFT(A,1),FFT(C,1);\r\n\t\tfor(int i=1;i<lim;i++)\r\n\t\t\tB[i]=A[lim-i].neg();\r\n\t\tB[0]=A[0].neg();\r\n\t\tfor(int i=1;i<lim;i++)\r\n\t\t\tD[i]=C[lim-i].neg();\r\n\t\tD[0]=C[0].neg();\r\n\t\tfor(int i=0;i<lim;i++){\r\n\t\t\tcomp aa=(A[i]+B[i])*comp(0.5,0);\r\n\t\t\tcomp bb=(A[i]-B[i])*comp(0,-0.5);\r\n\t\t\tcomp cc=(C[i]+D[i])*comp(0.5,0);\r\n\t\t\tcomp dd=(C[i]-D[i])*comp(0,-0.5);\r\n\t\t\tA[i]=aa*cc+comp(0,1)*(aa*dd+bb*cc);\r\n\t\t\tB[i]=bb*dd;\r\n\t\t}\r\n\t\tFFT(A,-1),FFT(B,-1);\r\n\t\tfor(int i=0;i<lim;i++){\r\n\t\t\tint aa=(ll)(A[i].x/lim+0.5)%mod;\r\n\t\t\tint bb=(ll)(A[i].y/lim+0.5)%mod;\r\n\t\t\tint cc=(ll)(B[i].x/lim+0.5)%mod;\r\n\t\t\tT1[i]=((1ll*aa*(1<<30)+1ll*bb*(1<<15)+cc)%mod+mod)%mod;\r\n\t\t}\r\n\t\tfor(int i=0;i<n+m-1;i++)\r\n\t\t\tc[i]=T1[i];\r\n\t}\r\n\tinline void Inv(int *F,int *G,int n){\r\n\t\tstatic int H[N],P[N];\r\n\t\tif(n==1){\r\n\t\t\tG[0]=qpow(F[0],mod-2);\r\n\t\t\treturn ;\r\n\t\t}\r\n\t\tInv(F,G,n+1>>1);\r\n\t\tinit(n<<1);\r\n\t\tMul(F,G,H,n,n);\r\n\t\tMul(H,G,P,n,n);\r\n\t\tfor(int i=0;i<n;i++)\r\n\t\t\tG[i]=(2ll*G[i]+mod-P[i])%mod;\r\n\t}\r\n}\r\nnamespace Evaluation{\r\n\tusing namespace Poly;\r\n\t#define ls (rt<<1)\r\n\t#define rs (rt<<1|1)\r\n\tinline void MulT(int *a,int *b,int *c,int n,int m){\r\n\t\tstatic comp A[N],B[N],C[N],D[N];\r\n\t\tstatic int T1[N];\r\n\t\tfor(int i=0;i<n;i++)\r\n\t\t\tA[i].x=a[i]>>15,A[i].y=a[i]&32767;\r\n\t\tfor(int i=0;i<m;i++)\r\n\t\t\tC[i].x=b[i]>>15,C[i].y=b[i]&32767;\r\n\t\treverse(C,C+m);\r\n\t\tfor(int i=n;i<lim;i++)\r\n\t\t\tA[i]=comp();\r\n\t\tfor(int i=m;i<lim;i++)\r\n\t\t\tC[i]=comp();\r\n\t\tFFT(A,1),FFT(C,1);\r\n\t\tfor(int i=1;i<lim;i++)\r\n\t\t\tB[i]=A[lim-i].neg();\r\n\t\tB[0]=A[0].neg();\r\n\t\tfor(int i=1;i<lim;i++)\r\n\t\t\tD[i]=C[lim-i].neg();\r\n\t\tD[0]=C[0].neg();\r\n\t\tfor(int i=0;i<lim;i++){\r\n\t\t\tcomp aa=(A[i]+B[i])*comp(0.5,0);\r\n\t\t\tcomp bb=(A[i]-B[i])*comp(0,-0.5);\r\n\t\t\tcomp cc=(C[i]+D[i])*comp(0.5,0);\r\n\t\t\tcomp dd=(C[i]-D[i])*comp(0,-0.5);\r\n\t\t\tA[i]=aa*cc+comp(0,1)*(aa*dd+bb*cc);\r\n\t\t\tB[i]=bb*dd;\r\n\t\t}\r\n\t\tFFT(A,-1),FFT(B,-1);\r\n\t\tfor(int i=0;i<lim;i++){\r\n\t\t\tint aa=(ll)(A[i].x/lim+0.5)%mod;\r\n\t\t\tint bb=(ll)(A[i].y/lim+0.5)%mod;\r\n\t\t\tint cc=(ll)(B[i].x/lim+0.5)%mod;\r\n\t\t\tT1[i]=((1ll*aa*(1<<30)+1ll*bb*(1<<15)+cc)%mod+mod)%mod;\r\n\t\t}\r\n\t\tfor(int i=m-1;i<n;i++)\r\n\t\t\tc[i-m+1]=T1[i];\r\n\t}\r\n\tint *T1[N],*T2[N],T3[N],T4[N],pool[N*16],*now=pool;\r\n\tinline void CDQ(int *Q,int rt,int l,int r){\r\n\t\tT1[rt]=now,now+=r-l+2;\r\n\t\tT2[rt]=now,now+=r-l+2;\r\n\t\tif(l==r){\r\n\t\t\tT1[rt][0]=1;\r\n\t\t\tT1[rt][1]=(mod-Q[l])%mod;\r\n\t\t\treturn ;\r\n\t\t}\r\n\t\tint mid=l+r>>1;\r\n\t\tCDQ(Q,ls,l,mid),CDQ(Q,rs,mid+1,r);\r\n\t\tinit(r-l+1);\r\n\t\tMul(T1[ls],T1[rs],T1[rt],mid-l+2,r-mid+1);\r\n\t}\r\n\tinline void Solve(int *S,int rt,int l,int r){\r\n\t\tif(l==r){\r\n\t\t\tS[l]=T2[rt][0];\r\n\t\t\treturn ;\r\n\t\t}\r\n\t\tint mid=l+r>>1;\r\n\t\tinit(r-l+1);\r\n\t\tMulT(T2[rt],T1[rs],T2[ls],r-l+1,r-mid+1);\r\n\t\tMulT(T2[rt],T1[ls],T2[rs],r-l+1,mid-l+2);\r\n\t\tSolve(S,ls,l,mid),Solve(S,rs,mid+1,r);\r\n\t}\r\n\tinline void Prework(){\r\n\t\tmemset(T1,0,sizeof(T1));\r\n\t\tmemset(T2,0,sizeof(T2));\r\n\t\tmemset(pool,0,sizeof(pool));\r\n\t\tnow=pool;\r\n\t}\r\n\tinline void Evaluation(int *F,int *Q,int *S,int n,int m){\r\n\t\tPrework();\r\n\t\tn=max(n,m+1);\r\n\t\tm=max(m,n-1);\r\n\t\tCDQ(Q,1,1,m);\r\n\t\tInv(T1[1],T3,m+1);\r\n\t\treverse(T3,T3+m+1);\r\n\t\tMul(F,T3,T4,n,m+1);\r\n\t\tfor(int i=n;i<n+m;i++)\r\n\t\t\tT2[1][i-n]=T4[i];\r\n\t\tSolve(S,1,1,m);\r\n\t\tfor(int i=1;i<=m;i++)\r\n\t\t\tS[i]=(1ll*S[i]*Q[i]%mod+F[0])%mod;\r\n\t}\r\n}\r\nint n,m,s[N],f[N],qr[N],ans[N];\r\nint cnt,pri[N];\r\nbool vis[N];\r\ninline void sieve(int n){\r\n\tfor(int i=2;i<=n;i++){\r\n\t\tif(!vis[i])\r\n\t\t\tpri[++cnt]=i;\r\n\t\tfor(int j=1;j<=cnt&&1ll*i*pri[j]<=n;j++){\r\n\t\t\tvis[i*pri[j]]=1;\r\n\t\t\tif(i%pri[j]==0) break;\r\n\t\t}\r\n\t}\r\n}\r\ninline void solve(int p){\r\n\tmod=p;\r\n\tfor(int i=0;i<n;i++)\r\n\t\tf[i]=(s[i]%p+p)%p;\r\n\tfor(int i=1;i<=p-3;i++)\r\n\t\tqr[i]=i+1;\r\n\tEvaluation::Evaluation(f,qr,ans,n,p-3);\r\n\tfor(int i=2;i<=p-2;i++)\r\n\t\tif(!ans[i-1]){\r\n\t\t\tprintf(\"%d %d\",p,i);\r\n\t\t\texit(0);\r\n\t\t}\r\n}\r\nint main(){\r\n\tsrand(time(0));\r\n\tn=read(),m=read();\r\n\tfor(int i=0;i<n;i++)\r\n\t\ts[i]=getc();\r\n\tfor(int i=0;i<n;i++)\r\n\t\ts[i]-=getc();\r\n\tsieve(min(N-10,m*2));\r\n//\trandom_shuffle(pri+1,pri+cnt+1);\r\n\tfor(int i=1;i<=cnt;i++)\r\n\t\tif(pri[i]>=m)\r\n\t\t\tsolve(pri[i]);\r\n\tflush();\r\n}\r\n"
}
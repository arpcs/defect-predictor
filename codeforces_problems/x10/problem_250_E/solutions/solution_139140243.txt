{
    "id": 139140243,
    "contestId": 250,
    "creationTimeSeconds": 1639486550,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 250,
        "index": "E",
        "name": "Mad Joe",
        "type": "PROGRAMMING",
        "points": 2000.0,
        "rating": 2000,
        "tags": [
            "brute force"
        ]
    },
    "author": {
        "contestId": 250,
        "members": [
            {
                "handle": "NinjaSenpai"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1353938400
    },
    "programmingLanguage": "GNU C++17 (64)",
    "verdict": "OK",
    "testset": "TESTS",
    "passedTestCount": 50,
    "timeConsumedMillis": 62,
    "memoryConsumedBytes": 1843200,
    "source": "#include <bits/stdc++.h>\r\nusing namespace std ;\r\n\r\n\r\n#include <ext/pb_ds/assoc_container.hpp>\r\n#include <ext/pb_ds/tree_policy.hpp>\r\nusing namespace __gnu_pbds;\r\n\r\ntemplate <class T> using ordered_set = tree<T, null_type, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\r\n\r\n\r\n#define fastio() ios_base::sync_with_stdio(false);cin.tie(NULL);\r\n#define vi vector<int>\r\n#define nline \"\\n\"\r\n#define inf (ll)1e18\r\n#define iinf (int)2e9\r\n#define eb emplace_back\r\n#define vb vector<bool>\r\n#define vll vector<ll> \r\n#define vvi vector<vector<int>>\r\n#define vvb vector<vector<bool>>\r\n#define vc vector<char>\r\n#define vvc vector<vector<char>>\r\n#define nline \"\\n\"\r\n#define pb push_back\r\n#define pf push_front\r\n#define ppb pop_back\r\n#define ppf pop_front\r\n#define mp make_pair\r\n#define fs first\r\n#define sc second\r\n#define PI 3.141592653589793238462\r\n#define set_bits __builtin_popcountll\r\n#define sz(x) ((int)(x).size())\r\n#define all(x) (x).begin(), (x).end()\r\n#define rall(x) (x).rbegin(), (x).rend()\r\n#define oset ordered_set\r\n\r\n#ifndef ONLINE_JUDGE\r\n#define debug(x) cerr << #x <<\" \"; _print(x); cerr << endl;\r\n#else\r\n#define debug(x)\r\n#endif\r\n\r\n#ifndef ONLINE_JUDGE\r\n#define working cerr << \"Working here..\" << \"\\n\" ;\r\n#else\r\n#define working \r\n#endif\r\n\r\ntypedef long long ll;\r\ntypedef unsigned long long ull;\r\ntypedef long double lld;\r\ntypedef pair<int,int> pii;\r\ntypedef pair<ll,ll> pll;\r\n\r\n\r\nvoid _print(ll t) {cerr << t;}\r\nvoid _print(int t) {cerr << t;}\r\nvoid _print(string t) {cerr << t;}\r\nvoid _print(char t) {cerr << t;}\r\nvoid _print(lld t) {cerr << t;}\r\nvoid _print(double t) {cerr << t;}\r\nvoid _print(ull t) {cerr << t;}\r\n\r\ntemplate <class T, class V> void _print(pair <T, V> p);\r\ntemplate <class T> void _print(vector <T> v);\r\ntemplate <class T> void _print(set <T> v);\r\ntemplate <class T, class V> void _print(map <T, V> v);\r\ntemplate <class T> void _print(multiset <T> v);\r\ntemplate <class T> void _print(stack<T> v);\r\ntemplate <class T> void _print(list<T> v);\r\ntemplate <class T> void _print(priority_queue<T> v);\r\ntemplate <class T> void _print(ordered_set<T> st);\r\ntemplate <class T, class V> void _print(unordered_map<T, V> m);\r\n\r\ntemplate <class T, class V> void _print(unordered_map<T, V> m){cerr<<\"{ \"; for(auto i: m){_print(i); cerr<<\" \";} cerr<<\"}\";}\r\ntemplate <class T> void _print(ordered_set<T> st){cerr<<\"{ \";for(auto i: st){_print(i);cerr<<\" \";} cerr<<\"}\";}\r\ntemplate <class T> void _print(priority_queue<T> v){cerr<<\"{ \";while(!v.empty()){_print(v.top()); cerr<<\" \"; v.pop();} cerr<<\" }\";}\r\ntemplate <class T> void _print(stack<T> v){cerr<< \"[\" ; while(!v.empty()){_print(v.top()); cerr<< \" \" ; v.pop();} cerr<< \"]\" ;}\r\ntemplate <class T> void _print(list<T> v) {cerr << \"[\"; for(auto i: v){_print(i);cerr << \" \" ;} cerr<< \"]\";}\r\ntemplate <class T, class V> void _print(pair <T, V> p) {cerr << \"{\"; _print(p.fs); cerr << \",\"; _print(p.sc); cerr << \"}\";}\r\ntemplate <class T> void _print(vector <T> v) {cerr << \"[ \"; for (T i : v) {_print(i); cerr << \" \";} cerr << \"]\";}\r\ntemplate <class T> void _print(set <T> v) {cerr << \"[ \"; for (T i : v) {_print(i); cerr << \" \";} cerr << \"]\";}\r\ntemplate <class T> void _print(multiset <T> v) {cerr << \"[ \"; for (T i : v) {_print(i); cerr << \" \";} cerr << \"]\";}\r\ntemplate <class T, class V> void _print(map <T, V> v) {cerr << \"[ \"; for (auto i : v) {_print(i); cerr << \" \";} cerr << \"]\";}\r\n\r\n/*--------------------------------------------------------------------------------------------------------------------------------*/\r\nll power(ll a, ll b){ll res = 1; while(b){if(b&1){res *= a;} b /=2; a*=a;} return res ;}\r\nll mod_pow(ll a, ll b, ll mod = (ll)(1e9 + 7)){ll res = 1; while(b){if(b&1){res = (res*a)%mod;} b /=2; a=(a*a)%mod;} return (res%mod) ;}\r\nvoid usaco (string filename = \"\"){if(sz(filename)){ freopen((filename+ \".in\").c_str() , \"r\", stdin); freopen((filename+ \".out\").c_str() , \"w\", stdout); } }\r\ninline ll modadd (ll a , ll b , ll mod = (ll)(1e9 + 7)){ return (a + b) - (a + b >= mod ? mod : 0); }\r\n/*--------------------------------------------------------------------------------------------------------------------------------*/\r\nstruct custom_hash {\r\n   static uint64_t splitmix64(uint64_t x) { x+=0x9e3779b97f4a7c15; x=(x^(x>>30))*0xbf58476d1ce4e5b9; x = (x^(x>>27))*0x94d049bb133111eb; return x^(x>>31);}\r\n   size_t operator()(uint64_t x) const { static const uint64_t FIXED_RANDOM = std::chrono::steady_clock::now().time_since_epoch().count(); return splitmix64(x + FIXED_RANDOM); }\r\n};\r\n\r\n\r\n/*---------------------------------------------------------------------------------------------------------------------------------*/\r\n\r\n\r\nconst ll N = 1e6 + 10  ;\r\nconst ll mod = 1e9 + 7 , mod0 = 998244353, mod1 = 1e9 + 9 ;\r\n\r\n\r\nll ans = 0 ;\r\nint px = 1 , py = 1, dir = 1, curpos = 1;\r\nint d[] = {-1, 1};\r\nint n , m;\r\nvvc a;\r\nbool ok = 1;\r\n\r\nvoid sf(int lvl){\r\n   list<int> lb , lh , lc ;\r\n   list<int> rb , rh , rc ;\r\n\r\n   // right details\r\n   for(int i = curpos ; i <= m + 1; ++i){\r\n      if(a[lvl][i] == '#' ) {\r\n         rc.pb(i);\r\n         break;\r\n      }\r\n      if(a[lvl + 1][i] == '.' and !sz(rh)) rh.pb(i);\r\n      if(a[lvl][i] == '+') rb.pb(i);\r\n   }\r\n\r\n   // left details\r\n   for(int i = curpos ; i >= 0; --i){\r\n      if(a[lvl][i] == '#'){\r\n         lc.pb(i);\r\n         break;\r\n      }\r\n      if(a[lvl + 1][i] == '.' and !sz(lh)) lh.pb(i);\r\n      if(a[lvl][i] == '+') lb.pb(i);\r\n   }\r\n\r\n   // debug(rc) debug(rh) debug(rb)\r\n   // debug(lc) debug(lh) debug(lb)\r\n   // cerr << nline;\r\n\r\n   // 155 \r\n\r\n   while(1){\r\n      debug(rc) debug(rh) debug(rb)\r\n      debug(lc) debug(lh) debug(lb)\r\n      // cerr << curpos << \"  \" << ans << nline;\r\n\r\n      if(!sz(rh) and !sz(lh)){\r\n         ok = 0;\r\n         return;\r\n      }\r\n      if(dir == 1){\r\n         if(sz(rh) and !sz(rb)){\r\n            ans += abs(curpos - rh.front()) + 1;\r\n            curpos = rh.front();\r\n            return;\r\n         }\r\n         if(sz(rb)){\r\n            if((sz(rh) and sz(rb) and rh.front() < rb.front()) ){\r\n               ans += abs(curpos - rh.front()) + 1 ;\r\n               curpos = rh.front();\r\n               return ; \r\n            }\r\n            else{\r\n               ans += abs(curpos - rb.front() );\r\n               dir ^= 1 ;\r\n               curpos = rb.front() - 1;\r\n               rb.ppf();\r\n            }\r\n         }\r\n         else{\r\n            ans += abs(curpos - rc.front());\r\n            curpos = rc.front() - 1;\r\n            dir ^= 1;\r\n         }\r\n      }\r\n      else{\r\n         if(!sz(lb) and sz(lh)){\r\n            ans += abs(curpos - lh.front()) + 1;\r\n            curpos = lh.front();\r\n            return;\r\n         }\r\n         if(sz(lb)){\r\n            if((sz(lh) and sz(lb) and lh.front() > lb.front())){\r\n               ans += abs(curpos - lh.front()) + 1;\r\n               curpos = lh.front();\r\n               return;\r\n            }\r\n            else{\r\n               ans += abs(curpos - lb.front() );\r\n               dir ^= 1;\r\n               curpos = lb.front() + 1;\r\n               lb.ppf();\r\n            }\r\n         }\r\n         else{\r\n            ans += abs(curpos - lc.front() );\r\n            curpos = lc.front() + 1;\r\n            dir ^= 1;\r\n         }\r\n      }\r\n   }\r\n\r\n}\r\n\r\nvoid solve() {\r\n   cin >> n>> m ;\r\n   a.assign(n+2, vc(m+2, '#')) ;\r\n\r\n   for(int i = 1; i <= n; ++i){\r\n      for(int j = 1; j <= m ; ++j){\r\n         cin >> a[i][j] ;\r\n      }\r\n   }\r\n\r\n   debug(ans)\r\n   // sf(2);\r\n   // sf(3);\r\n\r\n   for(int i = 1;  i < n; ++i){\r\n      sf(i);\r\n      debug(curpos)\r\n      debug(mp( ans, dir))\r\n\r\n      if(!ok){\r\n         cout << \"Never\" << nline;\r\n         return;\r\n      }\r\n   }\r\n\r\n\r\n   cout << ans << nline;\r\n}\r\n\r\ninline void testcases(){\r\n   \r\n\r\n   int test = 1, testcase = 1 ;\r\n   // cin >> test ;\r\n   \r\n   while(test --){\r\n      // cout << \"Case #\" << testcase++ << \": \";\r\n      solve () ;\r\n   } \r\n}\r\n\r\n\r\n\r\n\r\n\r\nint main (){\r\n   fastio();\r\n\r\n   #ifndef ONLINE_JUDGE\r\n      // freopen(\"output.txt\", \"w\", stdout);\r\n      // freopen(\"input.txt\", \"r\", stdin);\r\n      freopen(\"error.txt\", \"w\", stderr);\r\n   #endif\r\n\r\n   cout << setprecision(12) << fixed;\r\n   cerr << setprecision(5) << fixed;\r\n   \r\n   testcases();\r\n      \r\n   cerr << \"\\nTime elapsed : \" <<  (lld)clock() / CLOCKS_PER_SEC << nline;\r\n}"
}
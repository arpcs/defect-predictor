{
    "id": 204998205,
    "contestId": 1558,
    "creationTimeSeconds": 1683476620,
    "relativeTimeSeconds": 2147483647,
    "problem": {
        "contestId": 1558,
        "index": "B",
        "name": "Up the Strip",
        "type": "PROGRAMMING",
        "points": 1250.0,
        "rating": 1900,
        "tags": [
            "brute force",
            "dp",
            "math",
            "number theory",
            "two pointers"
        ]
    },
    "author": {
        "contestId": 1558,
        "members": [
            {
                "handle": "YocyCraft"
            }
        ],
        "participantType": "PRACTICE",
        "ghost": false,
        "startTimeSeconds": 1629815700
    },
    "programmingLanguage": "GNU C++17 (64)",
    "verdict": "OK",
    "testset": "TESTS",
    "passedTestCount": 33,
    "timeConsumedMillis": 1153,
    "memoryConsumedBytes": 84377600,
    "source": "#include <bits/stdc++.h>\r\n\r\nusing namespace std;\r\n\r\nchar nl = '\\n';\r\nchar sp = ' ';\r\nusing ll = long long;\r\nusing vb = vector<bool>;\r\nusing vi = vector<int>;\r\nusing vl = vector<ll>;\r\nusing vvb = vector<vb>;\r\nusing vvi = vector<vi>;\r\nusing vvl = vector<vl>;\r\nusing si = unordered_set<int>;\r\nusing sl = unordered_set<ll>;\r\nusing tsi = set<int>;\r\nusing tsl = set<ll>;\r\nusing pii = pair<int, int>;\r\nusing pll = pair<ll, ll>;\r\nusing vpii = vector<pii>;\r\nusing vpll = vector<pll>;\r\nusing tmii = map<int, int>;\r\nusing tmll = map<ll, ll>;\r\nusing mii = unordered_map<int, int>;\r\nusing mll = unordered_map<ll, ll>;\r\nusing pqi = priority_queue<int>;\r\nusing pqig = priority_queue<int, vi, greater<int>>;\r\nusing pql = priority_queue<ll>;\r\nusing pqlg = priority_queue<ll, vl, greater<ll>>;\r\nusing pqpii = priority_queue<pii>;\r\nusing pqpll = priority_queue<pll>;\r\n\r\n#define tp3(T) tuple<T,T,T>\r\n#define tp4(T) tuple<T,T,T,T>\r\n\r\n#define all(a) (a).begin(),(a).end()\r\n#define rall(a) (a).rbegin(),(a).rend()\r\n#define sort_and_unique(a) sort(all(a));(a).resize(unique(all(a))-(a).begin())\r\n#define outrange(x,min,max) ((x)<(min) || (x)>(max))\r\n\r\nll _start_time;\r\n#define nano (chrono::system_clock::now().time_since_epoch().count())\r\n#define reset_timer _start_time=nano\r\n#define chime cout<<((nano-_start_time)/1e9)<<endl\r\n#define init_rng mt19937 rng(nano)\r\n#define randint(a,b) ((a)+rng()%((b)-(a)+1))\r\n\r\n#ifndef ONLINE_JUDGE\r\n#define debug(x) (cout<<(#x)<<':'<<(x)<<'\\n')\r\n#else\r\n#define debug(x)\r\n#endif\r\n\r\nvoid yesno(bool a) {\r\n\tcout << (a ? \"Yes\\n\" : \"No\\n\");\r\n}\r\n\r\ntemplate<typename L, typename R>\r\nostream& operator<<(ostream& out, const pair<L, R>& p) {\r\n\tout << '(' << p.first << ',' << p.second << ')';\r\n\treturn out;\r\n}\r\n\r\ntemplate<typename T1, typename T2, typename T3>\r\nostream& operator<<(ostream& out, const tuple<T1, T2, T3>& tp) {\r\n\tauto &[t1, t2, t3] = tp;\r\n\tout << '(' << t1 << ',' << t2 << ',' << t3 << ')';\r\n\treturn out;\r\n}\r\n\r\ntemplate<typename T>\r\nostream& operator<<(ostream& out, const vector<T>& v) {\r\n\tfor (auto &i : v) out << i << ' ';\r\n\tout << nl;\r\n\treturn out;\r\n}\r\n\r\ntemplate<typename T>\r\nostream& operator<<(ostream& out, const set<T>& v) {\r\n\tfor (auto &i : v) out << i << ' ';\r\n\tout << nl;\r\n\treturn out;\r\n}\r\n\r\ntemplate<typename T>\r\nostream& operator<<(ostream& out, const unordered_set<T>& v) {\r\n\tfor (auto &i : v) out << i << ' ';\r\n\tout << nl;\r\n\treturn out;\r\n}\r\n\r\ntemplate<typename K, typename V>\r\nostream& operator<<(ostream& out, const map<K, V>& m) {\r\n\tout << '[';\r\n\tfor (auto &[k, v] : m) {\r\n\t\tout << k << ':' << v << sp;\r\n\t}\r\n\tout << \"]\\n\";\r\n\treturn out;\r\n}\r\n\r\ntemplate<typename K, typename V>\r\nostream& operator<<(ostream& out, const unordered_map<K, V>& m) {\r\n\tout << '[';\r\n\tfor (auto &[k, v] : m) {\r\n\t\tout << k << ':' << v << sp;\r\n\t}\r\n\tout << \"]\\n\";\r\n\treturn out;\r\n}\r\n\r\nnamespace prime_sieve{\r\n\tint _MAX;\r\n\tint* primeFactor;\r\n\tvi primes;\r\n\tbool has_init=false;\r\n\t\r\n\tvoid init(int n){\r\n\t\t_MAX=n;\r\n\t\tprimeFactor=new int[n+1];\r\n\t\thas_init=true;\r\n\t}\r\n\t\r\n\tvoid prepareFactor() {\r\n\t\t/*    time             MAX\r\n\t\t * 0.0004s-0.0005s     1e5\r\n\t\t * 0.004s-0.007s       1e6\r\n\t\t *  0.07s-0.08s        1e7\r\n\t\t *  0.65s-0.7s         1e8\r\n\t\t */\r\n\t\tassert(has_init);\r\n\t\tfor(int i=2;i<=_MAX;i++){\r\n\t\t\tprimeFactor[i]=i;\r\n\t\t}\r\n\t\tfor(int i=2;i<=_MAX;i++){\r\n\t\t\tif(i==primeFactor[i]) primes.push_back(i);\r\n\t\t\tint p=primeFactor[i];\r\n\t\t\tfor(int j:primes){\r\n\t\t\t\tif(j>p || j*i>_MAX) break;\r\n\t\t\t\tprimeFactor[i*j]=j;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tvi& primeFactors(int n){\r\n\t\tvi* list=new vi;\r\n\t\tif(n%2==0) {\r\n\t\t\tlist->push_back(2);\r\n\t\t\tn/=(n&(-n));\r\n\t\t}\r\n\t\twhile(n>1) {\r\n\t\t\tint p=primeFactor[n];\r\n\t\t\tlist->push_back(p);\r\n\t\t\twhile(n%p==0) n/=p;\r\n\t\t}\r\n\t\treturn *list;\r\n\t}\r\n\t\r\n\t//phi(n)\u4ee3\u8868\u4ece1\u5230n\u4e2d\u6709\u591a\u5c11\u4e2a\u6570i\u6ee1\u8db3gcd(i,n)==1\u3002\r\n\tint* phi;\r\n\t\r\n\tvoid preparePhi() {\r\n\t\tassert(has_init);\r\n\t\tphi=new int[_MAX+1];\r\n\t\tphi[1]=1;\r\n\t\tfor(int i=2;i<=_MAX;i++) {\r\n\t\t\tif((i&1)==0) {\r\n\t\t\t\tint lowbit=(i&(-i));\r\n\t\t\t\tphi[i]=phi[i/lowbit]*(lowbit>>1);\r\n\t\t\t}else {\r\n\t\t\t\tint p=primeFactor[i];\r\n\t\t\t\tint i2=i;\r\n\t\t\t\twhile(i2%p==0) i2/=p;\r\n\t\t\t\tif(i2==1) phi[i]=(i/p)*(p-1);\r\n\t\t\t\telse phi[i]=phi[i2]*phi[i/i2];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tint* mobius;\r\n\t\r\n\t//Mobius(n)\u4ee3\u8868f(n)=1\u7684\u6570\u8bba\u5377\u79ef\u9006\u5143\uff0c\u5373\uff1asum(d:n%d==0)(Mobius(d))=(n==1)\u3002\r\n\tvoid prepareMobius() {\r\n\t\tassert(has_init);\r\n\t\tmobius=new int[_MAX+1];\r\n\t\tmobius[1]=1;\r\n\t\tfor(int i=2;i<=_MAX;i++) {\r\n\t\t\tif((i&1)==0) {\r\n\t\t\t\tint lowbit=(i&(-i));\r\n\t\t\t\tmobius[i]=lowbit<=2?-mobius[i/lowbit]:0;\r\n\t\t\t}else {\r\n\t\t\t\tint p=primeFactor[i];\r\n\t\t\t\tint i2=i;\r\n\t\t\t\twhile(i2%p==0) i2/=p;\r\n\t\t\t\tif(i2==1) mobius[i]=-(i==p);\r\n\t\t\t\telse mobius[i]=mobius[i2]*mobius[i/i2];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nusing namespace prime_sieve;\r\n\r\nll mod;\r\nconst int MAX=4000005;\r\nll dp[MAX];\r\nll diff[MAX];\r\n\r\nint main(){\r\n\tios::sync_with_stdio(false);\r\n\tcin.tie(0);\r\n\tcout.tie(0);\r\n\tinit(MAX);\r\n\tprepareFactor();\r\n\tint n;\r\n\tcin>>n>>mod;\r\n//\treset_timer;\r\n\tdp[0]=1;\r\n\tdp[1]=1;\r\n\tll sum1=1;\r\n\tll sum2=0;\r\n\tvi factors;\r\n\tfor(int i=2;i<=n;i++){\r\n\t\tsum2++;\r\n//\t\tfor(int j=2;j*j<=i;j++){\r\n//\t\t\tif(i%j!=0) continue;\r\n//\t\t\tint j2=i/j;\r\n//\t\t\tsum2+=mod+diff[j];\r\n//\t\t\tif(j2!=j) {\r\n//\t\t\t\tsum2+=mod+diff[j2];\r\n//\t\t\t}\r\n//\t\t}\r\n\t\t\r\n\t\tvpii v;\r\n\t\tint t=i;\r\n\t\twhile(t>1){\r\n\t\t\tint p=primeFactor[t];\r\n\t\t\tint r=0;\r\n\t\t\twhile(t%p==0){\r\n\t\t\t\tt/=p;\r\n\t\t\t\tr++;\r\n\t\t\t}\r\n\t\t\tv.emplace_back(p,r);\r\n\t\t}\r\n\t\tfactors.clear();\r\n\t\tfactors.push_back(1);\r\n\t\tfor(auto [p,r]:v){\r\n\t\t\tint k=factors.size();\r\n\t\t\tint pw=p;\r\n\t\t\tfor(int d=1;d<=r;d++){\r\n\t\t\t\tfor(int j=0;j<k;j++){\r\n\t\t\t\t\tfactors.push_back(factors[j]*pw);\r\n\t\t\t\t}\r\n\t\t\t\tpw*=p;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(int j:factors){\r\n\t\t\tif(j==1 || j==i) continue;\r\n\t\t\tsum2+=diff[j];\r\n\t\t}\r\n\t\t\r\n\t\tsum2%=mod;\r\n//\t\tsum2=0;\r\n//\t\tfor(int z=2;z<=i;z++){\r\n//\t\t\tsum2+=dp[i/z];\r\n//\t\t}\r\n//\t\tsum2%=mod;\r\n\t\t\r\n//\t\tdebug(i);debug(sum1);debug(sum2);\r\n\t\tdp[i]=sum1+sum2;\r\n\t\tif(dp[i]>=mod) dp[i]-=mod;\r\n\t\tdiff[i]=dp[i]+mod-dp[i-1];\r\n\t\tif(diff[i]>=mod) diff[i]-=mod;\r\n\t\t\r\n\t\tsum1+=dp[i];\r\n\t\tif(sum1>=mod) sum1-=mod;\r\n\t\t\r\n//\t\tif((i&((1<<16)-1))==0) cout<<i<<endl;\r\n\t}\r\n//\tchime;\r\n\tcout<<dp[n]<<nl;\r\n}"
}
{
    "contestId": 917,
    "index": "E",
    "name": "Upside Down",
    "type": "PROGRAMMING",
    "points": 2750.0,
    "rating": 3400,
    "tags": [
        "data structures",
        "string suffix structures",
        "strings",
        "trees"
    ],
    "desc": {
        "title": "E. Upside Down",
        "statement": "<p>As we all know, Eleven has special abilities. Thus, Hopper convinced her to close the gate to the Upside Down World with her mind. Upside down monsters like to move between the worlds, so they are going to attack Hopper and Eleven in order to make them stop. The monsters live in the vines. The vines form a tree with <span class=\"tex-span\"><i>n</i></span> vertices, numbered from <span class=\"tex-span\">1</span> through <span class=\"tex-span\"><i>n</i></span>. There's a lowercase English letter written in each tunnel (edge).</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/a64dc17c572bb1e99a35935761d00b7aa6999d3a.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><p>Upside down is a magical world. There are <span class=\"tex-span\"><i>m</i></span> types of monsters in upside down, numbered from <span class=\"tex-span\">1</span> through <span class=\"tex-span\"><i>m</i></span>. Each type of monster has a special word that gives them powers. The special word of type <span class=\"tex-span\"><i>i</i></span> is <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>i</i></sub></span>. There are <span class=\"tex-span\"><i>q</i></span> monsters in upside down. Each one is at a junction (vertex) and is going to some other junction. If monster of type <span class=\"tex-span\"><i>k</i></span> goes from junction <span class=\"tex-span\"><i>i</i></span> to junction <span class=\"tex-span\"><i>j</i></span>, the power it gains is the number of times it sees its special world (<span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>k</i></sub></span>) consecutively in the tunnels. More formally: </p><p>If <span class=\"tex-span\"><i>f</i>(<i>i</i>,\u2009<i>j</i>)</span> is the string we get when we concatenate the letters written in the tunnels on the shortest path from <span class=\"tex-span\"><i>i</i></span> to <span class=\"tex-span\"><i>j</i></span>, then the power the monster gains is the number of occurrences of <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>k</i></sub></span> in <span class=\"tex-span\"><i>f</i>(<i>i</i>,\u2009<i>j</i>)</span>.</p><p>Hopper and Eleven want to get prepared, so for each monster, they want to know the power the monster gains after moving. </p>",
        "inputSpecification": "<p>The first line of input contains three integers, <span class=\"tex-span\"><i>n</i>,\u2009<i>m</i></span> and <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">2\u2009\u2264\u2009<i>n</i>\u2009\u2264\u200910<sup class=\"upper-index\">5</sup></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>m</i>,\u2009<i>q</i>\u2009\u2264\u200910<sup class=\"upper-index\">5</sup></span>).</p><p>The next <span class=\"tex-span\"><i>n</i>\u2009-\u20091</span> lines contain the tunnels (edges). Each line contains two integers <span class=\"tex-span\"><i>v</i></span> and <span class=\"tex-span\"><i>u</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>v</i>,\u2009<i>u</i>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\"><i>v</i>\u2009\u2260\u2009<i>u</i></span>) and a lowercase English letter <span class=\"tex-span\"><i>c</i></span>, meaning there's a tunnel connecting junctions <span class=\"tex-span\"><i>v</i></span> and <span class=\"tex-span\"><i>u</i></span> written <span class=\"tex-span\"><i>c</i></span> in it. It is guaranteed that the given graph is a tree.</p><p>The next <span class=\"tex-span\"><i>m</i></span> lines contain the special words. <span class=\"tex-span\"><i>i</i></span>-th line of them contains a single string <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009|<i>s</i><sub class=\"lower-index\"><i>i</i></sub>|\u2009\u2264\u200910<sup class=\"upper-index\">5</sup></span>), consisting of lowercase English letters. It is guaranteed that <span class=\"tex-span\">|<i>s</i><sub class=\"lower-index\">1</sub>|\u2009+\u2009|<i>s</i><sub class=\"lower-index\">2</sub>|\u2009+\u2009...\u2009+\u2009|<i>s</i><sub class=\"lower-index\"><i>m</i></sub>|\u2009\u2264\u200910<sup class=\"upper-index\">5</sup></span>).</p><p>The next <span class=\"tex-span\"><i>q</i></span> lines contain the monsters. Each line contains three integers <span class=\"tex-span\"><i>i</i></span>, <span class=\"tex-span\"><i>j</i></span> and <span class=\"tex-span\"><i>k</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>i</i>,\u2009<i>j</i>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\"><i>i</i>\u2009\u2260\u2009<i>j</i></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>k</i>\u2009\u2264\u2009<i>m</i></span>), meaning a monster of type <span class=\"tex-span\"><i>k</i></span> is going from junction number <span class=\"tex-span\"><i>i</i></span> to junction number <span class=\"tex-span\"><i>j</i></span>.</p>",
        "outputSpecification": "<p>Print <span class=\"tex-span\"><i>q</i></span> lines. <span class=\"tex-span\"><i>i</i></span>-th line should contain a single integer, the power the <span class=\"tex-span\"><i>i</i></span>-th monster gains after moving.</p>",
        "samples": [
            {
                "input": "6 4 5<br/>1 6 b<br/>2 3 a<br/>1 2 b<br/>5 3 b<br/>4 5 b<br/>a<br/>b<br/>bb<br/>aa<br/>1 2 1<br/>6 2 3<br/>1 6 2<br/>4 5 4<br/>1 6 2<br/>",
                "output": "0<br/>1<br/>1<br/>0<br/>1<br/>"
            },
            {
                "input": "10 6 7<br/>1 3 s<br/>10 1 d<br/>2 6 s<br/>5 2 d<br/>7 4 l<br/>8 9 d<br/>8 10 l<br/>7 2 d<br/>8 7 l<br/>dl<br/>dssld<br/>d<br/>d<br/>l<br/>sl<br/>4 5 4<br/>3 7 5<br/>10 6 2<br/>3 1 4<br/>7 5 6<br/>10 9 4<br/>9 8 4<br/>",
                "output": "2<br/>2<br/>0<br/>0<br/>0<br/>1<br/>1<br/>"
            }
        ],
        "note": null
    }
}